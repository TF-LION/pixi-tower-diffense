!function webpackUniversalModuleDefinition(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["tower-diffence"]=e():t["tower-diffence"]=e()}(window,function(){return function(t){var e={};function __webpack_require__(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,i){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(__webpack_require__.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)__webpack_require__.d(i,r,function(e){return t[e]}.bind(null,r));return i},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=26)}([function(t,e,r){var n,o,s;!function(r){var a=/iPhone/i,h=/iPod/i,u=/iPad/i,l=/\bAndroid(?:.+)Mobile\b/i,c=/Android/i,d=/\bAndroid(?:.+)SD4930UR\b/i,p=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,f=/Windows Phone/i,g=/\bWindows(?:.+)ARM\b/i,y=/BlackBerry/i,v=/BB10/i,_=/Opera Mini/i,x=/\b(CriOS|Chrome)(?:.+)Mobile/i,b=/Mobile(?:.+)Firefox\b/i;function m(t,e){return t.test(e)}function i(t){var e=t||("undefined"!=typeof navigator?navigator.userAgent:""),i=e.split("[FBAN");void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]);var r={apple:{phone:m(a,e)&&!m(f,e),ipod:m(h,e),tablet:!m(a,e)&&m(u,e)&&!m(f,e),device:(m(a,e)||m(h,e)||m(u,e))&&!m(f,e)},amazon:{phone:m(d,e),tablet:!m(d,e)&&m(p,e),device:m(d,e)||m(p,e)},android:{phone:!m(f,e)&&m(d,e)||!m(f,e)&&m(l,e),tablet:!m(f,e)&&!m(d,e)&&!m(l,e)&&(m(p,e)||m(c,e)),device:!m(f,e)&&(m(d,e)||m(p,e)||m(l,e)||m(c,e))||m(/\bokhttp\b/i,e)},windows:{phone:m(f,e),tablet:m(g,e),device:m(f,e)||m(g,e)},other:{blackberry:m(y,e),blackberry10:m(v,e),opera:m(_,e),firefox:m(b,e),chrome:m(x,e),device:m(y,e)||m(v,e)||m(_,e)||m(b,e)||m(x,e)}};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}t.exports&&"undefined"==typeof window?t.exports=i:t.exports&&"undefined"!=typeof window?(t.exports=i(),t.exports.isMobile=i):(o=[],n=r.isMobile=i(),void 0===(s="function"==typeof n?n.apply(e,o):n)||(t.exports=s))}(this)},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var r=i(18),n=i(20);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=urlParse,e.resolve=function urlResolve(t,e){return urlParse(t,!1,!0).resolve(e)},e.resolveObject=function urlResolveObject(t,e){return t?urlParse(t,!1,!0).resolveObject(e):e},e.format=function urlFormat(t){n.isString(t)&&(t=urlParse(t));return t instanceof Url?t.format():Url.prototype.format.call(t)},e.Url=Url;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(h),l=["%","/","?",";","#"].concat(u),c=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=i(21);function urlParse(t,e,i){if(t&&n.isObject(t)&&t instanceof Url)return t;var r=new Url;return r.parse(t,e,i),r}Url.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),h=-1!==s&&s<t.indexOf("#")?"?":"#",v=t.split(h);v[0]=v[0].replace(/\\/g,"/");var _=t=v.join(h);if(_=_.trim(),!i&&1===t.split("#").length){var x=a.exec(_);if(x)return this.path=_,this.href=_,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=o.exec(_);if(b){var T=(b=b[0]).toLowerCase();this.protocol=T,_=_.substr(b.length)}if(i||b||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===_.substr(0,2);!S||b&&m[b]||(_=_.substr(2),this.slashes=!0)}if(!m[b]&&(S||b&&!g[b])){for(var w,E,A=-1,C=0;C<c.length;C++){-1!==(O=_.indexOf(c[C]))&&(-1===A||O<A)&&(A=O)}-1!==(E=-1===A?_.lastIndexOf("@"):_.lastIndexOf("@",A))&&(w=_.slice(0,E),_=_.slice(E+1),this.auth=decodeURIComponent(w)),A=-1;for(C=0;C<l.length;C++){var O;-1!==(O=_.indexOf(l[C]))&&(-1===A||O<A)&&(A=O)}-1===A&&(A=_.length),this.host=_.slice(0,A),_=_.slice(A),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var I=this.hostname.split(/\./),M=(C=0,I.length);C<M;C++){var R=I[C];if(R&&!R.match(d)){for(var D="",F=0,B=R.length;F<B;F++)R.charCodeAt(F)>127?D+="x":D+=R[F];if(!D.match(d)){var L=I.slice(0,C),k=I.slice(C+1),U=R.match(p);U&&(L.push(U[1]),k.unshift(U[2])),k.length&&(_="/"+k.join(".")+_),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var N=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+N,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!f[T])for(C=0,M=u.length;C<M;C++){var j=u[C];if(-1!==_.indexOf(j)){var X=encodeURIComponent(j);X===j&&(X=escape(j)),_=_.split(j).join(X)}}var H=_.indexOf("#");-1!==H&&(this.hash=_.substr(H),_=_.slice(0,H));var z=_.indexOf("?");if(-1!==z?(this.search=_.substr(z),this.query=_.substr(z+1),e&&(this.query=y.parse(this.query)),_=_.slice(0,z)):e&&(this.search="",this.query={}),_&&(this.pathname=_),g[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var Y=this.search||"";this.path=N+Y}return this.href=this.format(),this},Url.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+r},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if(n.isString(t)){var e=new Url;e.parse(t,!1,!0),t=e}for(var i=new Url,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];i[s]=this[s]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var u=a[h];"protocol"!==u&&(i[u]=t[u])}return g[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!g[t.protocol]){for(var l=Object.keys(t),c=0;c<l.length;c++){var d=l[c];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||m[t.protocol])i.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var f=i.pathname||"",y=i.search||"";i.path=f+y}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=_||v||i.host&&t.pathname,b=x,T=i.pathname&&i.pathname.split("/")||[],S=(p=t.pathname&&t.pathname.split("/")||[],i.protocol&&!g[i.protocol]);if(S&&(i.hostname="",i.port=null,i.host&&(""===T[0]?T[0]=i.host:T.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),x=x&&(""===p[0]||""===T[0])),_)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,T=p;else if(p.length)T||(T=[]),T.pop(),T=T.concat(p),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search)){if(S)i.hostname=i.host=T.shift(),(O=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=O.shift(),i.host=i.hostname=O.shift());return i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var w=T.slice(-1)[0],E=(i.host||t.host||T.length>1)&&("."===w||".."===w)||""===w,A=0,C=T.length;C>=0;C--)"."===(w=T[C])?T.splice(C,1):".."===w?(T.splice(C,1),A++):A&&(T.splice(C,1),A--);if(!x&&!b)for(;A--;A)T.unshift("..");!x||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),E&&"/"!==T.join("/").substr(-1)&&T.push("");var O,P=""===T[0]||T[0]&&"/"===T[0].charAt(0);S&&(i.hostname=i.host=P?"":T.length?T.shift():"",(O=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=O.shift(),i.host=i.hostname=O.shift()));return(x=x||i.host&&T.length)&&!P&&T.unshift(""),T.length?i.pathname=T.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},Url.prototype.parseHost=function(){var t=this.host,e=s.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function BrowserInfo(t,e,i){this.name=t,this.version=e,this.os=i}}();e.BrowserInfo=i;var r=function(){return function NodeInfo(e){this.version=e,this.name="node",this.os=t.platform}}();e.NodeInfo=r;var n=function(){return function BotInfo(){this.bot=!0,this.name="bot",this.version=null,this.os=null}}();e.BotInfo=n;var o=3,s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],a=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function parseUserAgent(t){var e=""!==t&&s.reduce(function(e,i){var r=i[0],n=i[1];if(e)return e;var o=n.exec(t);return!!o&&[r,o]},!1);if(!e)return null;var r=e[0],a=e[1];if("searchbot"===r)return new n;var h=a[1]&&a[1].split(/[._]/).slice(0,3);return h?h.length<o&&(h=h.concat(function createVersionParts(t){for(var e=[],i=0;i<t;i++)e.push("0");return e}(o-h.length))):h=[],new i(r,h.join("."),detectOS(t))}function detectOS(t){for(var e=0,i=a.length;e<i;e++){var r=a[e],n=r[0];if(r[1].test(t))return n}return null}function getNodeVersion(){return void 0!==t&&t.version?new r(t.version.slice(1)):null}e.detect=function detect(){return"undefined"!=typeof navigator?parseUserAgent(navigator.userAgent):getNodeVersion()},e.parseUserAgent=parseUserAgent,e.detectOS=detectOS,e.getNodeVersion=getNodeVersion}).call(this,i(5))},function(t,e,i){"use strict";var r=i(24).Loader,n=i(11).Resource,o=i(10),s=i(25);r.Resource=n,r.async=o,r.encodeBinary=s,r.base64=s,t.exports=r,t.exports.Loader=r,t.exports.default=r},function(t,e){var i,r,n=t.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(t){if(i===setTimeout)return setTimeout(t,0);if((i===defaultSetTimout||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(t){i=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){r=defaultClearTimeout}}();var o,s=[],a=!1,h=-1;function cleanUpNextTick(){a&&o&&(a=!1,o.length?s=o.concat(s):h=-1,s.length&&drainQueue())}function drainQueue(){if(!a){var t=runTimeout(cleanUpNextTick);a=!0;for(var e=s.length;e;){for(o=s,s=[];++h<e;)o&&o[h].run();h=-1,e=s.length}o=null,a=!1,function runClearTimeout(t){if(r===clearTimeout)return clearTimeout(t);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function Item(t,e){this.fun=t,this.array=e}function noop(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];s.push(new Item(t,e)),1!==s.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=noop,n.addListener=noop,n.once=noop,n.off=noop,n.removeListener=noop,n.removeAllListeners=noop,n.emit=noop,n.prependListener=noop,n.prependOnceListener=noop,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function Events(){}function EE(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function addListener(t,e,i,r,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new EE(i,r||t,o),a=n?n+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function clearEvent(t,e){0==--t._eventsCount?t._events=new Events:delete t._events[e]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(n=!1)),EventEmitter.prototype.eventNames=function eventNames(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},EventEmitter.prototype.listeners=function listeners(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,s=new Array(o);r<o;r++)s[r]=i[r].fn;return s},EventEmitter.prototype.listenerCount=function listenerCount(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},EventEmitter.prototype.emit=function emit(t,e,i,r,o,s){var a=n?n+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,r),!0;case 5:return l.fn.call(l.context,e,i,r,o),!0;case 6:return l.fn.call(l.context,e,i,r,o,s),!0}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,r);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];l[u].fn.apply(l[u].context,h)}}return!0},EventEmitter.prototype.on=function on(t,e,i){return addListener(this,t,e,i,!1)},EventEmitter.prototype.once=function once(t,e,i){return addListener(this,t,e,i,!0)},EventEmitter.prototype.removeListener=function removeListener(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return clearEvent(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||clearEvent(this,o);else{for(var a=0,h=[],u=s.length;a<u;a++)(s[a].fn!==e||r&&!s[a].once||i&&s[a].context!==i)&&h.push(s[a]);h.length?this._events[o]=1===h.length?h[0]:h:clearEvent(this,o)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(t){var e;return t?(e=n?n+t:t,this._events[e]&&clearEvent(this,e)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=n,EventEmitter.EventEmitter=EventEmitter,t.exports=EventEmitter},function(t,e,i){"use strict";function earcut(t,e,i){i=i||2;var r,n,o,s,a,h,u,l=e&&e.length,c=l?e[0]*i:t.length,d=linkedList(t,0,c,i,!0),p=[];if(!d||d.next===d.prev)return p;if(l&&(d=function eliminateHoles(t,e,i,r){var n,o,s,a,h,u=[];for(n=0,o=e.length;n<o;n++)s=e[n]*r,a=n<o-1?e[n+1]*r:t.length,(h=linkedList(t,s,a,r,!1))===h.next&&(h.steiner=!0),u.push(getLeftmost(h));for(u.sort(compareX),n=0;n<u.length;n++)eliminateHole(u[n],i),i=filterPoints(i,i.next);return i}(t,e,d,i)),t.length>80*i){r=o=t[0],n=s=t[1];for(var f=i;f<c;f+=i)(a=t[f])<r&&(r=a),(h=t[f+1])<n&&(n=h),a>o&&(o=a),h>s&&(s=h);u=0!==(u=Math.max(o-r,s-n))?1/u:0}return earcutLinked(d,p,i,r,n,u),p}function linkedList(t,e,i,r,n){var o,s;if(n===signedArea(t,e,i,r)>0)for(o=e;o<i;o+=r)s=insertNode(o,t[o],t[o+1],s);else for(o=i-r;o>=e;o-=r)s=insertNode(o,t[o],t[o+1],s);return s&&equals(s,s.next)&&(removeNode(s),s=s.next),s}function filterPoints(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!equals(r,r.next)&&0!==area(r.prev,r,r.next))r=r.next;else{if(removeNode(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function earcutLinked(t,e,i,r,n,o,s){if(t){!s&&o&&function indexCurve(t,e,i,r){var n=t;do{null===n.z&&(n.z=zOrder(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function sortLinked(t){var e,i,r,n,o,s,a,h,u=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,r=i,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(h=u;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,u*=2}while(s>1);return t}(n)}(t,r,n,o);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?isEarHashed(t,r,n,o):isEar(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),removeNode(t),t=h.next,u=h.next;else if((t=h)===u){s?1===s?earcutLinked(t=cureLocalIntersections(t,e,i),e,i,r,n,o,2):2===s&&splitEarcut(t,e,i,r,n,o):earcutLinked(filterPoints(t),e,i,r,n,o,1);break}}}function isEar(t){var e=t.prev,i=t,r=t.next;if(area(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(pointInTriangle(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function isEarHashed(t,e,i,r){var n=t.prev,o=t,s=t.next;if(area(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,u=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,l=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,c=zOrder(a,h,e,i,r),d=zOrder(u,l,e,i,r),p=t.prevZ,f=t.nextZ;p&&p.z>=c&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&area(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&area(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function cureLocalIntersections(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!equals(n,o)&&intersects(n,r,r.next,o)&&locallyInside(n,o)&&locallyInside(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),removeNode(r),removeNode(r.next),r=t=o),r=r.next}while(r!==t);return r}function splitEarcut(t,e,i,r,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&isValidDiagonal(s,a)){var h=splitPolygon(s,a);return s=filterPoints(s,s.next),h=filterPoints(h,h.next),earcutLinked(s,e,i,r,n,o),void earcutLinked(h,e,i,r,n,o)}a=a.next}s=s.next}while(s!==t)}function compareX(t,e){return t.x-e.x}function eliminateHole(t,e){if(e=function findHoleBridge(t,e){var i,r=e,n=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===s)return i.prev;var h,u=i,l=i.x,c=i.y,d=1/0;r=i.next;for(;r!==u;)n>=r.x&&r.x>=l&&n!==r.x&&pointInTriangle(o<c?n:s,o,l,c,o<c?s:n,o,r.x,r.y)&&((h=Math.abs(o-r.y)/(n-r.x))<d||h===d&&r.x>i.x)&&locallyInside(r,t)&&(i=r,d=h),r=r.next;return i}(t,e)){var i=splitPolygon(e,t);filterPoints(i,i.next)}}function zOrder(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function getLeftmost(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function pointInTriangle(t,e,i,r,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function intersectsPolygon(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&intersects(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&locallyInside(t,e)&&locallyInside(e,t)&&function middleInside(t,e){var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function area(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function equals(t,e){return t.x===e.x&&t.y===e.y}function intersects(t,e,i,r){return!!(equals(t,e)&&equals(i,r)||equals(t,r)&&equals(i,e))||area(t,e,i)>0!=area(t,e,r)>0&&area(i,r,t)>0!=area(i,r,e)>0}function locallyInside(t,e){return area(t.prev,t,t.next)<0?area(t,e,t.next)>=0&&area(t,t.prev,e)>=0:area(t,e,t.prev)<0||area(t,t.next,e)<0}function splitPolygon(t,e){var i=new Node(t.i,t.x,t.y),r=new Node(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function insertNode(t,e,i,r){var n=new Node(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function removeNode(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Node(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(t,e,i,r){for(var n=0,o=e,s=i-r;o<i;o+=r)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}t.exports=earcut,t.exports.default=earcut,earcut.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,s=Math.abs(signedArea(t,0,o,i));if(n)for(var a=0,h=e.length;a<h;a++){var u=e[a]*i,l=a<h-1?e[a+1]*i:t.length;s-=Math.abs(signedArea(t,u,l,i))}var c=0;for(a=0;a<r.length;a+=3){var d=r[a]*i,p=r[a+1]*i,f=r[a+2]*i;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},earcut.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[n][o][s]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function MiniSignalBinding(t,e,i){void 0===e&&(e=!1),_classCallCheck(this,MiniSignalBinding),this._fn=t,this._once=e,this._thisArg=i,this._next=this._prev=this._owner=null}return r(MiniSignalBinding,[{key:"detach",value:function detach(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),MiniSignalBinding}();function _addMiniSignalBinding(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var o=function(){function MiniSignal(){_classCallCheck(this,MiniSignal),this._head=this._tail=void 0}return r(MiniSignal,[{key:"handlers",value:function handlers(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function has(t){if(!(t instanceof n))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function dispatch(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function add(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return _addMiniSignalBinding(this,new n(t,!1,e))}},{key:"once",value:function once(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return _addMiniSignalBinding(this,new n(t,!0,e))}},{key:"detach",value:function detach(t){if(!(t instanceof n))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function detachAll(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),MiniSignal}();o.MiniSignalBinding=n,e.default=o,t.exports=e.default},function(t,e,i){"use strict";t.exports=function parseURI(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},o=14;o--;)n[i.key[o]]=r[o]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n}},function(t,e,i){"use strict";function _noop(){}function onlyOnce(t){return function onceWrapper(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}e.__esModule=!0,e.eachSeries=function eachSeries(t,e,i,r){var n=0,o=t.length;!function next(s){s||n===o?i&&i(s):r?setTimeout(function(){e(t[n++],next)},1):e(t[n++],next)}()},e.queue=function queue(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,r={_tasks:[],concurrency:e,saturated:_noop,unsaturated:_noop,buffer:e/4,empty:_noop,drain:_noop,error:_noop,started:!1,paused:!1,push:function push(t,e){_insert(t,!1,e)},kill:function kill(){i=0,r.drain=_noop,r.started=!1,r._tasks=[]},unshift:function unshift(t,e){_insert(t,!0,e)},process:function process(){for(;!r.paused&&i<r.concurrency&&r._tasks.length;){var e=r._tasks.shift();0===r._tasks.length&&r.empty(),(i+=1)===r.concurrency&&r.saturated(),t(e.data,onlyOnce(_next(e)))}},length:function length(){return r._tasks.length},running:function running(){return i},idle:function idle(){return r._tasks.length+i===0},pause:function pause(){!0!==r.paused&&(r.paused=!0)},resume:function resume(){if(!1!==r.paused){r.paused=!1;for(var t=1;t<=r.concurrency;t++)r.process()}}};function _insert(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout(function(){return r.drain()},1);else{var n={data:t,callback:"function"==typeof i?i:_noop};e?r._tasks.unshift(n):r._tasks.push(n),setTimeout(function(){return r.process()},1)}}function _next(t){return function next(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&r.error(arguments[0],t.data),i<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}},function(t,e,i){"use strict";e.__esModule=!0,e.Resource=void 0;var r=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}(),n=_interopRequireDefault(i(9)),o=_interopRequireDefault(i(8));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var s=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),a=null;function _noop(){}var h=e.Resource=function(){function Resource(t,e,i){if(function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Resource),"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(Resource.STATUS_FLAGS.DATA_URL,0===e.indexOf("data:")),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=Resource.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=_noop,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new o.default,this.onProgress=new o.default,this.onComplete=new o.default,this.onAfterMiddleware=new o.default}return Resource.setExtensionLoadType=function setExtensionLoadType(t,e){setExtMap(Resource._loadTypeMap,t,e)},Resource.setExtensionXhrType=function setExtensionXhrType(t,e){setExtMap(Resource._xhrTypeMap,t,e)},Resource.prototype.complete=function complete(){this._clearEvents(),this._finish()},Resource.prototype.abort=function abort(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=Resource.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},Resource.prototype.load=function load(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(Resource.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE,this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO,this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO,this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:s&&this.crossOrigin?this._loadXdr():this._loadXhr()}},Resource.prototype._hasFlag=function _hasFlag(t){return 0!=(this._flags&t)},Resource.prototype._setFlag=function _setFlag(t,e){this._flags=e?this._flags|t:this._flags&~t},Resource.prototype._clearEvents=function _clearEvents(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},Resource.prototype._finish=function _finish(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(Resource.STATUS_FLAGS.COMPLETE,!0),this._setFlag(Resource.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},Resource.prototype._loadElement=function _loadElement(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},Resource.prototype._loadSourceElement=function _loadSourceElement(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},Resource.prototype._loadXhr=function _loadXhr(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=Resource.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},Resource.prototype._loadXdr=function _loadXdr(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},Resource.prototype._createSource=function _createSource(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},Resource.prototype._onError=function _onError(t){this.abort("Failed to load element using: "+t.target.nodeName)},Resource.prototype._onProgress=function _onProgress(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},Resource.prototype._onTimeout=function _onTimeout(){this.abort("Load timed out.")},Resource.prototype._xhrOnError=function _xhrOnError(){var t=this.xhr;this.abort(reqType(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},Resource.prototype._xhrOnTimeout=function _xhrOnTimeout(){var t=this.xhr;this.abort(reqType(t)+" Request timed out.")},Resource.prototype._xhrOnAbort=function _xhrOnAbort(){var t=this.xhr;this.abort(reqType(t)+" Request was aborted by the user.")},Resource.prototype._xhrOnLoad=function _xhrOnLoad(){var t=this.xhr,e="",i=void 0===t.status?200:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(e=t.responseText),0===i&&(e.length>0||t.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=Resource.TYPE.TEXT;else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=Resource.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{var n=document.createElement("div");n.innerHTML=e,this.data=n}this.type=Resource.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},Resource.prototype._determineCrossOrigin=function _determineCrossOrigin(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,a||(a=document.createElement("a")),a.href=t;var i=!(t=(0,n.default)(a.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},Resource.prototype._determineXhrType=function _determineXhrType(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT},Resource.prototype._determineLoadType=function _determineLoadType(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR},Resource.prototype._getExtension=function _getExtension(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),o=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},Resource.prototype._getMimeFromXhrType=function _getMimeFromXhrType(t){switch(t){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r(Resource,[{key:"isDataUrl",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]),Resource}();function setExtMap(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function reqType(t){return t.toString().replace("object ","")}h.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},h.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},h.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},h.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},h._loadTypeMap={gif:h.LOAD_TYPE.IMAGE,png:h.LOAD_TYPE.IMAGE,bmp:h.LOAD_TYPE.IMAGE,jpg:h.LOAD_TYPE.IMAGE,jpeg:h.LOAD_TYPE.IMAGE,tif:h.LOAD_TYPE.IMAGE,tiff:h.LOAD_TYPE.IMAGE,webp:h.LOAD_TYPE.IMAGE,tga:h.LOAD_TYPE.IMAGE,svg:h.LOAD_TYPE.IMAGE,"svg+xml":h.LOAD_TYPE.IMAGE,mp3:h.LOAD_TYPE.AUDIO,ogg:h.LOAD_TYPE.AUDIO,wav:h.LOAD_TYPE.AUDIO,mp4:h.LOAD_TYPE.VIDEO,webm:h.LOAD_TYPE.VIDEO},h._xhrTypeMap={xhtml:h.XHR_RESPONSE_TYPE.DOCUMENT,html:h.XHR_RESPONSE_TYPE.DOCUMENT,htm:h.XHR_RESPONSE_TYPE.DOCUMENT,xml:h.XHR_RESPONSE_TYPE.DOCUMENT,tmx:h.XHR_RESPONSE_TYPE.DOCUMENT,svg:h.XHR_RESPONSE_TYPE.DOCUMENT,tsx:h.XHR_RESPONSE_TYPE.DOCUMENT,gif:h.XHR_RESPONSE_TYPE.BLOB,png:h.XHR_RESPONSE_TYPE.BLOB,bmp:h.XHR_RESPONSE_TYPE.BLOB,jpg:h.XHR_RESPONSE_TYPE.BLOB,jpeg:h.XHR_RESPONSE_TYPE.BLOB,tif:h.XHR_RESPONSE_TYPE.BLOB,tiff:h.XHR_RESPONSE_TYPE.BLOB,webp:h.XHR_RESPONSE_TYPE.BLOB,tga:h.XHR_RESPONSE_TYPE.BLOB,json:h.XHR_RESPONSE_TYPE.JSON,text:h.XHR_RESPONSE_TYPE.TEXT,txt:h.XHR_RESPONSE_TYPE.TEXT,ttf:h.XHR_RESPONSE_TYPE.BUFFER,otf:h.XHR_RESPONSE_TYPE.BUFFER},h.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",t.exports.default=h},function(e,i,r){var n;!function(){function aa(t,e,i){return t.call.apply(t.bind,arguments)}function ba(t,e,i){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function p(t,e,i){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba).apply(null,arguments)}var o=Date.now||function(){return+new Date};function ca(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var s=!!window.FontFace;function t(t,e,i,r){if(e=t.c.createElement(e),i)for(var n in i)i.hasOwnProperty(n)&&("style"==n?e.style.cssText=i[n]:e.setAttribute(n,i[n]));return r&&e.appendChild(t.c.createTextNode(r)),e}function u(t,e,i){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(i,t.lastChild)}function v(t){t.parentNode&&t.parentNode.removeChild(t)}function w(t,e,i){e=e||[],i=i||[];for(var r=t.className.split(/\s+/),n=0;n<e.length;n+=1){for(var o=!1,s=0;s<r.length;s+=1)if(e[n]===r[s]){o=!0;break}o||r.push(e[n])}for(e=[],n=0;n<r.length;n+=1){for(o=!1,s=0;s<i.length;s+=1)if(r[n]===i[s]){o=!0;break}o||e.push(r[n])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function y(t,e){for(var i=t.className.split(/\s+/),r=0,n=i.length;r<n;r++)if(i[r]==e)return!0;return!1}function z(e,i,r){function d(){h&&n&&o&&(h(a),h=null)}i=t(e,"link",{rel:"stylesheet",href:i,media:"all"});var n=!1,o=!0,a=null,h=r||null;s?(i.onload=function(){n=!0,d()},i.onerror=function(){n=!0,a=Error("Stylesheet failed to load"),d()}):setTimeout(function(){n=!0,d()},0),u(e,"head",i)}function A(e,i,r,n){var o=e.c.getElementsByTagName("head")[0];if(o){var s=t(e,"script",{src:i}),a=!1;return s.onload=s.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,r&&r(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&o.removeChild(s))},o.appendChild(s),setTimeout(function(){a||(a=!0,r&&r(Error("Script load timeout")))},n||5e3),s}return null}function B(){this.a=0,this.c=null}function C(t){return t.a++,function(){t.a--,D(t)}}function E(t,e){t.c=e,D(t)}function D(t){0==t.a&&t.c&&(t.c(),t.c=null)}function F(t){this.a=t||"-"}function G(t,e){this.c=t,this.f=4,this.a="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function I(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var r=t[i].replace(/['"]/g,"");-1!=r.indexOf(" ")||/^\d/.test(r)?e.push("'"+r+"'"):e.push(r)}return e.join(",")}function J(t){return t.a+t.f}function H(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function ga(t){var e=4,i="n",r=null;return t&&((r=t.match(/(normal|oblique|italic)/i))&&r[1]&&(i=r[1].substr(0,1).toLowerCase()),(r=t.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?e=7:/[1-9]00/.test(r[1])&&(e=parseInt(r[1].substr(0,1),10)))),i+e}function ha(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new F("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function L(t){if(t.g){var e=y(t.f,t.a.c("wf","active")),i=[],r=[t.a.c("wf","loading")];e||i.push(t.a.c("wf","inactive")),w(t.f,i,r)}K(t,"inactive")}function K(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,J(i)):t.h[e]())}function ja(){this.c={}}function M(e,i){this.c=e,this.f=i,this.a=t(this.c,"span",{"aria-hidden":"true"},this.f)}function N(t){u(t.c,"body",t.a)}function O(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+I(t.c)+";font-style:"+H(t)+";font-weight:"+t.f+"00;"}function P(t,e,i,r,n,o){this.g=t,this.j=e,this.a=r,this.c=i,this.f=n||3e3,this.h=o||void 0}function Q(t,e,i,r,n,o,s){this.v=t,this.B=e,this.c=i,this.a=r,this.s=s||"BESbswy",this.f={},this.w=n||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new M(this.c,this.s),this.h=new M(this.c,this.s),this.j=new M(this.c,this.s),this.m=new M(this.c,this.s),t=O(t=new G(this.a.c+",serif",J(this.a))),this.g.a.style.cssText=t,t=O(t=new G(this.a.c+",sans-serif",J(this.a))),this.h.a.style.cssText=t,t=O(t=new G("serif",J(this.a))),this.j.a.style.cssText=t,t=O(t=new G("sans-serif",J(this.a))),this.m.a.style.cssText=t,N(this.g),N(this.h),N(this.j),N(this.m)}F.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},P.prototype.start=function(){var t=this.c.o.document,e=this,i=o(),r=new Promise(function(r,n){!function f(){o()-i>=e.f?n():t.fonts.load(function fa(t){return H(t)+" "+t.f+"00 300px "+I(t.c)}(e.a),e.h).then(function(t){1<=t.length?r():setTimeout(f,25)},function(){n()})}()}),n=null,s=new Promise(function(t,i){n=setTimeout(i,e.f)});Promise.race([s,r]).then(function(){n&&(clearTimeout(n),n=null),e.g(e.a)},function(){e.j(e.a)})};var a={D:"serif",C:"sans-serif"},h=null;function T(){if(null===h){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);h=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return h}function la(t,e,i){for(var r in a)if(a.hasOwnProperty(r)&&e===t.f[a[r]]&&i===t.f[a[r]])return!0;return!1}function U(t){var e,i=t.g.a.offsetWidth,r=t.h.a.offsetWidth;(e=i===t.f.serif&&r===t.f["sans-serif"])||(e=T()&&la(t,i,r)),e?o()-t.A>=t.w?T()&&la(t,i,r)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?V(t,t.v):V(t,t.B):function ma(t){setTimeout(p(function(){U(this)},t),50)}(t):V(t,t.v)}function V(t,e){setTimeout(p(function(){v(this.g.a),v(this.h.a),v(this.j.a),v(this.m.a),e(this.a)},t),0)}function W(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=o(),U(this)};var l=null;function na(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&w(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),K(t,"active")):L(t.a))}function oa(t){this.j=t,this.a=new ja,this.h=0,this.f=this.g=!0}function qa(t,e,i,r,n){var o=0==--t.h;(t.f||t.g)&&setTimeout(function(){var t=n||null,s=r||{};if(0===i.length&&o)L(e.a);else{e.f+=i.length,o&&(e.j=o);var a,h=[];for(a=0;a<i.length;a++){var u=i[a],c=s[u.c],d=e.a,f=u;if(d.g&&w(d.f,[d.a.c("wf",f.c,J(f).toString(),"loading")]),K(d,"fontloading",f),d=null,null===l)if(window.FontFace){f=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var m=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);l=f?42<parseInt(f[1],10):!m}else l=!1;d=l?new P(p(e.g,e),p(e.h,e),e.c,u,e.s,c):new Q(p(e.g,e),p(e.h,e),e.c,u,e.s,t,c),h.push(d)}for(a=0;a<h.length;a++)h[a].start()}},0)}function ra(t,e){this.c=t,this.a=e}function sa(t,e){this.c=t,this.a=e}function ta(t,e){this.c=t||c,this.a=[],this.f=[],this.g=e||""}W.prototype.g=function(t){var e=this.a;e.g&&w(e.f,[e.a.c("wf",t.c,J(t).toString(),"active")],[e.a.c("wf",t.c,J(t).toString(),"loading"),e.a.c("wf",t.c,J(t).toString(),"inactive")]),K(e,"fontactive",t),this.m=!0,na(this)},W.prototype.h=function(t){var e=this.a;if(e.g){var i=y(e.f,e.a.c("wf",t.c,J(t).toString(),"active")),r=[],n=[e.a.c("wf",t.c,J(t).toString(),"loading")];i||r.push(e.a.c("wf",t.c,J(t).toString(),"inactive")),w(e.f,r,n)}K(e,"fontinactive",t),na(this)},oa.prototype.load=function(t){this.c=new ca(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function pa(t,e,i){var r=[],n=i.timeout;!function ia(t){t.g&&w(t.f,[t.a.c("wf","loading")]),K(t,"loading")}(e);var r=function ka(t,e,i){var r,n=[];for(r in e)if(e.hasOwnProperty(r)){var o=t.c[r];o&&n.push(o(e[r],i))}return n}(t.a,i,t.c),o=new W(t.c,e,n);for(t.h=r.length,e=0,i=r.length;e<i;e++)r[e].load(function(e,i,r){qa(t,o,e,i,r)})}(this,new ha(this.c,t),t)},ra.prototype.load=function(t){var e=this,i=e.a.projectId,r=e.a.version;if(i){var n=e.c.o;A(this.c,(e.a.api||"https://fast.fonts.net/jsapi")+"/"+i+".js"+(r?"?v="+r:""),function(r){r?t([]):(n["__MonotypeConfiguration__"+i]=function(){return e.a},function b(){if(n["__mti_fntLst"+i]){var e,r=n["__mti_fntLst"+i](),o=[];if(r)for(var s=0;s<r.length;s++){var a=r[s].fontfamily;null!=r[s].fontStyle&&null!=r[s].fontWeight?(e=r[s].fontStyle+r[s].fontWeight,o.push(new G(a,e))):o.push(new G(a))}t(o)}else setTimeout(function(){b()},50)}())}).id="__MonotypeAPIScript__"+i}else t([])},sa.prototype.load=function(t){var e,i,r=this.a.urls||[],n=this.a.families||[],o=this.a.testStrings||{},s=new B;for(e=0,i=r.length;e<i;e++)z(this.c,r[e],C(s));var a=[];for(e=0,i=n.length;e<i;e++)if((r=n[e].split(":"))[1])for(var h=r[1].split(","),u=0;u<h.length;u+=1)a.push(new G(r[0],h[u]));else a.push(new G(r[0]));E(s,function(){t(a,o)})};var c="https://fonts.googleapis.com/css";function ya(t){this.f=t,this.a=[],this.c={}}var m={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},g={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},_={i:"i",italic:"i",n:"n",normal:"n"},x=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Ea(t,e){this.c=t,this.a=e}var S={Arimo:!0,Cousine:!0,Tinos:!0};function Ga(t,e){this.c=t,this.a=e}function Ha(t,e){this.c=t,this.f=e,this.a=[]}Ea.prototype.load=function(t){var e=new B,i=this.c,r=new ta(this.a.api,this.a.text),n=this.a.families;!function va(t,e){for(var i=e.length,r=0;r<i;r++){var n=e[r].split(":");3==n.length&&t.f.push(n.pop());var o="";2==n.length&&""!=n[1]&&(o=":"),t.a.push(n.join(o))}}(r,n);var o=new ya(n);!function Da(t){for(var e=t.f.length,i=0;i<e;i++){var r=t.f[i].split(":"),n=r[0].replace(/\+/g," "),o=["n4"];if(2<=r.length){var s;if(s=[],a=r[1])for(var a,h=(a=a.split(",")).length,u=0;u<h;u++){var l;if((l=a[u]).match(/^[\w-]+$/))if(null==(d=x.exec(l.toLowerCase())))l="";else{if(l=null==(l=d[2])||""==l?"n":_[l],null==(d=d[1])||""==d)d="4";else var c=g[d],d=c||(isNaN(d)?"4":d.substr(0,1));l=[l,d].join("")}else l="";l&&s.push(l)}0<s.length&&(o=s),3==r.length&&(s=[],0<(r=(r=r[2])?r.split(","):s).length&&(r=m[r[0]])&&(t.c[n]=r))}for(t.c[n]||(r=m[n])&&(t.c[n]=r),r=0;r<o.length;r+=1)t.a.push(new G(n,o[r]))}}(o),z(i,function wa(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],r=0;r<e;r++)i.push(t.a[r].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(r),C(e)),E(e,function(){t(o.a,o.c,S)})},Ga.prototype.load=function(t){var e=this.a.id,i=this.c.o;e?A(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",function(e){if(e)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){e=i.Typekit.config.fn;for(var r=[],n=0;n<e.length;n+=2)for(var o=e[n],s=e[n+1],a=0;a<s.length;a++)r.push(new G(o,s[a]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(r)}},2e3):t([])},Ha.prototype.load=function(t){var e=this.f.id,i=this.c.o,r=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(e,i){for(var n=0,o=i.fonts.length;n<o;++n){var s=i.fonts[n];r.a.push(new G(s.name,ga("font-weight:"+s.weight+";font-style:"+s.style)))}t(r.a)},A(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function ea(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",function(e){e&&t([])})):t([])};var R=new oa(window);R.a.c.custom=function(t,e){return new sa(e,t)},R.a.c.fontdeck=function(t,e){return new Ha(e,t)},R.a.c.monotype=function(t,e){return new ra(e,t)},R.a.c.typekit=function(t,e){return new Ga(e,t)},R.a.c.google=function(t,e){return new Ea(e,t)};var k={load:p(R.load,R)};void 0===(n=function(){return k}.call(i,r,i,e))||(e.exports=n)}()},function(t,e,i){(function(r,n){var o;!function(r){var s=r.Promise,a=s&&"resolve"in s&&"reject"in s&&"all"in s&&"race"in s&&function(){var t;return new s(function(e){t=e}),"function"==typeof t}();e?(e.Promise=a?s:Promise,e.Polyfill=Promise):void 0===(o=function(){return a?s:Promise}.call(e,i,e,t))||(t.exports=o);var h="pending",u="sealed",l="fulfilled",c="rejected",d=function(){};function isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}var p,f=void 0!==n?n:setTimeout,m=[];function asyncFlush(){for(var t=0;t<m.length;t++)m[t][0](m[t][1]);m=[],p=!1}function asyncCall(t,e){m.push([t,e]),p||(p=!0,f(asyncFlush,0))}function invokeCallback(t){var e=t.owner,i=e.state_,r=e.data_,n=t[i],o=t.then;if("function"==typeof n){i=l;try{r=n(r)}catch(t){reject(o,t)}}handleThenable(o,r)||(i===l&&resolve(o,r),i===c&&reject(o,r))}function handleThenable(t,e){var i;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(r){i||(i=!0,e!==r?resolve(t,r):fulfill(t,r))},function(e){i||(i=!0,reject(t,e))}),!0}}catch(e){return i||reject(t,e),!0}return!1}function resolve(t,e){t!==e&&handleThenable(t,e)||fulfill(t,e)}function fulfill(t,e){t.state_===h&&(t.state_=u,t.data_=e,asyncCall(publishFulfillment,t))}function reject(t,e){t.state_===h&&(t.state_=u,t.data_=e,asyncCall(publishRejection,t))}function publish(t){var e=t.then_;t.then_=void 0;for(var i=0;i<e.length;i++)invokeCallback(e[i])}function publishFulfillment(t){t.state_=l,publish(t)}function publishRejection(t){t.state_=c,publish(t)}function Promise(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof Promise==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function invokeResolver(t,e){function rejectPromise(t){reject(e,t)}try{t(function resolvePromise(t){resolve(e,t)},rejectPromise)}catch(t){rejectPromise(t)}}(t,this)}Promise.prototype={constructor:Promise,state_:h,then_:null,data_:void 0,then:function(t,e){var i={owner:this,then:new this.constructor(d),fulfilled:t,rejected:e};return this.state_===l||this.state_===c?asyncCall(invokeCallback,i):this.then_.push(i),i.then},catch:function(t){return this.then(null,t)}},Promise.all=function(t){if(!isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(e,i){var r=[],n=0;function resolver(t){return n++,function(i){r[t]=i,--n||e(r)}}for(var o,s=0;s<t.length;s++)(o=t[s])&&"function"==typeof o.then?o.then(resolver(s),i):r[s]=o;n||e(r)})},Promise.race=function(t){if(!isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(e,i){for(var r,n=0;n<t.length;n++)(r=t[n])&&"function"==typeof r.then?r.then(e,i):e(r)})},Promise.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})},Promise.reject=function(t){return new this(function(e,i){i(t)})}}("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this)}).call(this,i(1),i(16).setImmediate)},function(t,e,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function shouldUseNative(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,s,a=function toObject(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),h=1;h<arguments.length;h++){for(var u in i=Object(arguments[h]))n.call(i,u)&&(a[u]=i[u]);if(r){s=r(i);for(var l=0;l<s.length;l++)o.call(i,s[l])&&(a[s[l]]=i[s[l]])}}return a}},function(t,e,i){"use strict";(function(t){var e=i(13),r=i(14),n=i.n(r);
/*!
 * @pixi/polyfill - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
window.Promise||(window.Promise=e.Polyfill),Object.assign||(Object.assign=n.a);var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function now(){return(new Date).getTime()}),!o.performance||!o.performance.now){var s=Date.now();o.performance||(o.performance={}),o.performance.now=function(){return Date.now()-s}}for(var a=Date.now(),h=["ms","moz","webkit","o"],u=0;u<h.length&&!o.requestAnimationFrame;++u){var l=h[u];o.requestAnimationFrame=o[l+"RequestAnimationFrame"],o.cancelAnimationFrame=o[l+"CancelAnimationFrame"]||o[l+"CancelRequestAnimationFrame"]}o.requestAnimationFrame||(o.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+a-e;return i<0&&(i=0),a=e,setTimeout(function(){a=Date.now(),t(performance.now())},i)}),o.cancelAnimationFrame||(o.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function mathSign(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function numberIsInteger(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,i(1))},function(t,e,i){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function Timeout(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new Timeout(n.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new Timeout(n.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function onTimeout(){t._onTimeout&&t._onTimeout()},e))},i(17),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(1))},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var r,n=1,o={},s=!1,a=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?function installNextTickImplementation(){r=function(t){e.nextTick(function(){runIfPresent(t)})}}():!function canUsePostMessage(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?function installMessageChannelImplementation(){var t=new MessageChannel;t.port1.onmessage=function(t){runIfPresent(t.data)},r=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function installReadyStateChangeImplementation(){var t=a.documentElement;r=function(e){var i=a.createElement("script");i.onreadystatechange=function(){runIfPresent(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}():function installSetTimeoutImplementation(){r=function(t){setTimeout(runIfPresent,0,t)}}():function installPostMessageImplementation(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(e)&&runIfPresent(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),r=function(i){t.postMessage(e+i,"*")}}(),h.setImmediate=function setImmediate(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var s={callback:t,args:e};return o[n]=s,r(n),n++},h.clearImmediate=clearImmediate}function clearImmediate(t){delete o[t]}function runIfPresent(t){if(s)setTimeout(runIfPresent,0,t);else{var e=o[t];if(e){s=!0;try{!function run(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(i,r)}}(e)}finally{clearImmediate(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(1),i(5))},function(t,e,i){(function(t,r){var n;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,h=2147483647,u=36,l=1,c=26,d=38,p=700,f=72,m=128,g="-",y=/^xn--/,v=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=u-l,T=Math.floor,S=String.fromCharCode;function error(t){throw new RangeError(x[t])}function map(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function mapDomain(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+map((t=t.replace(_,".")).split("."),e).join(".")}function ucs2decode(t){for(var e,i,r=[],n=0,o=t.length;n<o;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<o?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function ucs2encode(t){return map(t,function(t){var e="";return t>65535&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)}).join("")}function digitToBasic(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function adapt(t,e,i){var r=0;for(t=i?T(t/p):t>>1,t+=T(t/e);t>b*c>>1;r+=u)t=T(t/b);return T(r+(b+1)*t/(t+d))}function decode(t){var e,i,r,n,o,s,a,d,p,y,v,_=[],x=t.length,b=0,S=m,w=f;for((i=t.lastIndexOf(g))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&error("not-basic"),_.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<x;){for(o=b,s=1,a=u;n>=x&&error("invalid-input"),((d=(v=t.charCodeAt(n++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:u)>=u||d>T((h-b)/s))&&error("overflow"),b+=d*s,!(d<(p=a<=w?l:a>=w+c?c:a-w));a+=u)s>T(h/(y=u-p))&&error("overflow"),s*=y;w=adapt(b-o,e=_.length+1,0==o),T(b/e)>h-S&&error("overflow"),S+=T(b/e),b%=e,_.splice(b++,0,S)}return ucs2encode(_)}function encode(t){var e,i,r,n,o,s,a,d,p,y,v,_,x,b,w,E=[];for(_=(t=ucs2decode(t)).length,e=m,i=0,o=f,s=0;s<_;++s)(v=t[s])<128&&E.push(S(v));for(r=n=E.length,n&&E.push(g);r<_;){for(a=h,s=0;s<_;++s)(v=t[s])>=e&&v<a&&(a=v);for(a-e>T((h-i)/(x=r+1))&&error("overflow"),i+=(a-e)*x,e=a,s=0;s<_;++s)if((v=t[s])<e&&++i>h&&error("overflow"),v==e){for(d=i,p=u;!(d<(y=p<=o?l:p>=o+c?c:p-o));p+=u)w=d-y,b=u-y,E.push(S(digitToBasic(y+w%b,0))),d=T(w/b);E.push(S(digitToBasic(d,0))),o=adapt(i,x,r==n),i=0,++r}++i,++e}return E.join("")}a={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function toASCII(t){return mapDomain(t,function(t){return v.test(t)?"xn--"+encode(t):t})},toUnicode:function toUnicode(t){return mapDomain(t,function(t){return y.test(t)?decode(t.slice(4).toLowerCase()):t})}},void 0===(n=function(){return a}.call(e,i,e,t))||(t.exports=n)}()}).call(this,i(19)(t),i(1))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,i){"use strict";e.decode=e.parse=i(22),e.encode=e.stringify=i(23)},function(t,e,i){"use strict";function hasOwnProperty(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,n){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(e);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var h=t.length;a>0&&h>a&&(h=a);for(var u=0;u<h;++u){var l,c,d,p,f=t[u].replace(s,"%20"),m=f.indexOf(i);m>=0?(l=f.substr(0,m),c=f.substr(m+1)):(l=f,c=""),d=decodeURIComponent(l),p=decodeURIComponent(c),hasOwnProperty(o,d)?r(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,i){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,i,s){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?map(o(t),function(o){var s=encodeURIComponent(r(o))+i;return n(t[o])?map(t[o],function(t){return s+encodeURIComponent(r(t))}).join(e):s+encodeURIComponent(r(t[o]))}).join(e):s?encodeURIComponent(r(s))+i+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function map(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},function(t,e,i){"use strict";e.__esModule=!0,e.Loader=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}(),o=_interopRequireDefault(i(8)),s=_interopRequireDefault(i(9)),a=function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(10)),h=i(11);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var u=/(#[\w-]+)?$/,l=e.Loader=function(){function Loader(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Loader),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,i){return t._loadResource(e,i)},this._queue=a.queue(this._boundLoadResource,i),this._queue.pause(),this.resources={},this.onProgress=new o.default,this.onError=new o.default,this.onLoad=new o.default,this.onStart=new o.default,this.onComplete=new o.default;for(var r=0;r<Loader._defaultBeforeMiddleware.length;++r)this.pre(Loader._defaultBeforeMiddleware[r]);for(var n=0;n<Loader._defaultAfterMiddleware.length;++n)this.use(Loader._defaultAfterMiddleware[n])}return Loader.prototype.add=function add(t,e,i,n){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===(void 0===t?"undefined":r(t))&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new h.Resource(t,e,i),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var s=i.parentResource,a=[],u=0;u<s.children.length;++u)s.children[u].isComplete||a.push(s.children[u]);var l=s.progressChunk*(a.length+1)/(a.length+2);s.children.push(this.resources[t]),s.progressChunk=l;for(var c=0;c<a.length;++c)a[c].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},Loader.prototype.pre=function pre(t){return this._beforeMiddleware.push(t),this},Loader.prototype.use=function use(t){return this._afterMiddleware.push(t),this},Loader.prototype.reset=function reset(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},Loader.prototype.load=function load(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Loader.prototype._prepareUrl=function _prepareUrl(t){var e=(0,s.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=u.exec(i)[0];-1!==(i=i.substr(0,i.length-r.length)).indexOf("?")?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=r}return i},Loader.prototype._loadResource=function _loadResource(t,e){var i=this;t._dequeue=e,a.eachSeries(this._beforeMiddleware,function(e,r){e.call(i,t,function(){r(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},Loader.prototype._onStart=function _onStart(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},Loader.prototype._onComplete=function _onComplete(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},Loader.prototype._onLoad=function _onLoad(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),a.eachSeries(this._afterMiddleware,function(i,r){i.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()},!0)},n(Loader,[{key:"concurrency",get:function get(){return this._queue.concurrency},set:function set(t){this._queue.concurrency=t}}]),Loader}();l._defaultBeforeMiddleware=[],l._defaultAfterMiddleware=[],l.pre=function LoaderPreStatic(t){return l._defaultBeforeMiddleware.push(t),l},l.use=function LoaderUseStatic(t){return l._defaultAfterMiddleware.push(t),l}},function(t,e,i){"use strict";e.__esModule=!0,e.encodeBinary=encodeBinary;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(t){for(var e="",i=0;i<t.length;){for(var n=[0,0,0],o=[0,0,0,0],s=0;s<n.length;++s)i<t.length?n[s]=255&t.charCodeAt(i++):n[s]=0;switch(o[0]=n[0]>>2,o[1]=(3&n[0])<<4|n[1]>>4,o[2]=(15&n[1])<<2|n[2]>>6,o[3]=63&n[2],i-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var a=0;a<o.length;++a)e+=r.charAt(o[a])}return e}t.exports.default=encodeBinary},function(t,e,i){"use strict";i.r(e);var r={};i.r(r),i.d(r,"isMobile",function(){return s.a}),i.d(r,"EventEmitter",function(){return u.a}),i.d(r,"earcut",function(){return c.a}),i.d(r,"url",function(){return p.a}),i.d(r,"BaseTextureCache",function(){return D}),i.d(r,"CanvasRenderTarget",function(){return F}),i.d(r,"DATA_URI",function(){return k}),i.d(r,"ProgramCache",function(){return M}),i.d(r,"TextureCache",function(){return R}),i.d(r,"clearTextureCache",function(){return clearTextureCache}),i.d(r,"correctBlendMode",function(){return correctBlendMode}),i.d(r,"createIndicesForQuads",function(){return createIndicesForQuads}),i.d(r,"decomposeDataUri",function(){return decomposeDataUri}),i.d(r,"deprecation",function(){return deprecation}),i.d(r,"destroyTextureCache",function(){return destroyTextureCache}),i.d(r,"determineCrossOrigin",function(){return determineCrossOrigin}),i.d(r,"getResolutionOfUrl",function(){return getResolutionOfUrl}),i.d(r,"hex2rgb",function(){return hex2rgb}),i.d(r,"hex2string",function(){return hex2string}),i.d(r,"isPow2",function(){return isPow2}),i.d(r,"isWebGLSupported",function(){return isWebGLSupported}),i.d(r,"log2",function(){return log2}),i.d(r,"nextPow2",function(){return nextPow2}),i.d(r,"premultiplyBlendMode",function(){return P}),i.d(r,"premultiplyRgba",function(){return premultiplyRgba}),i.d(r,"premultiplyTint",function(){return premultiplyTint}),i.d(r,"premultiplyTintToRgba",function(){return premultiplyTintToRgba}),i.d(r,"removeItems",function(){return removeItems}),i.d(r,"rgb2hex",function(){return rgb2hex}),i.d(r,"sayHello",function(){return sayHello}),i.d(r,"sign",function(){return sign}),i.d(r,"skipHello",function(){return skipHello}),i.d(r,"string2hex",function(){return string2hex}),i.d(r,"trimCanvas",function(){return trimCanvas}),i.d(r,"uid",function(){return uid});var n=i(12),o=(i(15),i(0)),s=i.n(o);var a={MIPMAP_TEXTURES:1,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:
/*!
 * @pixi/settings - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
function maxRecommendedTextures(t){var e=!0;if(s.a.tablet||s.a.phone){if(e=!1,s.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)>=11&&(e=!0)}if(s.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:s.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:function canUploadSameBuffer(){return!s.a.apple.device}(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},h=i(6),u=i.n(h),l=i(7),c=i.n(l),d=i(2),p=i.n(d),f={WEBGL_LEGACY:0,WEBGL:1,WEBGL2:2},m={UNKNOWN:0,WEBGL:1,CANVAS:2},g={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19,NONE:20,SRC_OVER:0,SRC_IN:21,SRC_OUT:22,SRC_ATOP:23,DST_OVER:24,DST_IN:25,DST_OUT:26,DST_ATOP:27,ERASE:26,SUBTRACT:28},y={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},v={RGBA:6408,RGB:6407,ALPHA:6406,LUMINANCE:6409,LUMINANCE_ALPHA:6410,DEPTH_COMPONENT:6402,DEPTH_STENCIL:34041},_={TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_2D_ARRAY:35866,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074},x={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,FLOAT:5126,HALF_FLOAT:36193},b=33071,T=10497,S=1,w=1,E={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};
/*!
 * @pixi/utils - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
a.RETINA_PREFIX=/@([0-9\.]+)x/;var A,C=!1,O="5.0.4";function skipHello(){C=!0}function sayHello(t){if(!C){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c PixiJS "+O+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+O+" - "+t+" - http://www.pixijs.com/");C=!0}}function isWebGLSupported(){return void 0===A&&(A=function supported(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(t){return!1}}()),A}function hex2rgb(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function hex2string(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)}function string2hex(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}function rgb2hex(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var P=function mapPremultipliedBlendModes(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[g.NORMAL_NPM]=g.NORMAL,t[g.ADD_NPM]=g.ADD,t[g.SCREEN_NPM]=g.SCREEN,e[g.NORMAL]=g.NORMAL_NPM,e[g.ADD]=g.ADD_NPM,e[g.SCREEN]=g.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function correctBlendMode(t,e){return P[e?1:0][t]}function premultiplyRgba(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i}function premultiplyTint(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)}function premultiplyTintToRgba(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}function createIndicesForQuads(t){for(var e=6*t,i=new Uint16Array(e),r=0,n=0;r<e;r+=6,n+=4)i[r+0]=n+0,i[r+1]=n+1,i[r+2]=n+2,i[r+3]=n+0,i[r+4]=n+2,i[r+5]=n+3;return i}function removeItems(t,e,i){var r,n=t.length;if(!(e>=n||0===i)){var o=n-(i=e+i>n?n-e:i);for(r=e;r<o;++r)t[r]=t[r+i];t.length=o}}var I=0;function uid(){return++I}function sign(t){return 0===t?0:t<0?-1:1}function nextPow2(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function isPow2(t){return!(t&t-1||!t)}function log2(t){var e=(t>65535)<<4,i=((t>>>=e)>255)<<3;return e|=i,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1}var M={},R=Object.create(null),D=Object.create(null);function destroyTextureCache(){var t;for(t in R)R[t].destroy();for(t in D)D[t].destroy()}function clearTextureCache(){var t;for(t in R)delete R[t];for(t in D)delete D[t]}function trimCanvas(t){var e,i,r,n=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,n,o).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===u.top&&(u.top=r),null===u.left?u.left=i:i<u.left&&(u.left=i),null===u.right?u.right=i+1:u.right<i&&(u.right=i+1),null===u.bottom?u.bottom=r:u.bottom<r&&(u.bottom=r));return null!==u.top&&(n=u.right-u.left,o=u.bottom-u.top+1,l=s.getImageData(u.left,u.top,n,o)),{height:o,width:n,data:l}}var F=function CanvasRenderTarget(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||a.RESOLUTION,this.resize(t,e)},B={width:{configurable:!0},height:{configurable:!0}};F.prototype.clear=function clear(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},F.prototype.resize=function resize(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},F.prototype.destroy=function destroy(){this.context=null,this.canvas=null},B.width.get=function(){return this.canvas.width},B.width.set=function(t){this.canvas.width=t},B.height.get=function(){return this.canvas.height},B.height.set=function(t){this.canvas.height=t},Object.defineProperties(F.prototype,B);var L,k=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function decomposeDataUri(t){var e=k.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function determineCrossOrigin(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,L||(L=document.createElement("a")),L.href=t;var i=!(t=p.a.parse(L.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}function getResolutionOfUrl(t,e){var i=a.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var U={};function deprecation(t,e,i){if(void 0===i&&(i=3),!U[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),U[e]=!0}}
/*!
 * @pixi/math - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var N=function Point(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e};N.prototype.clone=function clone(){return new N(this.x,this.y)},N.prototype.copyFrom=function copyFrom(t){return this.set(t.x,t.y),this},N.prototype.copyTo=function copyTo(t){return t.set(this.x,this.y),t},N.prototype.equals=function equals(t){return t.x===this.x&&t.y===this.y},N.prototype.set=function set(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)};var G=function ObservablePoint(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e},j={x:{configurable:!0},y:{configurable:!0}};G.prototype.clone=function clone(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=t||this.cb,r=e||this.scope;return new G(i,r,this._x,this._y)},G.prototype.set=function set(t,e){var i=t||0,r=e||(0!==e?i:0);this._x===i&&this._y===r||(this._x=i,this._y=r,this.cb.call(this.scope))},G.prototype.copyFrom=function copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},G.prototype.copyTo=function copyTo(t){return t.set(this._x,this._y),t},G.prototype.equals=function equals(t){return t.x===this._x&&t.y===this._y},j.x.get=function(){return this._x},j.x.set=function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},j.y.get=function(){return this._y},j.y.set=function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},Object.defineProperties(G.prototype,j);var X=2*Math.PI,H=180/Math.PI,z=Math.PI/180,Y={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},W=function Matrix(t,e,i,r,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this.array=null},V={IDENTITY:{configurable:!0},TEMP_MATRIX:{configurable:!0}};W.prototype.fromArray=function fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},W.prototype.set=function set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this},W.prototype.toArray=function toArray(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},W.prototype.apply=function apply(t,e){e=e||new N;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},W.prototype.applyInverse=function applyInverse(t,e){e=e||new N;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},W.prototype.translate=function translate(t,e){return this.tx+=t,this.ty+=e,this},W.prototype.scale=function scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},W.prototype.rotate=function rotate(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},W.prototype.append=function append(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},W.prototype.setTransform=function setTransform(t,e,i,r,n,o,s,a,h){return this.a=Math.cos(s+h)*n,this.b=Math.sin(s+h)*n,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},W.prototype.prepend=function prepend(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},W.prototype.decompose=function decompose(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=-Math.atan2(-r,n),s=Math.atan2(i,e),a=Math.abs(o+s);return a<1e-5||Math.abs(X-a)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},W.prototype.invert=function invert(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this},W.prototype.identity=function identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},W.prototype.clone=function clone(){var t=new W;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},W.prototype.copyTo=function copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},W.prototype.copyFrom=function copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},V.IDENTITY.get=function(){return new W},V.TEMP_MATRIX.get=function(){return new W},Object.defineProperties(W,V);var q=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],K=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Z=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],J=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Q=[],$=[];function signum(t){return t<0?-1:t>0?1:0}!function init(){for(var t=0;t<16;t++){var e=[];$.push(e);for(var i=0;i<16;i++)for(var r=signum(q[t]*q[i]+Z[t]*K[i]),n=signum(K[t]*q[i]+J[t]*K[i]),o=signum(q[t]*Z[i]+Z[t]*J[i]),s=signum(K[t]*Z[i]+J[t]*J[i]),a=0;a<16;a++)if(q[a]===r&&K[a]===n&&Z[a]===o&&J[a]===s){e.push(a);break}}for(var h=0;h<16;h++){var u=new W;u.set(q[h],K[h],Z[h],J[h],0,0),Q.push(u)}}();var tt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return q[t]},uY:function(t){return K[t]},vX:function(t){return Z[t]},vY:function(t){return J[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return $[t][e]},sub:function(t,e){return $[t][tt.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?tt.S:tt.N:2*Math.abs(e)<=Math.abs(t)?t>0?tt.E:tt.W:e>0?t>0?tt.SE:tt.SW:t>0?tt.NE:tt.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Q[tt.inv(e)];n.tx=i,n.ty=r,t.append(n)}},et=function Transform(){this.worldTransform=new W,this.localTransform=new W,this.position=new G(this.onChange,this,0,0),this.scale=new G(this.onChange,this,1,1),this.pivot=new G(this.onChange,this,0,0),this.skew=new G(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0},it={rotation:{configurable:!0}};et.prototype.onChange=function onChange(){this._localID++},et.prototype.updateSkew=function updateSkew(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},et.prototype.updateLocalTransform=function updateLocalTransform(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},et.prototype.updateTransform=function updateTransform(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},et.prototype.setFromMatrix=function setFromMatrix(t){t.decompose(this),this._localID++},it.rotation.get=function(){return this._rotation},it.rotation.set=function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},Object.defineProperties(et.prototype,it),et.IDENTITY=new et;var rt=function Rectangle(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Y.RECT},nt={left:{configurable:!0},right:{configurable:!0},top:{configurable:!0},bottom:{configurable:!0}},ot={EMPTY:{configurable:!0}};nt.left.get=function(){return this.x},nt.right.get=function(){return this.x+this.width},nt.top.get=function(){return this.y},nt.bottom.get=function(){return this.y+this.height},ot.EMPTY.get=function(){return new rt(0,0,0,0)},rt.prototype.clone=function clone(){return new rt(this.x,this.y,this.width,this.height)},rt.prototype.copyFrom=function copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},rt.prototype.copyTo=function copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},rt.prototype.contains=function contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},rt.prototype.pad=function pad(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},rt.prototype.fit=function fit(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0)},rt.prototype.ceil=function ceil(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y},rt.prototype.enlarge=function enlarge(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=r,this.height=n-r},Object.defineProperties(rt.prototype,nt),Object.defineProperties(rt,ot);var st=function Circle(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Y.CIRC};st.prototype.clone=function clone(){return new st(this.x,this.y,this.radius)},st.prototype.contains=function contains(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},st.prototype.getBounds=function getBounds(){return new rt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};var at=function Ellipse(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=Y.ELIP};at.prototype.clone=function clone(){return new at(this.x,this.y,this.width,this.height)},at.prototype.contains=function contains(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},at.prototype.getBounds=function getBounds(){return new rt(this.x-this.width,this.y-this.height,this.width,this.height)};var ht=function Polygon(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(Array.isArray(t[0])&&(t=t[0]),t[0]instanceof N){for(var i=[],r=0,n=t.length;r<n;r++)i.push(t[r].x,t[r].y);t=i}this.points=t,this.type=Y.POLY,this.closeStroke=!0};ht.prototype.clone=function clone(){var t=new ht(this.points.slice());return t.closeStroke=this.closeStroke,t},ht.prototype.contains=function contains(t,e){for(var i=!1,r=this.points.length/2,n=0,o=r-1;n<r;o=n++){var s=this.points[2*n],a=this.points[2*n+1],h=this.points[2*o],u=this.points[2*o+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-s)+s&&(i=!i)}return i};var ut=function RoundedRectangle(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Y.RREC};ut.prototype.clone=function clone(){return new ut(this.x,this.y,this.width,this.height,this.radius)},ut.prototype.contains=function contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},
/*!
 * @pixi/display - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
a.SORTABLE_CHILDREN=!1;var lt=function Bounds(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};lt.prototype.isEmpty=function isEmpty(){return this.minX>this.maxX||this.minY>this.maxY},lt.prototype.clear=function clear(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},lt.prototype.getRectangle=function getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?rt.EMPTY:((t=t||new rt(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},lt.prototype.addPoint=function addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},lt.prototype.addQuad=function addQuad(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,o=t[0],s=t[1];e=o<e?o:e,i=s<i?s:i,r=o>r?o:r,n=s>n?s:n,e=(o=t[2])<e?o:e,i=(s=t[3])<i?s:i,r=o>r?o:r,n=s>n?s:n,e=(o=t[4])<e?o:e,i=(s=t[5])<i?s:i,r=o>r?o:r,n=s>n?s:n,e=(o=t[6])<e?o:e,i=(s=t[7])<i?s:i,r=o>r?o:r,n=s>n?s:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},lt.prototype.addFrame=function addFrame(t,e,i,r,n){var o=t.worldTransform,s=o.a,a=o.b,h=o.c,u=o.d,l=o.tx,c=o.ty,d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=s*e+h*i+l,y=a*e+u*i+c;d=g<d?g:d,p=y<p?y:p,f=g>f?g:f,m=y>m?y:m,d=(g=s*r+h*i+l)<d?g:d,p=(y=a*r+u*i+c)<p?y:p,f=g>f?g:f,m=y>m?y:m,d=(g=s*e+h*n+l)<d?g:d,p=(y=a*e+u*n+c)<p?y:p,f=g>f?g:f,m=y>m?y:m,d=(g=s*r+h*n+l)<d?g:d,p=(y=a*r+u*n+c)<p?y:p,f=g>f?g:f,m=y>m?y:m,this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},lt.prototype.addVertexData=function addVertexData(t,e,i){for(var r=this.minX,n=this.minY,o=this.maxX,s=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,o=h>o?h:o,s=u>s?u:s}this.minX=r,this.minY=n,this.maxX=o,this.maxY=s},lt.prototype.addVertices=function addVertices(t,e,i,r){for(var n=t.worldTransform,o=n.a,s=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=i;m<r;m+=2){var g=e[m],y=e[m+1],v=o*g+a*y+u,_=h*y+s*g+l;c=v<c?v:c,d=_<d?_:d,p=v>p?v:p,f=_>f?_:f}this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},lt.prototype.addBounds=function addBounds(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},lt.prototype.addBoundsMask=function addBoundsMask(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<s?i:s,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=o>u?o:u}},lt.prototype.addBoundsArea=function addBoundsArea(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<s?i:s,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=o>u?o:u}};var ct=function(t){function DisplayObject(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new et,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new lt,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1}t&&(DisplayObject.__proto__=t),DisplayObject.prototype=Object.create(t&&t.prototype),DisplayObject.prototype.constructor=DisplayObject;var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return DisplayObject.mixin=function mixin(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(DisplayObject.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new DisplayObject),this.tempDisplayObjectParent},DisplayObject.prototype.updateTransform=function updateTransform(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},DisplayObject.prototype._recursivePostUpdateTransform=function _recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},DisplayObject.prototype.getBounds=function getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new rt),e=this._boundsRect),this._bounds.getRectangle(e)},DisplayObject.prototype.getLocalBounds=function getLocalBounds(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new rt),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},DisplayObject.prototype.toGlobal=function toGlobal(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},DisplayObject.prototype.toLocal=function toLocal(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},DisplayObject.prototype.render=function render(t){},DisplayObject.prototype.setParent=function setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},DisplayObject.prototype.setTransform=function setTransform(t,e,i,r,n,o,s,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=h,this},DisplayObject.prototype.destroy=function destroy(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*H},e.angle.set=function(t){this.transform.rotation=t*z},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)},Object.defineProperties(DisplayObject.prototype,e),DisplayObject}(u.a);function sortChildren(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ct.prototype.displayObjectUpdateTransform=ct.prototype.updateTransform;var dt=function(t){function Container(){t.call(this),this.children=[],this.sortableChildren=a.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(Container.__proto__=t),Container.prototype=Object.create(t&&t.prototype),Container.prototype.constructor=Container;var e={width:{configurable:!0},height:{configurable:!0}};return Container.prototype.onChildrenChange=function onChildrenChange(){},Container.prototype.addChild=function addChild(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},Container.prototype.addChildAt=function addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},Container.prototype.swapChildren=function swapChildren(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},Container.prototype.getChildIndex=function getChildIndex(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},Container.prototype.setChildIndex=function setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},Container.prototype.getChildAt=function getChildAt(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},Container.prototype.removeChild=function removeChild(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},Container.prototype.removeChildAt=function removeChildAt(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},Container.prototype.removeChildren=function removeChildren(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,o=n-r;if(o>0&&o<=n){i=this.children.splice(r,o);for(var s=0;s<i.length;++s)i[s].parent=null,i[s].transform&&(i[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0===o&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.sortChildren=function sortChildren$1(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1},Container.prototype.updateTransform=function updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},Container.prototype.calculateBounds=function calculateBounds(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},Container.prototype._calculateBounds=function _calculateBounds(){},Container.prototype.render=function render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},Container.prototype.renderAdvanced=function renderAdvanced(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,o=this.children.length;n<o;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},Container.prototype._render=function _render(t){},Container.prototype.destroy=function destroy(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(i)for(var n=0;n<r.length;++n)r[n].destroy(e)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(Container.prototype,e),Container}(ct);dt.prototype.containerUpdateTransform=dt.prototype.updateTransform;ct.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1});var pt=function AccessibilityManager(t){this._hookDiv=null,(s.a.tablet||s.a.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,window.addEventListener("keydown",this._onKeyDown,!1)};pt.prototype.createTouchHook=function createTouchHook(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},pt.prototype.destroyTouchHook=function destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},pt.prototype.activate=function activate(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},pt.prototype.deactivate=function deactivate(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},pt.prototype.updateAccessibleObjects=function updateAccessibleObjects(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},pt.prototype.update=function update(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,r=this.div;r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(var n=0;n<this.children.length;n++){var o=this.children[n];if(o.renderId!==this.renderId)o._accessibleActive=!1,removeItems(this.children,n,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,n--,0===this.children.length&&this.deactivate();else{r=o._accessibleDiv;var s=o.hitArea,a=o.worldTransform;o.hitArea?(r.style.left=(a.tx+s.x*a.a)*e+"px",r.style.top=(a.ty+s.y*a.d)*i+"px",r.style.width=s.width*a.a*e+"px",r.style.height=s.height*a.d*i+"px"):(s=o.getBounds(),this.capHitArea(s),r.style.left=s.x*e+"px",r.style.top=s.y*i+"px",r.style.width=s.width*e+"px",r.style.height=s.height*i+"px",r.title!==o.accessibleTitle&&null!==o.accessibleTitle&&(r.title=o.accessibleTitle),r.getAttribute("aria-label")!==o.accessibleHint&&null!==o.accessibleHint&&r.setAttribute("aria-label",o.accessibleHint))}}this.renderId++}},pt.prototype.capHitArea=function capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},pt.prototype.addChild=function addChild(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},pt.prototype._onClick=function _onClick(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},pt.prototype._onFocus=function _onFocus(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},pt.prototype._onFocusOut=function _onFocusOut(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},pt.prototype._onKeyDown=function _onKeyDown(t){9===t.keyCode&&this.activate()},pt.prototype._onMouseMove=function _onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()},pt.prototype.destroy=function destroy(){this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null};
/*!
 * @pixi/runner - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var ft=function Runner(t){this.items=[],this._name=t},mt={empty:{configurable:!0},name:{configurable:!0}};ft.prototype.emit=function emit(t,e,i,r,n,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");for(var h=this.name,u=this.items,l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,o,s,a);return this},ft.prototype.add=function add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this},ft.prototype.remove=function remove(t){var e=this.items.indexOf(t);return-1!==e&&this.items.splice(e,1),this},ft.prototype.contains=function contains(t){return-1!==this.items.indexOf(t)},ft.prototype.removeAll=function removeAll(){return this.items.length=0,this},ft.prototype.destroy=function destroy(){this.removeAll(),this.items=null,this._name=null},mt.empty.get=function(){return 0===this.items.length},mt.name.get=function(){return this._name},Object.defineProperties(ft.prototype,mt),ft.prototype.dispatch=ft.prototype.emit,ft.prototype.run=ft.prototype.emit,
/*!
 * @pixi/ticker - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
a.TARGET_FPMS=.06;var gt=50,yt=0,vt=-25,_t=-50,xt=function TickerListener(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1};xt.prototype.match=function match(t,e){return e=e||null,this.fn===t&&this.context===e},xt.prototype.emit=function emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},xt.prototype.connect=function connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},xt.prototype.destroy=function destroy(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e};var bt=function Ticker(){var t=this;this._head=new xt(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/a.TARGET_FPMS,this.elapsedMS=1/a.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}},Tt={FPS:{configurable:!0},minFPS:{configurable:!0},maxFPS:{configurable:!0}},St={shared:{configurable:!0},system:{configurable:!0}};bt.prototype._requestIfNeeded=function _requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},bt.prototype._cancelIfNeeded=function _cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},bt.prototype._startIfPossible=function _startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},bt.prototype.add=function add(t,e,i){return void 0===i&&(i=yt),this._addListener(new xt(t,e,i))},bt.prototype.addOnce=function addOnce(t,e,i){return void 0===i&&(i=yt),this._addListener(new xt(t,e,i,!0))},bt.prototype._addListener=function _addListener(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},bt.prototype.remove=function remove(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},bt.prototype.start=function start(){this.started||(this.started=!0,this._requestIfNeeded())},bt.prototype.stop=function stop(){this.started&&(this.started=!1,this._cancelIfNeeded())},bt.prototype.destroy=function destroy(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},bt.prototype.update=function update(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS&&e+1<this._minElapsedMS)return;this.deltaMS=e,this.deltaTime=this.deltaMS*a.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Tt.FPS.get=function(){return 1e3/this.elapsedMS},Tt.minFPS.get=function(){return 1e3/this._maxElapsedMS},Tt.minFPS.set=function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,a.TARGET_FPMS);this._maxElapsedMS=1/i},Tt.maxFPS.get=function(){return this._minElapsedMS?1e3/this._minElapsedMS:1e3*a.TARGET_FPMS},Tt.maxFPS.set=function(t){if(t/1e3>=a.TARGET_FPMS)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t),i=Math.min(Math.max(1,e)/1e3,a.TARGET_FPMS);this._minElapsedMS=1/i}},St.shared.get=function(){if(!bt._shared){var t=bt._shared=new bt;t.autoStart=!0,t._protected=!0}return bt._shared},St.system.get=function(){if(!bt._system){var t=bt._system=new bt;t.autoStart=!0,t._protected=!0}return bt._system},Object.defineProperties(bt.prototype,Tt),Object.defineProperties(bt,St);var wt=function TickerPlugin(){};wt.init=function init(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,vt)},get:function get(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?bt.shared:new bt,t.autoStart&&this.start()},wt.destroy=function destroy(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};
/*!
 * @pixi/core - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Et=function Resource(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ft("setRealSize",2),this.onUpdate=new ft("update")},At={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Et.prototype.bind=function bind(t){this.onResize.add(t),this.onUpdate.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Et.prototype.unbind=function unbind(t){this.onResize.remove(t),this.onUpdate.remove(t)},Et.prototype.resize=function resize(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},At.valid.get=function(){return!!this._width&&!!this._height},Et.prototype.update=function update(){this.destroyed||this.onUpdate.run()},Et.prototype.load=function load(){return Promise.resolve()},At.width.get=function(){return this._width},At.height.get=function(){return this._height},Et.prototype.upload=function upload(t,e,i){return!1},Et.prototype.style=function style(t,e,i){return!1},Et.prototype.dispose=function dispose(){},Et.prototype.destroy=function destroy(){this.destroyed||(this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null,this.destroyed=!0,this.dispose())},Object.defineProperties(Et.prototype,At);var Ct=function(t){function BaseImageResource(e){var i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;t.call(this,i,r),this.source=e}return t&&(BaseImageResource.__proto__=t),BaseImageResource.prototype=Object.create(t&&t.prototype),BaseImageResource.prototype.constructor=BaseImageResource,BaseImageResource.crossOrigin=function crossOrigin(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=determineCrossOrigin(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},BaseImageResource.prototype.upload=function upload(t,e,i,r){var n=t.gl,o=e.realWidth,s=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),e.target===n.TEXTURE_2D&&i.width===o&&i.height===s?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r):(i.width=o,i.height=s,n.texImage2D(e.target,0,e.format,e.format,e.type,r)),!0},BaseImageResource.prototype.update=function update(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,i=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,i),t.prototype.update.call(this)}},BaseImageResource.prototype.dispose=function dispose(){this.source=null},BaseImageResource}(Et),Ot=function(t){function ImageResource(e,i){if(i=i||{},!(e instanceof HTMLImageElement)){var r=new Image;t.crossOrigin(r,e,i.crossorigin),r.src=e,e=r}t.call(this,e),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==i.createBitmap?i.createBitmap:a.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.premultiplyAlpha=!1!==i.premultiplyAlpha,this.bitmap=null,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(ImageResource.__proto__=t),ImageResource.prototype=Object.create(t&&t.prototype),ImageResource.prototype.constructor=ImageResource,ImageResource.prototype.load=function load(t){var e=this;return void 0!==t&&(this.createBitmap=t),this._load?this._load:(this._load=new Promise(function(t){e.url=e.source.src;var i=e.source,r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():i.onload=r}),this._load)},ImageResource.prototype.process=function process(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha?"premultiply":"none"}).then(function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))}),this._process):Promise.resolve(this)},ImageResource.prototype.upload=function upload(e,i,r){if(i.premultiplyAlpha=this.premultiplyAlpha,!this.createBitmap)return t.prototype.upload.call(this,e,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,i,r,this.bitmap),!this.preserveBitmap){var n=!0;for(var o in i._glTextures){var s=i._glTextures[o];if(s!==r&&s.dirtyId!==i.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},ImageResource.prototype.dispose=function dispose(){t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},ImageResource}(Ct),Pt=[];function autoDetectResource(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=Pt.length-1;n>=0;--n){var o=Pt[n];if(o.test&&o.test(t,i))return new o(t,e)}return new Ot(t,e)}var It=function(t){function BufferResource(e,i){var r=i||{},n=r.width,o=r.height;if(!n||!o)throw new Error("BufferResource width or height invalid");t.call(this,n,o),this.data=e}return t&&(BufferResource.__proto__=t),BufferResource.prototype=Object.create(t&&t.prototype),BufferResource.prototype.constructor=BufferResource,BufferResource.prototype.upload=function upload(t,e,i){var r=t.gl;if(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height)r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data);else{i.width=e.width,i.height=e.height;var n=e.format;2===t.context.webGLVersion&&e.type===t.gl.FLOAT&&e.format===t.gl.RGBA&&(n=t.gl.RGBA32F),r.texImage2D(e.target,0,n,e.width,e.height,0,e.format,e.type,this.data)}return!0},BufferResource.prototype.dispose=function dispose(){this.data=null},BufferResource.test=function test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},BufferResource}(Et),Mt={scaleMode:0,format:v.RGBA,premultiplyAlpha:!1},Rt=function(t){function BaseTexture(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.call(this);var r=(i=i||{}).premultiplyAlpha,n=i.mipmap,o=i.scaleMode,s=i.width,h=i.height,u=i.wrapMode,l=i.format,c=i.type,d=i.target,p=i.resolution,f=i.resourceOptions;!e||e instanceof Et||((e=autoDetectResource(e,f)).internal=!0),this.width=s||0,this.height=h||0,this.resolution=p||a.RESOLUTION,this.mipmap=void 0!==n?n:a.MIPMAP_TEXTURES,this.wrapMode=u||a.WRAP_MODE,this.scaleMode=void 0!==o?o:a.SCALE_MODE,this.format=l||v.RGBA,this.type=c||x.UNSIGNED_BYTE,this.target=d||_.TEXTURE_2D,this.premultiplyAlpha=!1!==r,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this.setResource(e)}t&&(BaseTexture.__proto__=t),BaseTexture.prototype=Object.create(t&&t.prototype),BaseTexture.prototype.constructor=BaseTexture;var e={realWidth:{configurable:!0},realHeight:{configurable:!0}};return e.realWidth.get=function(){return this.width*this.resolution},e.realHeight.get=function(){return this.height*this.resolution},BaseTexture.prototype.setStyle=function setStyle(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},BaseTexture.prototype.setSize=function setSize(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},BaseTexture.prototype.setRealSize=function setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},BaseTexture.prototype._refreshPOT=function _refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)},BaseTexture.prototype.setResolution=function setResolution(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},BaseTexture.prototype.setResource=function setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},BaseTexture.prototype.update=function update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},BaseTexture.prototype.destroy=function destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete D[this.cacheId],delete R[this.cacheId],this.cacheId=null),this.dispose(),BaseTexture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},BaseTexture.prototype.dispose=function dispose(){this.emit("dispose",this)},BaseTexture.from=function from(t,e){var i=null;"string"==typeof t?i=t:(t._pixiId||(t._pixiId="pixiid_"+uid()),i=t._pixiId);var r=D[i];return r||((r=new BaseTexture(t,e)).cacheId=i,BaseTexture.addToCache(r,i)),r},BaseTexture.fromBuffer=function fromBuffer(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new It(t,{width:e,height:i}),o=t instanceof Float32Array?x.FLOAT:x.UNSIGNED_BYTE;return new BaseTexture(n,Object.assign(Mt,r||{width:e,height:i,type:o}))},BaseTexture.addToCache=function addToCache(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),D[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),D[e]=t)},BaseTexture.removeFromCache=function removeFromCache(t){if("string"==typeof t){var e=D[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete D[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete D[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(BaseTexture.prototype,e),BaseTexture}(u.a);Rt._globalBatch=0;var Dt=function(t){function ArrayResource(e,i){var r;i=i||{};var n=e;Array.isArray(e)&&(r=e,n=e.length),t.call(this,i.width,i.height),this.items=[],this.itemDirtyIds=[];for(var o=0;o<n;o++){var s=new Rt;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,r)for(var a=0;a<n;a++)this.addResourceAt(autoDetectResource(r[a],i),a)}return t&&(ArrayResource.__proto__=t),ArrayResource.prototype=Object.create(t&&t.prototype),ArrayResource.prototype.constructor=ArrayResource,ArrayResource.prototype.dispose=function dispose(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},ArrayResource.prototype.addResourceAt=function addResourceAt(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},ArrayResource.prototype.bind=function bind(e){t.prototype.bind.call(this,e),e.target=_.TEXTURE_2D_ARRAY;for(var i=0;i<this.length;i++)this.items[i].on("update",e.update,e)},ArrayResource.prototype.unbind=function unbind(e){t.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].off("update",e.update,e)},ArrayResource.prototype.load=function load(){var t=this;if(this._load)return this._load;var e=this.items.map(function(t){return t.resource}),i=e.map(function(t){return t.load()});return this._load=Promise.all(i).then(function(){var i=e[0],r=i.width,n=i.height;return t.resize(r,n),Promise.resolve(t)}),this._load},ArrayResource.prototype.upload=function upload(t,e,i){var r=this.length,n=this.itemDirtyIds,o=this.items,s=t.gl;i.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=o[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},ArrayResource}(Et),Ft=function(t){function CanvasResource(){t.apply(this,arguments)}return t&&(CanvasResource.__proto__=t),CanvasResource.prototype=Object.create(t&&t.prototype),CanvasResource.prototype.constructor=CanvasResource,CanvasResource.test=function test(t){return t instanceof HTMLCanvasElement},CanvasResource}(Ct),Bt=function(t){function CubeResource(e,i){if(i=i||{},t.call(this,e,i),this.length!==CubeResource.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var r=0;r<CubeResource.SIDES;r++)this.items[r].target=_.TEXTURE_CUBE_MAP_POSITIVE_X+r;!1!==i.autoLoad&&this.load()}return t&&(CubeResource.__proto__=t),CubeResource.prototype=Object.create(t&&t.prototype),CubeResource.prototype.constructor=CubeResource,CubeResource.prototype.bind=function bind(e){t.prototype.bind.call(this,e),e.target=_.TEXTURE_CUBE_MAP},CubeResource.prototype.upload=function upload(t,e,i){for(var r=this.itemDirtyIds,n=0;n<CubeResource.SIDES;n++){var o=this.items[n];r[n]<o.dirtyId&&(r[n]=o.dirtyId,o.valid&&o.resource.upload(t,o,i))}return!0},CubeResource}(Dt);Bt.SIDES=6;var Lt=function(t){function SVGResource(e,i){i=i||{},t.call(this,document.createElement("canvas")),this.svg=e,this.scale=i.scale||1,this._resolve=null,this._crossorigin=i.crossorigin,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(SVGResource.__proto__=t),SVGResource.prototype=Object.create(t&&t.prototype),SVGResource.prototype.constructor=SVGResource,SVGResource.prototype.load=function load(){var t=this;return this._load?this._load:(this._load=new Promise(function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},SVGResource.prototype._loadSvg=function _loadSvg(){var e=this,i=new Image;t.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onload=function(){var t=i.width,r=i.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=Math.round(t*e.scale),o=Math.round(r*e.scale),s=e.source;s.width=n,s.height=o,s._pixiId="canvas_"+uid(),s.getContext("2d").drawImage(i,0,0,t,r,0,0,n,o),e._resolve(),e._resolve=null}},SVGResource.getSize=function getSize(t){var e=SVGResource.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},SVGResource.prototype.dispose=function dispose(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},SVGResource.test=function test(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},SVGResource}(Ct);Lt.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var kt=function(t){function VideoResource(e,i){if(i=i||{},!(e instanceof HTMLVideoElement)){var r=document.createElement("video");r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(r,e[0].src||e[0],i.crossorigin);for(var n=0;n<e.length;++n){var o=document.createElement("source"),s=e[n],a=s.src,h=s.mime,u=(a=a||e[n]).split("?").shift().toLowerCase(),l=u.substr(u.lastIndexOf(".")+1);h=h||"video/"+l,o.src=a,o.type=h,r.appendChild(o)}e=r}t.call(this,e),this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==i.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),!1!==i.autoLoad&&this.load()}t&&(VideoResource.__proto__=t),VideoResource.prototype=Object.create(t&&t.prototype),VideoResource.prototype.constructor=VideoResource;var e={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return VideoResource.prototype.update=function update(e){if(void 0===e&&(e=0),!this.destroyed){var i=bt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},VideoResource.prototype.load=function load(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay)),this._load=new Promise(function(i){t.valid?i(t):(t._resolve=i,e.load())}),this._load},VideoResource.prototype._isSourcePlaying=function _isSourcePlaying(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},VideoResource.prototype._isSourceReady=function _isSourceReady(){return 3===this.source.readyState||4===this.source.readyState},VideoResource.prototype._onPlayStart=function _onPlayStart(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(bt.shared.add(this.update,this),this._isAutoUpdating=!0)},VideoResource.prototype._onPlayStop=function _onPlayStop(){this._isAutoUpdating&&(bt.shared.remove(this.update,this),this._isAutoUpdating=!1)},VideoResource.prototype._onCanPlay=function _onCanPlay(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},VideoResource.prototype.dispose=function dispose(){this._isAutoUpdating&&bt.shared.remove(this.update,this),this.source&&(this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},e.autoUpdate.get=function(){return this._autoUpdate},e.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(bt.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(bt.shared.add(this.update,this),this._isAutoUpdating=!0))},e.updateFPS.get=function(){return this._updateFPS},e.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},VideoResource.test=function test(t,e){return t instanceof HTMLVideoElement||VideoResource.TYPES.indexOf(e)>-1},Object.defineProperties(VideoResource.prototype,e),VideoResource}(Ct);kt.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Pt.push(Ot,Ft,kt,Lt,It,Bt,Dt);var Ut=function System(t){this.renderer=t,this.renderer.runners.contextChange.add(this)};Ut.prototype.contextChange=function contextChange(t){},Ut.prototype.destroy=function destroy(){this.renderer.runners.contextChange.remove(this),this.renderer=null};var Nt=function(t){function DepthResource(){t.apply(this,arguments)}return t&&(DepthResource.__proto__=t),DepthResource.prototype=Object.create(t&&t.prototype),DepthResource.prototype.constructor=DepthResource,DepthResource.prototype.upload=function upload(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},DepthResource}(It),Gt=function Framebuffer(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ft("disposeFramebuffer",2)},jt={colorTexture:{configurable:!0}};jt.colorTexture.get=function(){return this.colorTextures[0]},Gt.prototype.addColorTexture=function addColorTexture(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Rt(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Gt.prototype.addDepthTexture=function addDepthTexture(t){return this.depthTexture=t||new Rt(new Nt(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:v.DEPTH_COMPONENT,type:x.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Gt.prototype.enableDepth=function enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Gt.prototype.enableStencil=function enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Gt.prototype.resize=function resize(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var o=this.depthTexture.resolution;this.depthTexture.setSize(t/o,e/o)}}},Gt.prototype.dispose=function dispose(){this.disposeRunner.run(this,!1)},Object.defineProperties(Gt.prototype,jt);var Xt=function(t){function BaseRenderTexture(e){"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});t.call(this,null,e);var i=e||{},r=i.width,n=i.height;this.mipmap=!1,this.width=Math.ceil(r)||100,this.height=Math.ceil(n)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Gt(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this).enableStencil(),this.stencilMaskStack=[],this.filterStack=[{}]}return t&&(BaseRenderTexture.__proto__=t),BaseRenderTexture.prototype=Object.create(t&&t.prototype),BaseRenderTexture.prototype.constructor=BaseRenderTexture,BaseRenderTexture.prototype.resize=function resize(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},BaseRenderTexture.prototype.dispose=function dispose(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},BaseRenderTexture.prototype.destroy=function destroy(){t.prototype.destroy.call(this,!0),this.framebuffer=null,this.renderer=null},BaseRenderTexture}(Rt),Ht=function TextureUvs(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};Ht.prototype.set=function set(t,e,i){var r=e.width,n=e.height;if(i){var o=t.width/2/r,s=t.height/2/n,a=t.x/r+o,h=t.y/n+s;i=tt.add(i,tt.NW),this.x0=a+o*tt.uX(i),this.y0=h+s*tt.uY(i),i=tt.add(i,2),this.x1=a+o*tt.uX(i),this.y1=h+s*tt.uY(i),i=tt.add(i,2),this.x2=a+o*tt.uX(i),this.y2=h+s*tt.uY(i),i=tt.add(i,2),this.x3=a+o*tt.uX(i),this.y3=h+s*tt.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var zt=new Ht,Yt=function(t){function Texture(e,i,r,n,o,s){if(t.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new rt(0,0,1,1)),e instanceof Texture&&(e=e.baseTexture),this.baseTexture=e,this._frame=i,this.trim=n,this.valid=!1,this.requiresUpdate=!1,this._uvs=zt,this.uvMatrix=null,this.orig=r||i,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new N(s.x,s.y):new N(0,0),this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=i:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}t&&(Texture.__proto__=t),Texture.prototype=Object.create(t&&t.prototype),Texture.prototype.constructor=Texture;var e={frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return Texture.prototype.update=function update(){this.baseTexture.resource&&this.baseTexture.resource.update()},Texture.prototype.onBaseTextureUpdated=function onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},Texture.prototype.destroy=function destroy(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&R[e.url]&&Texture.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null},Texture.prototype.clone=function clone(){return new Texture(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},Texture.prototype.updateUvs=function updateUvs(){this._uvs===zt&&(this._uvs=new Ht),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture.from=function from(t,e){void 0===e&&(e={});var i=null;"string"==typeof t?i=t:(t._pixiId||(t._pixiId="pixiid_"+uid()),i=t._pixiId);var r=R[i];return r||(e.resolution||(e.resolution=getResolutionOfUrl(t)),(r=new Texture(new Rt(t,e))).baseTexture.cacheId=i,Rt.addToCache(r.baseTexture,i),Texture.addToCache(r,i)),r},Texture.fromBuffer=function fromBuffer(t,e,i,r){return new Texture(Rt.fromBuffer(t,e,i,r))},Texture.fromLoader=function fromLoader(t,e,i){var r=new Ot(t);r.url=e;var n=new Texture(new Rt(r,{scaleMode:a.SCALE_MODE,resolution:getResolutionOfUrl(e)}));return i||(i=e),Rt.addToCache(n.baseTexture,i),Texture.addToCache(n,i),i!==e&&(Rt.addToCache(n.baseTexture,e),Texture.addToCache(n,e)),n},Texture.addToCache=function addToCache(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),R[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),R[e]=t)},Texture.removeFromCache=function removeFromCache(t){if("string"==typeof t){var e=R[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete R[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)R[t.textureCacheIds[r]]===t&&delete R[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e.frame.get=function(){return this._frame},e.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,o=e+r>this.baseTexture.width,s=i+n>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},e.rotate.get=function(){return this._rotate},e.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},e.width.get=function(){return this.orig.width},e.height.get=function(){return this.orig.height},Object.defineProperties(Texture.prototype,e),Texture}(u.a);function removeAllHandlers(t){t.destroy=function _emptyDestroy(){},t.on=function _emptyOn(){},t.once=function _emptyOnce(){},t.emit=function _emptyEmit(){}}Yt.EMPTY=new Yt(new Rt),removeAllHandlers(Yt.EMPTY),removeAllHandlers(Yt.EMPTY.baseTexture),Yt.WHITE=function createWhiteTexture(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Yt(new Rt(new Ft(t)))}(),removeAllHandlers(Yt.WHITE),removeAllHandlers(Yt.WHITE.baseTexture);var Wt=function(t){function RenderTexture(e,i){var r=null;if(!(e instanceof Xt)){var n=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+o+") instead of the ctor directly."),r=arguments[0],i=null,e=new Xt({width:n,height:o,scaleMode:s,resolution:a})}t.call(this,e,i),this.legacyRenderer=r,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(RenderTexture.__proto__=t),RenderTexture.prototype=Object.create(t&&t.prototype),RenderTexture.prototype.constructor=RenderTexture,RenderTexture.prototype.resize=function resize(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},RenderTexture.prototype.setResolution=function setResolution(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},RenderTexture.create=function create(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new RenderTexture(new Xt(t))},RenderTexture}(Yt),Vt=function Attribute(t,e,i,r,n,o,s){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=o,this.instance=s};Vt.prototype.destroy=function destroy(){this.buffer=null},Vt.from=function from(t,e,i,r,n){return new Vt(t,e,i,r,n)};var qt=0,Kt=function Buffer(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=qt++,this.disposeRunner=new ft("disposeBuffer",2)};function getBufferType(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}Kt.prototype.update=function update(t){this.data=t||this.data,this._updateID++},Kt.prototype.dispose=function dispose(){this.disposeRunner.run(this,!1)},Kt.prototype.destroy=function destroy(){this.dispose(),this.data=null},Kt.from=function from(t){return t instanceof Array&&(t=new Float32Array(t)),new Kt(t)};var Zt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Jt={5126:4,5123:2,5121:1},Qt=0,$t={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},te=function Geometry(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Qt++,this.instanced=!1,this.instanceCount=1,this._size=null,this.disposeRunner=new ft("disposeGeometry",2),this.refCount=0};te.prototype.addAttribute=function addAttribute(t,e,i,r,n,o,s,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Kt(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Vt(l,i,r,n,o,s,a),this.instanced=this.instanced||a,this},te.prototype.getAttribute=function getAttribute(t){return this.attributes[t]},te.prototype.getBuffer=function getBuffer(t){return this.buffers[this.getAttribute(t).buffer]},te.prototype.addIndex=function addIndex(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Kt(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},te.prototype.getIndex=function getIndex(){return this.indexBuffer},te.prototype.interleave=function interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Kt;for(t in this.attributes){var n=this.attributes[t],o=this.buffers[n.buffer];e.push(o.data),i.push(n.size*Jt[n.type]/4),n.buffer=0}for(r.data=function interleaveTypedArrays(t,e){for(var i=0,r=0,n={},o=0;o<t.length;o++)r+=e[o],i+=t[o].length;for(var s=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=getBufferType(c);n[d]||(n[d]=new Zt[d](s)),a=n[d];for(var p=0;p<c.length;p++)a[(p/l|0)*r+h+p%l]=c[p];h+=l}return new Float32Array(s)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},te.prototype.getSize=function getSize(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},te.prototype.dispose=function dispose(){this.disposeRunner.run(this,!1)},te.prototype.destroy=function destroy(){this.dispose(),this.buffers=null,this.indexBuffer.destroy(),this.attributes=null},te.prototype.clone=function clone(){for(var t=new te,e=0;e<this.buffers.length;e++)t.buffers[e]=new Kt(this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Vt(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},te.merge=function merge(t){for(var e,i=new te,r=[],n=[],o=[],s=0;s<t.length;s++){e=t[s];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,o[a]=0}for(var h=0;h<e.buffers.length;h++)r[h]=new($t[getBufferType(e.buffers[h].data)])(n[h]),i.buffers[h]=new Kt(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,o[l]),o[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var g in e.attributes){var y=e.attributes[g];(0|y.buffer)===f&&(d+=y.size*Jt[y.type]/4)}for(var v=0;v<t.length;v++){for(var _=t[v].indexBuffer.data,x=0;x<_.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=_.length}}return i};var ee=function(t){function Quad(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(Quad.__proto__=t),Quad.prototype=Object.create(t&&t.prototype),Quad.prototype.constructor=Quad,Quad}(te),ie=function(t){function QuadUv(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Kt(this.vertices),this.uvBuffer=new Kt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(QuadUv.__proto__=t),QuadUv.prototype=Object.create(t&&t.prototype),QuadUv.prototype.constructor=QuadUv,QuadUv.prototype.map=function map(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},QuadUv.prototype.invalidate=function invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},QuadUv}(te),re=0,ne=function UniformGroup(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=re++,this.static=!!e};ne.prototype.update=function update(){this.dirtyId++},ne.prototype.add=function add(t,e,i){this.uniforms[t]=new ne(e,i)},ne.from=function from(t,e){return new ne(t,e)};var oe=function FilterState(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new rt,this.destinationFrame=new rt,this.filters=[]};oe.prototype.clear=function clear(){this.target=null,this.filters=null,this.renderTexture=null};var se=function(t){function FilterSystem(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool={},this.statePool=[],this.quad=new ee,this.quadUv=new ie,this.tempRect=new rt,this.activeState={},this.globalUniforms=new ne({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=e.view.width,this._pixelsHeight=e.view.height}return t&&(FilterSystem.__proto__=t),FilterSystem.prototype=Object.create(t&&t.prototype),FilterSystem.prototype.constructor=FilterSystem,FilterSystem.prototype.push=function push(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new oe,o=e[0].resolution,s=e[0].padding,a=e[0].autoFit,h=e[0].legacy,u=1;u<e.length;u++){var l=e[u];o=Math.min(o,l.resolution),s=Math.max(s,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=o,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(s),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(o),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},FilterSystem.prototype.pop=function pop(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,o=r.inputPixel,s=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=n[0]*e.resolution,o[1]=n[1]*e.resolution,o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*n[2]-.5*o[2],s[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},FilterSystem.prototype.applyFilter=function applyFilter(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.setState(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(y.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(y.TRIANGLE_STRIP))},FilterSystem.prototype.calculateSpriteMatrix=function calculateSpriteMatrix(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,o=e._texture.orig,s=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(W.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},FilterSystem.prototype.destroy=function destroy(t){void 0===t&&(t=!1),t?this.texturePool={}:this.emptyPool()},FilterSystem.prototype.getOptimalFilterTexture=function getOptimalFilterTexture(t,e,i){void 0===i&&(i=1);var r="screen";e*=i,(t*=i)===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=nextPow2(t)))<<16|65535&(e=nextPow2(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return n||(n=Wt.create({width:t,height:e})),n.filterPoolKey=r,n.setResolution(i),n},FilterSystem.prototype.getFilterTexture=function getFilterTexture(t){var e=this.activeState.renderTexture,i=this.getOptimalFilterTexture(e.width,e.height,t||e.baseTexture.resolution);return i.filterFrame=e.filterFrame,i},FilterSystem.prototype.returnFilterTexture=function returnFilterTexture(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},FilterSystem.prototype.emptyPool=function emptyPool(){for(var t in this.texturePool){var e=this.texturePool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.texturePool={}},FilterSystem.prototype.resize=function resize(){var t=this.texturePool.screen;if(t)for(var e=0;e<t.length;e++)t[e].destroy(!0);this.texturePool.screen=[],this._pixelsWidth=this.renderer.view.width,this._pixelsHeight=this.renderer.view.height},FilterSystem}(Ut),ae=function(t){function ObjectRenderer(){t.apply(this,arguments)}return t&&(ObjectRenderer.__proto__=t),ObjectRenderer.prototype=Object.create(t&&t.prototype),ObjectRenderer.prototype.constructor=ObjectRenderer,ObjectRenderer.prototype.start=function start(){},ObjectRenderer.prototype.stop=function stop(){this.flush()},ObjectRenderer.prototype.flush=function flush(){},ObjectRenderer.prototype.render=function render(t){},ObjectRenderer}(Ut),he=function(t){function BatchSystem(e){t.call(this,e),this.emptyRenderer=new ae(e),this.currentRenderer=this.emptyRenderer}return t&&(BatchSystem.__proto__=t),BatchSystem.prototype=Object.create(t&&t.prototype),BatchSystem.prototype.constructor=BatchSystem,BatchSystem.prototype.setObjectRenderer=function setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},BatchSystem.prototype.flush=function flush(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem.prototype.reset=function reset(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem}(Ut);a.PREFER_ENV=s.a.any?f.WEBGL:f.WEBGL2;var ue=0,le=function(t){function ContextSystem(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(ContextSystem.__proto__=t),ContextSystem.prototype=Object.create(t&&t.prototype),ContextSystem.prototype.constructor=ContextSystem;var e={isLost:{configurable:!0}};return e.isLost.get=function(){return!this.gl||this.gl.isContextLost()},ContextSystem.prototype.contextChange=function contextChange(t){this.gl=t,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},ContextSystem.prototype.initFromContext=function initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=ue++,this.renderer.runners.contextChange.run(t)},ContextSystem.prototype.initFromOptions=function initFromOptions(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},ContextSystem.prototype.createContext=function createContext(t,e){var i;if(a.PREFER_ENV>=f.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},ContextSystem.prototype.getExtensions=function getExtensions(){var t=this.gl;1===this.webGLVersion&&Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),floatTexture:t.getExtension("OES_texture_float"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint")})},ContextSystem.prototype.handleContextLost=function handleContextLost(t){t.preventDefault()},ContextSystem.prototype.handleContextRestored=function handleContextRestored(){this.renderer.runners.contextChange.run(this.gl)},ContextSystem.prototype.destroy=function destroy(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},ContextSystem.prototype.postrender=function postrender(){this.gl.flush()},ContextSystem.prototype.validateContext=function validateContext(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(ContextSystem.prototype,e),ContextSystem}(Ut),ce=function(t){function FramebufferSystem(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new Gt(10,10)}t&&(FramebufferSystem.__proto__=t),FramebufferSystem.prototype=Object.create(t&&t.prototype),FramebufferSystem.prototype.constructor=FramebufferSystem;var e={size:{configurable:!0}};return FramebufferSystem.prototype.contextChange=function contextChange(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new rt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;a.PREFER_ENV===f.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}},FramebufferSystem.prototype.bind=function bind(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},FramebufferSystem.prototype.setViewport=function setViewport(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},e.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},FramebufferSystem.prototype.clear=function clear(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},FramebufferSystem.prototype.initFramebuffer=function initFramebuffer(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},FramebufferSystem.prototype.resizeFramebuffer=function resizeFramebuffer(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},FramebufferSystem.prototype.updateFramebuffer=function updateFramebuffer(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],o=0;o<r;o++){var s=t.colorTextures[o];s.texturePart?(this.renderer.texture.bind(s.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,e.TEXTURE_CUBE_MAP_NEGATIVE_X+s.side,s.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(s,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,e.TEXTURE_2D,s._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+o)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height))},FramebufferSystem.prototype.disposeFramebuffer=function disposeFramebuffer(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.stencil&&r.deleteRenderbuffer(i.stencil))}},FramebufferSystem.prototype.disposeAll=function disposeAll(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.count;i++)this.disposeFramebuffer(e[i],t)},FramebufferSystem.prototype.reset=function reset(){this.current=this.unknownFramebuffer,this.viewport=new rt},Object.defineProperties(FramebufferSystem.prototype,e),FramebufferSystem}(Ut),de=function GLBuffer(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},pe={5126:4,5123:2,5121:1},fe=function(t){function GeometrySystem(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(GeometrySystem.__proto__=t),GeometrySystem.prototype=Object.create(t&&t.prototype),GeometrySystem.prototype.constructor=GeometrySystem,GeometrySystem.prototype.contextChange=function contextChange(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var i=this.renderer.context.extensions.vertexArrayObject;a.PREFER_ENV===f.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,n,o){return r.drawElementsInstancedANGLE(t,e,i,n,o)},t.drawArraysInstanced=function(t,e,i,n){return r.drawArraysInstancedANGLE(t,e,i,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},GeometrySystem.prototype.bind=function bind(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},GeometrySystem.prototype.reset=function reset(){this.unbind()},GeometrySystem.prototype.updateBuffers=function updateBuffers(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var o=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=r.data.byteLength)e.bufferSubData(o,0,r.data);else{var s=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(o,r.data,s)}}}},GeometrySystem.prototype.checkCompatibility=function checkCompatibility(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},GeometrySystem.prototype.getSignature=function getSignature(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var o in i)r[o]&&n.push(o);return n.join("-")},GeometrySystem.prototype.initGeometryVao=function initGeometryVao(t,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),o=t.glVertexArrayObjects[this.CONTEXT_UID],s=o[n];if(s)return o[e.id]=s,s;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*pe[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*pe[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*pe[f.type])}s=i.createVertexArray(),i.bindVertexArray(s);for(var g=0;g<a.length;g++){var y=a[g];y._glBuffers[r]||(y._glBuffers[r]=new de(i.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=s,o[e.id]=s,o[n]=s,s},GeometrySystem.prototype.disposeBuffer=function disposeBuffer(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},GeometrySystem.prototype.disposeGeometry=function disposeGeometry(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var o=0;o<n.length;o++){var s=n[o]._glBuffers[this.CONTEXT_UID];s.refCount--,0!==s.refCount||e||this.disposeBuffer(n[o],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},GeometrySystem.prototype.disposeAll=function disposeAll(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},GeometrySystem.prototype.activateVao=function activateVao(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,o=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var s=null;for(var a in o){var h=o[a],u=n[h.buffer]._glBuffers[r];if(e.attributeData[a]){s!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),s=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},GeometrySystem.prototype.draw=function draw(t,e,i,r){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(i||0)*s,r||1):n.drawElements(t,e||o.indexBuffer.data.length,a,(i||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,e||o.getSize(),r||1):n.drawArrays(t,i,e||o.getSize());return this},GeometrySystem.prototype.unbind=function unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},GeometrySystem}(Ut);function compileProgram(t,e,i,r){var n=compileShader(t,t.VERTEX_SHADER,e),o=compileShader(t,t.FRAGMENT_SHADER,i),s=t.createProgram();if(t.attachShader(s,n),t.attachShader(s,o),r)for(var a in r)t.bindAttribLocation(s,r[a],a);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(n),t.deleteShader(o),s}function compileShader(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function core_es_defaultValue(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return booleanArray(2*e);case"bvec3":return booleanArray(3*e);case"bvec4":return booleanArray(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function booleanArray(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}var me,ge=null;function getTestContext(){if(!ge){var t,e=document.createElement("canvas");if(a.PREFER_ENV>=f.WEBGL2&&(t=e.getContext("webgl2",{})),!t){if(!(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{})))throw new Error("This browser does not support WebGL. Try using the canvas renderer");t.getExtension("WEBGL_draw_buffers")}return ge=t,t}return ge}function setPrecision(t,e,i){if("precision"!==t.substring(0,9)){var r=e;return e===E.HIGH&&i!==E.HIGH&&(r=E.MEDIUM),"precision "+r+" float;\n"+t}return i!==E.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var ye={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(t){return ye[t]}var ve=null,_e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(t,e){if(!ve){var i=Object.keys(_e);ve={};for(var r=0;r<i.length;++r){var n=i[r];ve[t[n]]=_e[n]}}return ve[e]}var xe={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},be={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Te,Se=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function generateIfTestSrc(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}var we=0,Ee={},Ae=function Program(t,e,i){void 0===i&&(i="pixi-shader"),this.id=we++,this.vertexSrc=t||Program.defaultVertexSrc,this.fragmentSrc=e||Program.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Ee[i]?(Ee[i]++,i+="-"+Ee[i]):Ee[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=setPrecision(this.vertexSrc,a.PRECISION_VERTEX,E.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,a.PRECISION_FRAGMENT,function getMaxFragmentPrecision(){if(!me){me=E.MEDIUM;var t=getTestContext();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);me=e.precision?E.HIGH:E.MEDIUM}}return me}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Ce={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Ae.prototype.extractData=function extractData(t,e){var i=getTestContext();if(i){var r=compileProgram(i,t,e);this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Ae.prototype.getAttributeData=function getAttributeData(t,e){for(var i={},r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var s=e.getActiveAttrib(t,o),a=mapType(e,s.type),h={type:a,name:s.name,size:mapSize(a),location:0};i[s.name]=h,r.push(h)}r.sort(function(t,e){return t.name>e.name?1:-1});for(var u=0;u<r.length;u++)r[u].location=u;return i},Ae.prototype.getUniformData=function getUniformData(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var o=e.getActiveUniform(t,n),s=o.name.replace(/\[.*?\]/,""),a=o.name.match(/\[.*?\]/,""),h=mapType(e,o.type);i[s]={type:h,size:o.size,isArray:a,value:core_es_defaultValue(h,o.size)}}return i},Ce.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Ce.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Ae.from=function from(t,e,i){var r=t+e,n=M[r];return n||(M[r]=n=new Ae(t,e,i)),n},Object.defineProperties(Ae,Ce);var Oe=function Shader(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof ne?e:new ne(e):new ne({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))},Pe={uniforms:{configurable:!0}};Oe.prototype.checkUniformExists=function checkUniformExists(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},Oe.prototype.destroy=function destroy(){this.uniformGroup=null},Pe.uniforms.get=function(){return this.uniformGroup.uniforms},Oe.from=function from(t,e,i){var r=Ae.from(t,e);return new Oe(r,i)},Object.defineProperties(Oe.prototype,Pe);var Ie=function State(){this.data=0,this.blendMode=g.NORMAL,this.polygonOffset=0,this.blend=!0},Me={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Me.blend.get=function(){return!!(1&this.data)},Me.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Me.offsets.get=function(){return!!(2&this.data)},Me.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Me.culling.get=function(){return!!(4&this.data)},Me.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Me.depthTest.get=function(){return!!(8&this.data)},Me.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Me.clockwiseFrontFace.get=function(){return!!(16&this.data)},Me.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Me.blendMode.get=function(){return this._blendMode},Me.blendMode.set=function(t){this.blend=t!==g.NONE,this._blendMode=t},Me.polygonOffset.get=function(){return this._polygonOffset},Me.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Ie.for2d=function for2d(){var t=new Ie;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Ie.prototype,Me);var Re=function(t){function Filter(e,i,r){var n=Ae.from(e||Filter.defaultVertexSrc,i||Filter.defaultFragmentSrc);t.call(this,n,r),this.padding=0,this.resolution=a.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Ie}t&&(Filter.__proto__=t),Filter.prototype=Object.create(t&&t.prototype),Filter.prototype.constructor=Filter;var e={blendMode:{configurable:!0}},i={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return Filter.prototype.apply=function apply(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},e.blendMode.get=function(){return this.state.blendMode},e.blendMode.set=function(t){this.state.blendMode=t},i.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},i.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(Filter.prototype,e),Object.defineProperties(Filter,i),Filter}(Oe);Re.SOURCE_KEY_MAP={};var De="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",Fe="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",Be=new W,Le=function TextureMatrix(t,e){this._texture=t,this.mapCoord=new W,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},ke={texture:{configurable:!0}};ke.texture.get=function(){return this._texture},ke.texture.set=function(t){this._texture=t,this._updateID=-1},Le.prototype.multiplyUvs=function multiplyUvs(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e},Le.prototype.update=function update(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Be.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Be));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,h=this.clampOffset;return s[0]=(e._frame.x+a+h)/o.width,s[1]=(e._frame.y+a+h)/o.height,s[2]=(e._frame.x+e._frame.width-a+h)/o.width,s[3]=(e._frame.y+e._frame.height-a+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},Object.defineProperties(Le.prototype,ke);var Ue=function(t){function SpriteMaskFilter(e){var i=new W;t.call(this,De,Fe),e.renderable=!1,this.maskSprite=e,this.maskMatrix=i}return t&&(SpriteMaskFilter.__proto__=t),SpriteMaskFilter.prototype=Object.create(t&&t.prototype),SpriteMaskFilter.prototype.constructor=SpriteMaskFilter,SpriteMaskFilter.prototype.apply=function apply(t,e,i,r){var n=this.maskSprite,o=this.maskSprite.texture;o.valid&&(o.transform||(o.transform=new Le(o,0)),o.transform.update(),this.uniforms.npmAlpha=o.baseTexture.premultiplyAlpha?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.transform.uClampFrame,t.applyFilter(this,e,i,r))},SpriteMaskFilter}(Re),Ne=function(t){function MaskSystem(e){t.call(this,e),this.scissor=!1,this.scissorData=null,this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.alphaMaskIndex=0}return t&&(MaskSystem.__proto__=t),MaskSystem.prototype=Object.create(t&&t.prototype),MaskSystem.prototype.constructor=MaskSystem,MaskSystem.prototype.push=function push(t,e){if(e.isSprite)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencil.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a);(r=Math.round(r*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},MaskSystem.prototype.pop=function pop(t,e){e.isSprite?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencil.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},MaskSystem.prototype.pushSpriteMask=function pushSpriteMask(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Ue(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var r=t.filterArea;t.filterArea=e.getBounds(!0),this.renderer.filter.push(t,i),t.filterArea=r,this.alphaMaskIndex++},MaskSystem.prototype.popSpriteMask=function popSpriteMask(){this.renderer.filter.pop(),this.alphaMaskIndex--},MaskSystem.prototype.pushStencilMask=function pushStencilMask(t){this.renderer.batch.flush(),this.renderer.stencil.pushStencil(t)},MaskSystem.prototype.popStencilMask=function popStencilMask(){this.renderer.stencil.popStencil()},MaskSystem.prototype.pushScissorMask=function pushScissorMask(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,r=e.getBounds();r.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(r.x*n,(i.root?i.size.height-r.y-r.height:r.y)*n,r.width*n,r.height*n),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},MaskSystem.prototype.popScissorMask=function popScissorMask(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},MaskSystem}(Ut),Ge=function(t){function StencilSystem(e){t.call(this,e),this.stencilMaskStack=[]}return t&&(StencilSystem.__proto__=t),StencilSystem.prototype=Object.create(t&&t.prototype),StencilSystem.prototype.constructor=StencilSystem,StencilSystem.prototype.setMaskStack=function setMaskStack(t){var e=this.renderer.gl;t.length!==this.stencilMaskStack.length&&(0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)),this.stencilMaskStack=t},StencilSystem.prototype.pushStencil=function pushStencil(t){var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},StencilSystem.prototype.popStencil=function popStencil(){var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},StencilSystem.prototype._useCurrent=function _useCurrent(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},StencilSystem.prototype._getBitwiseMask=function _getBitwiseMask(){return(1<<this.stencilMaskStack.length)-1},StencilSystem.prototype.destroy=function destroy(){t.prototype.destroy.call(this,this),this.stencilMaskStack=null},StencilSystem}(Ut),je=function(t){function ProjectionSystem(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new W,this.transform=null}return t&&(ProjectionSystem.__proto__=t),ProjectionSystem.prototype=Object.create(t&&t.prototype),ProjectionSystem.prototype.constructor=ProjectionSystem,ProjectionSystem.prototype.update=function update(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},ProjectionSystem.prototype.calculateProjection=function calculateProjection(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},ProjectionSystem.prototype.setTransform=function setTransform(){},ProjectionSystem}(Ut),Xe=new rt,He=function(t){function RenderTextureSystem(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new rt,this.destinationFrame=new rt}return t&&(RenderTextureSystem.__proto__=t),RenderTextureSystem.prototype=Object.create(t&&t.prototype),RenderTextureSystem.prototype.constructor=RenderTextureSystem,RenderTextureSystem.prototype.bind=function bind(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var o=t.baseTexture;r=o.resolution,i||(Xe.width=o.realWidth,Xe.height=o.realHeight,i=Xe),e||(e=i),this.renderer.framebuffer.bind(o.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.stencil.setMaskStack(o.stencilMaskStack)}else r=this.renderer.resolution,i||(Xe.width=n.width,Xe.height=n.height,i=Xe),e||(e=i),n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.stencil.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},RenderTextureSystem.prototype.clear=function clear(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},RenderTextureSystem.prototype.resize=function resize(){this.bind(null)},RenderTextureSystem.prototype.reset=function reset(){this.bind(null)},RenderTextureSystem}(Ut),ze=function GLProgram(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};ze.prototype.destroy=function destroy(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Ye=0,We=function(t){function ShaderSystem(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Ye++}return t&&(ShaderSystem.__proto__=t),ShaderSystem.prototype=Object.create(t&&t.prototype),ShaderSystem.prototype.constructor=ShaderSystem,ShaderSystem.prototype.systemCheck=function systemCheck(){if(!function unsafeEvalSupported(){if("boolean"==typeof Te)return Te;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Te=!0===t({a:"b"},"a","b")}catch(t){Te=!1}return Te}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},ShaderSystem.prototype.contextChange=function contextChange(t){this.gl=t},ShaderSystem.prototype.bind=function bind(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||this.syncUniformGroup(t.uniformGroup),r},ShaderSystem.prototype.setUniforms=function setUniforms(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},ShaderSystem.prototype.syncUniformGroup=function syncUniformGroup(t){var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},ShaderSystem.prototype.syncUniforms=function syncUniforms(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer)},ShaderSystem.prototype.createSyncGroups=function createSyncGroups(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function generateUniformsSync(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(var n in t.uniforms){var o=e[n];o?"float"===o.type&&1===o.size?r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n":"sampler2D"!==o.type&&"samplerCube"!==o.type&&"sampler2DArray"!==o.type||1!==o.size||o.isArray?"mat3"===o.type&&1===o.size?void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n":"vec2"===o.type&&1===o.size?void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n":"vec4"===o.type&&1===o.size?void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n":r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===o.size?xe:be)[o.type].replace("location","ud."+n+".location")+";\n":(r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n",i++):t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},ShaderSystem.prototype.getSignature=function getSignature(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},ShaderSystem.prototype.getglProgram=function getglProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},ShaderSystem.prototype.generateShader=function generateShader(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var o=compileProgram(e,i.vertexSrc,i.fragmentSrc,r),s={};for(var a in i.uniformData){var h=i.uniformData[a];s[a]={location:e.getUniformLocation(o,a),value:core_es_defaultValue(h.type,h.size)}}var u=new ze(o,s);return i.glPrograms[this.renderer.CONTEXT_UID]=u,u},ShaderSystem.prototype.reset=function reset(){this.program=null,this.shader=null},ShaderSystem.prototype.destroy=function destroy(){this.destroyed=!0},ShaderSystem}(Ut);var Ve=0,qe=1,Ke=2,Ze=3,Je=4,Qe=function(t){function StateSystem(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=g.NONE,this._blendEq=!1,this.map=[],this.map[Ve]=this.setBlend,this.map[qe]=this.setOffset,this.map[Ke]=this.setCullFace,this.map[Ze]=this.setDepthTest,this.map[Je]=this.setFrontFace,this.checks=[],this.defaultState=new Ie,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(StateSystem.__proto__=t),StateSystem.prototype=Object.create(t&&t.prototype),StateSystem.prototype.constructor=StateSystem,StateSystem.prototype.contextChange=function contextChange(t){this.gl=t,this.blendModes=function mapWebGLBlendModesToPixi(t,e){return void 0===e&&(e=[]),e[g.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.ADD]=[t.ONE,t.ONE],e[g.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.NONE]=[0,0],e[g.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[g.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[g.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[g.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[g.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[g.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[g.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[g.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[g.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.setState(this.defaultState),this.reset()},StateSystem.prototype.setState=function setState(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},StateSystem.prototype.forceState=function forceState(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},StateSystem.prototype.setBlend=function setBlend(t){this.updateCheck(StateSystem.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},StateSystem.prototype.setOffset=function setOffset(t){this.updateCheck(StateSystem.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},StateSystem.prototype.setDepthTest=function setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},StateSystem.prototype.setCullFace=function setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},StateSystem.prototype.setFrontFace=function setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},StateSystem.prototype.setBlendMode=function setBlendMode(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},StateSystem.prototype.setPolygonOffset=function setPolygonOffset(t,e){this.gl.polygonOffset(t,e)},StateSystem.prototype.reset=function reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},StateSystem.prototype.updateCheck=function updateCheck(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},StateSystem.checkBlendMode=function checkBlendMode(t,e){t.setBlendMode(e.blendMode)},StateSystem.checkPolygonOffset=function checkPolygonOffset(t,e){t.setPolygonOffset(e.polygonOffset,0)},StateSystem}(Ut),$e=function(t){function TextureGCSystem(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=a.GC_MAX_IDLE,this.checkCountMax=a.GC_MAX_CHECK_COUNT,this.mode=a.GC_MODE}return t&&(TextureGCSystem.__proto__=t),TextureGCSystem.prototype=Object.create(t&&t.prototype),TextureGCSystem.prototype.constructor=TextureGCSystem,TextureGCSystem.prototype.postrender=function postrender(){this.count++,this.mode!==w&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},TextureGCSystem.prototype.run=function run(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){for(var o=0,s=0;s<e.length;s++)null!==e[s]&&(e[o++]=e[s]);e.length=o}},TextureGCSystem.prototype.unload=function unload(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},TextureGCSystem}(Ut),ti=function GLTexture(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071},ei=function(t){function TextureSystem(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Rt}return t&&(TextureSystem.__proto__=t),TextureSystem.prototype=Object.create(t&&t.prototype),TextureSystem.prototype.constructor=TextureSystem,TextureSystem.prototype.contextChange=function contextChange(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new ti(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ti(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var o=0;o<this.boundTextures.length;o++)this.bind(null,o)},TextureSystem.prototype.bind=function bind(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.boundTextures[e]!==t&&i.bindTexture(t.target,r.texture),r.dirtyId!==t.dirtyId&&this.updateTexture(t),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},TextureSystem.prototype.reset=function reset(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},TextureSystem.prototype.unbind=function unbind(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},TextureSystem.prototype.initTexture=function initTexture(t){var e=new ti(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},TextureSystem.prototype.updateTexture=function updateTexture(t){var e=t._glTextures[this.CONTEXT_UID],i=this.renderer;if(t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,o=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,o.texImage2D(t.target,0,t.format,r,n,0,t.format,t.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId},TextureSystem.prototype.destroyTexture=function destroyTexture(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&removeItems(this.managedTextures,r,1)}},TextureSystem.prototype.updateTextureStyle=function updateTextureStyle(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==S&&2===this.webGLVersion||t.isPowerOfTwo?(e.mipmap=t.mipmap>=1,e.wrapMode=t.wrapMode):(e.mipmap=0,e.wrapMode=b),t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},TextureSystem.prototype.setStyle=function setStyle(t,e){var i=this.gl;e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap?i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST):i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST),i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},TextureSystem}(Ut),ii=new W,ri=function(t){function Renderer(e){void 0===e&&(e={}),t.call(this,"WebGL",e),e=this.options,this.type=m.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new ft("destroy"),contextChange:new ft("contextChange",1),reset:new ft("reset"),update:new ft("update"),postrender:new ft("postrender"),prerender:new ft("prerender"),resize:new ft("resize",2)},this.globalUniforms=new ne({projectionMatrix:new W},!0),this.addSystem(Ne,"mask").addSystem(le,"context").addSystem(Qe,"state").addSystem(We,"shader").addSystem(ei,"texture").addSystem(fe,"geometry").addSystem(ce,"framebuffer").addSystem(Ge,"stencil").addSystem(je,"projection").addSystem($e,"textureGC").addSystem(se,"filter").addSystem(He,"renderTexture").addSystem(he,"batch"),this.initPlugins(Renderer.__plugins),e.context?this.context.initFromContext(e.context):this.context.initFromOptions({alpha:this.transparent,antialias:e.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,sayHello(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(Renderer.__proto__=t),Renderer.prototype=Object.create(t&&t.prototype),Renderer.prototype.constructor=Renderer,Renderer.create=function create(t){if(isWebGLSupported())return new Renderer(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},Renderer.prototype.addSystem=function addSystem(t,e){e||(e=t.name);var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},Renderer.prototype.render=function render(t,e,i,r,n){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},Renderer.prototype.resize=function resize(e,i){t.prototype.resize.call(this,e,i),this.runners.resize.run(e,i)},Renderer.prototype.reset=function reset(){return this.runners.reset.run(),this},Renderer.prototype.clear=function clear(){this.framebuffer.bind(),this.framebuffer.clear()},Renderer.prototype.destroy=function destroy(e){this.runners.destroy.run(),t.prototype.destroy.call(this,e),this.gl=null},Renderer.registerPlugin=function registerPlugin(t,e){Renderer.__plugins=Renderer.__plugins||{},Renderer.__plugins[t]=e},Renderer}(function(t){function AbstractRenderer(e,i){t.call(this),(i=Object.assign({},a.RENDER_OPTIONS,i)).roundPixels&&(a.ROUND_PIXELS=i.roundPixels,deprecation("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=i,this.type=m.UNKNOWN,this.screen=new rt(0,0,i.width,i.height),this.view=i.view||document.createElement("canvas"),this.resolution=i.resolution||a.RESOLUTION,this.transparent=i.transparent,this.autoDensity=i.autoDensity||i.autoResize||!1,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=i.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new dt,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(AbstractRenderer.__proto__=t),AbstractRenderer.prototype=Object.create(t&&t.prototype),AbstractRenderer.prototype.constructor=AbstractRenderer;var e={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return AbstractRenderer.prototype.initPlugins=function initPlugins(t){for(var e in t)this.plugins[e]=new t[e](this)},e.width.get=function(){return this.view.width},e.height.get=function(){return this.view.height},AbstractRenderer.prototype.resize=function resize(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},AbstractRenderer.prototype.generateTexture=function generateTexture(t,e,i,r){0===(r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var n=Wt.create(0|r.width,0|r.height,e,i);return ii.tx=-r.x,ii.ty=-r.y,this.render(t,n,!1,ii,!!t.parent),n},AbstractRenderer.prototype.destroy=function destroy(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=m.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},e.backgroundColor.get=function(){return this._backgroundColor},e.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=hex2string(t),hex2rgb(t,this._backgroundColorRgba)},Object.defineProperties(AbstractRenderer.prototype,e),AbstractRenderer}(u.a));var ni="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",oi="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",si=function(t){function BatchGeometry(e){void 0===e&&(e=!1),t.call(this),this._buffer=new Kt(null,e,!1),this._indexBuffer=new Kt(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,x.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,x.FLOAT).addAttribute("aColor",this._buffer,4,!0,x.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,x.FLOAT).addIndex(this._indexBuffer)}return t&&(BatchGeometry.__proto__=t),BatchGeometry.prototype=Object.create(t&&t.prototype),BatchGeometry.prototype.constructor=BatchGeometry,BatchGeometry}(te),ai=function BatchDrawCall(){this.textures=[],this.ids=[],this.blend=0,this.textureCount=0,this.start=0,this.size=0,this.type=4},hi=function BatchBuffer(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)};hi.prototype.destroy=function destroy(){this.vertices=null,this.float32View=null,this.uint32View=null};var ui="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",li=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"),ci={},di={};var pi=function(t){function BatchRenderer(e){t.call(this,e),this.vertSize=6,this.vertByteSize=4*this.vertSize,this.size=8e3,this.currentSize=0,this.currentIndexSize=0,this.attributeBuffers={},this.aBuffers={},this.iBuffers={},this.onlySprites=!1,this.shader=null,this.currentIndex=0,this.groups=[];for(var i=0;i<this.size/4;i++)this.groups[i]=new ai;this.elements=[],this.vaos=[],this.vaoMax=2,this.vertexCount=0,this.renderer.on("prerender",this.onPrerender,this),this.state=Ie.for2d()}return t&&(BatchRenderer.__proto__=t),BatchRenderer.prototype=Object.create(t&&t.prototype),BatchRenderer.prototype.constructor=BatchRenderer,BatchRenderer.prototype.contextChange=function contextChange(){var t=this.renderer.gl;a.PREFER_ENV===f.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),a.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function checkMaxIfStatementsInShader(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Se.replace(/%forloop%/gi,generateIfTestSrc(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this.shader=function generateMultiTextureShader(t,e){if(!di[e]){for(var i=new Int32Array(e),r=0;r<e;r++)i[r]=r;ci[e]=ne.from({uSamplers:i},!0);var n=li;n=(n=n.replace(/%count%/gi,e)).replace(/%forloop%/gi,function generateSampleSrc(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e)),di[e]=new Ae(ui,n)}var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new W,default:ci[e]};return new Oe(di[e],o)}(0,this.MAX_TEXTURES);for(var e=0;e<this.vaoMax;e++)this.vaos[e]=new si},BatchRenderer.prototype.onPrerender=function onPrerender(){this.vertexCount=0},BatchRenderer.prototype.render=function render(t){t._texture.valid&&(this.currentSize+t.vertexData.length/2>this.size&&this.flush(),this.elements[this.currentIndex++]=t,this.currentSize+=t.vertexData.length/2,this.currentIndexSize+=t.indices.length)},BatchRenderer.prototype.getIndexBuffer=function getIndexBuffer(t){var e=nextPow2(Math.ceil(t/12)),i=log2(e),r=12*e;this.iBuffers.length<=i&&(this.iBuffers.length=i+1);var n=this.iBuffers[i];return n||(this.iBuffers[i]=n=new Uint16Array(r)),n},BatchRenderer.prototype.getAttributeBuffer=function getAttributeBuffer(t){var e=nextPow2(Math.ceil(t/8)),i=log2(e),r=8*e;this.aBuffers.length<=i&&(this.iBuffers.length=i+1);var n=this.aBuffers[r];return n||(this.aBuffers[r]=n=new hi(r*this.vertByteSize)),n},BatchRenderer.prototype.flush=function flush(){if(0!==this.currentSize){var t,e,i=this.renderer.gl,r=this.MAX_TEXTURES,n=this.getAttributeBuffer(this.currentSize),o=this.getIndexBuffer(this.currentIndexSize),s=this.elements,h=this.groups,u=n.float32View,l=n.uint32View,c=this.renderer.textureGC.count,d=0,p=0,f=0,m=0,g=h[0],y=-1;g.textureCount=0,g.start=0,g.blend=y;var v,_=++Rt._globalBatch;for(v=0;v<this.currentIndex;++v){var x=s[v];s[v]=null,t=x._texture.baseTexture;var b=P[t.premultiplyAlpha?1:0][x.blendMode];y!==b&&(y=b,e=null,m=r,_++),e!==t&&(e=t,t._batchEnabled!==_&&(m===r&&(_++,m=0,g.size=p-g.start,(g=h[f++]).textureCount=0,g.blend=y,g.start=p),t.touched=c,t._batchEnabled=_,t._id=m,g.textures[g.textureCount++]=t,m++)),this.packGeometry(x,u,l,o,d,p),d+=x.vertexData.length/2*this.vertSize,p+=x.indices.length}Rt._globalBatch=_,g.size=p-g.start,a.CAN_UPLOAD_SAME_BUFFER?(this.vaos[this.vertexCount]._buffer.update(n.vertices,0),this.vaos[this.vertexCount]._indexBuffer.update(o,0),this.renderer.geometry.updateBuffers()):(this.vaoMax<=this.vertexCount&&(this.vaoMax++,this.vaos[this.vertexCount]=new si),this.vaos[this.vertexCount]._buffer.update(n.vertices,0),this.vaos[this.vertexCount]._indexBuffer.update(o,0),this.renderer.geometry.bind(this.vaos[this.vertexCount]),this.renderer.geometry.updateBuffers(),this.vertexCount++);var T=this.renderer.texture,S=this.renderer.state;for(v=0;v<f;v++){for(var w=h[v],E=w.textureCount,A=0;A<E;A++)T.bind(w.textures[A],A),w.textures[A]=null;S.setBlendMode(w.blend),i.drawElements(w.type,w.size,i.UNSIGNED_SHORT,2*w.start)}this.currentIndex=0,this.currentSize=0,this.currentIndexSize=0}},BatchRenderer.prototype.packGeometry=function packGeometry(t,e,i,r,n,o){for(var s=n/this.vertSize,a=t.uvs,h=t.indices,u=t.vertexData,l=t._texture.baseTexture._id,c=Math.min(t.worldAlpha,1),d=c<1&&t._texture.baseTexture.premultiplyAlpha?premultiplyTint(t._tintRGB,c):t._tintRGB+(255*c<<24),p=0;p<u.length;p+=2)e[n++]=u[p],e[n++]=u[p+1],e[n++]=a[p],e[n++]=a[p+1],i[n++]=d,e[n++]=l;for(var f=0;f<h.length;f++)r[o++]=s+h[f]},BatchRenderer.prototype.start=function start(){this.renderer.state.setState(this.state),this.renderer.shader.bind(this.shader),a.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this.vaos[this.vertexCount])},BatchRenderer.prototype.stop=function stop(){this.flush()},BatchRenderer.prototype.destroy=function destroy(){for(var e=0;e<this.vaoMax;e++)this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),this.shader&&(this.shader.destroy(),this.shader=null),this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null,t.prototype.destroy.call(this)},BatchRenderer}(ae),fi=new rt,mi=function Extract(t){this.renderer=t,t.extract=this};
/*!
 * @pixi/extract - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */mi.prototype.image=function image(t,e,i){var image=new Image;return image.src=this.base64(t,e,i),image},mi.prototype.base64=function base64(t,e,i){return this.canvas(t).toDataURL(e,i)},mi.prototype.canvas=function canvas(t){var e,i,r,n=this.renderer,o=!1,s=!1;t&&(t instanceof Wt?r=t:(r=this.renderer.generateTexture(t),s=!0)),r?(e=r.baseTexture.resolution,i=r.frame,o=!1,n.renderTexture.bind(r)):(e=this.renderer.resolution,o=!0,(i=fi).width=this.renderer.width,i.height=this.renderer.height,n.renderTexture.bind(null));var a=i.width*e,h=i.height*e,u=new F(a,h,1),l=new Uint8Array(4*a*h),c=n.gl;c.readPixels(i.x*e,i.y*e,a,h,c.RGBA,c.UNSIGNED_BYTE,l);var d=u.context.getImageData(0,0,a,h);return d.data.set(l),u.context.putImageData(d,0,0),o&&(u.context.scale(1,-1),u.context.drawImage(u.canvas,0,-h)),s&&r.destroy(!0),u.canvas},mi.prototype.pixels=function pixels(t){var e,i,r,n=this.renderer,o=!1;t&&(t instanceof Wt?r=t:(r=this.renderer.generateTexture(t),o=!0)),r?(e=r.baseTexture.resolution,i=r.frame,n.renderTexture.bind(r)):(e=n.resolution,(i=fi).width=n.width,i.height=n.height,n.renderTexture.bind(null));var s=i.width*e,a=i.height*e,h=new Uint8Array(4*s*a),u=n.gl;return u.readPixels(i.x*e,i.y*e,s,a,u.RGBA,u.UNSIGNED_BYTE,h),o&&r.destroy(!0),h},mi.prototype.destroy=function destroy(){this.renderer.extract=null,this.renderer=null};
/*!
 * @pixi/interaction - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var gi=function InteractionData(){this.global=new N,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},yi={pointerId:{configurable:!0}};yi.pointerId.get=function(){return this.identifier},gi.prototype.getLocalPosition=function getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},gi.prototype.copyEvent=function copyEvent(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},gi.prototype.reset=function reset(){this.isPrimary=!1},Object.defineProperties(gi.prototype,yi);var vi=function InteractionEvent(){this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null};vi.prototype.stopPropagation=function stopPropagation(){this.stopped=!0},vi.prototype.reset=function reset(){this.stopped=!1,this.currentTarget=null,this.target=null};var _i=function InteractionTrackingData(t){this._pointerId=t,this._flags=InteractionTrackingData.FLAGS.NONE},xi={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}};_i.prototype._doSet=function _doSet(t,e){this._flags=e?this._flags|t:this._flags&~t},xi.pointerId.get=function(){return this._pointerId},xi.flags.get=function(){return this._flags},xi.flags.set=function(t){this._flags=t},xi.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},xi.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},xi.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},xi.rightDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},xi.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},xi.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},xi.leftDown.set=function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(_i.prototype,xi),_i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});var bi={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ct.mixin(bi);var Ti=1,Si={target:null,data:{global:null}},wi=function(t){function InteractionManager(e,i){t.call(this),i=i||{},this.renderer=e,this.autoPreventDefault=void 0===i.autoPreventDefault||i.autoPreventDefault,this.interactionFrequency=i.interactionFrequency||10,this.mouse=new gi,this.mouse.identifier=Ti,this.mouse.global.set(-999999),this.activeInteractionData={},this.activeInteractionData[Ti]=this.mouse,this.interactionDataPool=[],this.eventData=new vi,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this._tempPoint=new N,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}return t&&(InteractionManager.__proto__=t),InteractionManager.prototype=Object.create(t&&t.prototype),InteractionManager.prototype.constructor=InteractionManager,InteractionManager.prototype.hitTest=function hitTest(t,e){return Si.target=null,Si.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(Si,e,null,!0),Si.target},InteractionManager.prototype.setTargetElement=function setTargetElement(t,e){void 0===e&&(e=1),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},InteractionManager.prototype.addEvents=function addEvents(){this.interactionDOMElement&&(bt.system.add(this.update,this,gt),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},InteractionManager.prototype.removeEvents=function removeEvents(){this.interactionDOMElement&&(bt.system.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},InteractionManager.prototype.update=function update(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},InteractionManager.prototype.setCursorMode=function setCursorMode(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},InteractionManager.prototype.dispatchEvent=function dispatchEvent(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},InteractionManager.prototype.mapPositionToPoint=function mapPositionToPoint(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*n,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)*n},InteractionManager.prototype.processInteractive=function processInteractive(t,e,i,r,n){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(r=!1,h=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;l>=0;l--){var c=u[l],d=this.processInteractive(t,c,i,r,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(r=!1),s=!0)}}return n&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),i&&i(t,e,!!s))),s},InteractionManager.prototype.onPointerDown=function onPointerDown(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],o=this.getInteractionDataForPointerId(n),s=this.configureInteractionEventForDOMEvent(this.eventData,n,o);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===n.pointerType)this.emit("touchstart",s);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},InteractionManager.prototype.processPointerDown=function processPointerDown(t,e,i){var r=t.data,n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new _i(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var o=2===r.button;o?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},InteractionManager.prototype.onPointerComplete=function onPointerComplete(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<n;s++){var a=r[s],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.renderer._lastObjectRendered,i,e||!o),this.emit(e?"pointercancel":"pointerup"+o,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+o:"mouseup"+o,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,u),this.releaseInteractionDataForPointerId(a.pointerId,h))}},InteractionManager.prototype.onPointerCancel=function onPointerCancel(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},InteractionManager.prototype.processPointerCancel=function processPointerCancel(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},InteractionManager.prototype.onPointerUp=function onPointerUp(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},InteractionManager.prototype.processPointerUp=function processPointerUp(t,e,i){var r=t.data,n=t.data.identifier,o=e.trackedPointers[n],s="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,h=!1;if(a){var u=2===r.button,l=_i.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==o&&o.flags&c;i?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),o&&(u?o.rightDown=!1:o.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!h||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[n]},InteractionManager.prototype.onPointerMove=function onPointerMove(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],o=this.getInteractionDataForPointerId(n),s=this.configureInteractionEventForDOMEvent(this.eventData,n,o);s.data.originalEvent=t;var a="touch"!==n.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===n.pointerType&&this.emit("touchmove",s),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},InteractionManager.prototype.processPointerMove=function processPointerMove(t,e,i){var r=t.data,n="touch"===r.pointerType,o="mouse"===r.pointerType||"pen"===r.pointerType;o&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},InteractionManager.prototype.onPointerOut=function onPointerOut(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},InteractionManager.prototype.processPointerOverOut=function processPointerOverOut(t,e,i){var r=t.data,n=t.data.identifier,o="mouse"===r.pointerType||"pen"===r.pointerType,s=e.trackedPointers[n];i&&!s&&(s=e.trackedPointers[n]=new _i(n)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),o&&this.dispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[n]))},InteractionManager.prototype.onPointerOver=function onPointerOver(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},InteractionManager.prototype.getInteractionDataForPointerId=function getInteractionDataForPointerId(t){var e,i=t.pointerId;return i===Ti||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new gi).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},InteractionManager.prototype.releaseInteractionDataForPointerId=function releaseInteractionDataForPointerId(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},InteractionManager.prototype.configureInteractionEventForDOMEvent=function configureInteractionEventForDOMEvent(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},InteractionManager.prototype.normalizeToPointerData=function normalizeToPointerData(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=Ti),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0,e.push(t));return e},InteractionManager.prototype.destroy=function destroy(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},InteractionManager}(u.a),Ei={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function _segmentsCount(t,e){if(void 0===e&&(e=20),!this.adaptive)return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},Ai=function FillStyle(){this.reset()};Ai.prototype.clone=function clone(){var t=new Ai;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},Ai.prototype.reset=function reset(){this.color=16777215,this.alpha=1,this.texture=Yt.WHITE,this.matrix=null,this.visible=!1},Ai.prototype.destroy=function destroy(){this.texture=null,this.matrix=null};var Ci=function GraphicsData(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]};Ci.prototype.clone=function clone(){return new Ci(this.shape,this.fillStyle,this.lineStyle,this.matrix)},Ci.prototype.destroy=function destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var Oi={build:function build(t){var e,i,r=t.shape,n=t.points,o=r.x,s=r.y;if(n.length=0,t.type===Y.CIRC?(e=r.radius,i=r.radius):(e=r.width,i=r.height),0!==e&&0!==i){var a=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height));a/=2.3;for(var h=2*Math.PI/a,u=0;u<a;u++)n.push(o+Math.sin(-h*u)*e,s+Math.cos(-h*u)*i);n.push(n[0],n[1])}},triangulate:function triangulate(t,e){var i=t.points,r=e.points,n=e.indices,o=r.length/2,s=o;r.push(t.shape.x,t.shape.y);for(var a=0;a<i.length;a+=2)r.push(i[a],i[a+1]),n.push(o++,s,o)}};function buildLine(t,e){t.lineStyle.native?function buildNativeLine(t,e){var i=0,r=t.points||t.shape.points;if(0===r.length)return;var n=e.points,o=e.indices,s=r.length/2,a=n.length/2;for(i=1;i<s;i++){var h=r[2*(i-1)],u=r[2*(i-1)+1],l=r[2*i],c=r[2*i+1];n.push(h,u),n.push(l,c),o.push(a++,a++)}}(t,e):function buildLine$1(t,e){var i=t.shape,r=t.points||i.points.slice();if(0===r.length)return;var n=t.lineStyle,o=new N(r[0],r[1]),s=new N(r[r.length-2],r[r.length-1]),a=i.type!==Y.POLY||i.closeStroke,h=o.x===s.x&&o.y===s.y;if(a){r=r.slice(),h&&(r.pop(),r.pop(),s.set(r[r.length-2],r[r.length-1]));var u=s.x+.5*(o.x-s.x),l=s.y+.5*(o.y-s.y);r.unshift(u,l),r.push(u,l)}var c=e.points,d=r.length/2,p=r.length,f=c.length/2,m=n.width/2,g=r[0],y=r[1],v=r[2],_=r[3],x=0,b=0,T=-(y-_),S=g-v,w=0,E=0,A=0,C=0,O=Math.sqrt(T*T+S*S);T/=O,S/=O,T*=m,S*=m;var P=n.alignment,I=2*(1-P),M=2*P;c.push(g-T*I,y-S*I),c.push(g+T*M,y+S*M);for(var R=1;R<d-1;++R){g=r[2*(R-1)],y=r[2*(R-1)+1],v=r[2*R],_=r[2*R+1],x=r[2*(R+1)],b=r[2*(R+1)+1],T=-(y-_),S=g-v,O=Math.sqrt(T*T+S*S),T/=O,S/=O,T*=m,S*=m,w=-(_-b),E=v-x,O=Math.sqrt(w*w+E*E),w/=O,E/=O;var D=-S+y-(-S+_),F=-T+v-(-T+g),B=(-T+g)*(-S+_)-(-T+v)*(-S+y),L=-(E*=m)+b-(-E+_),k=-(w*=m)+v-(-w+x),U=(-w+x)*(-E+_)-(-w+v)*(-E+b),G=D*k-L*F;if(Math.abs(G)<.1)G+=10.1,c.push(v-T*I,_-S*I),c.push(v+T*M,_+S*M);else{var j=(F*U-k*B)/G,X=(L*B-D*U)/G,H=(j-v)*(j-v)+(X-_)*(X-_);H>196*m*m?(A=T-w,C=S-E,O=Math.sqrt(A*A+C*C),A/=O,C/=O,A*=m,C*=m,c.push(v-A*I,_-C*I),c.push(v+A*M,_+C*M),c.push(v-A*M*I,_-C*I),p++):(c.push(v+(j-v)*I,_+(X-_)*I),c.push(v-(j-v)*M,_-(X-_)*M))}}g=r[2*(d-2)],y=r[2*(d-2)+1],v=r[2*(d-1)],_=r[2*(d-1)+1],T=-(y-_),S=g-v,O=Math.sqrt(T*T+S*S),T/=O,S/=O,T*=m,S*=m,c.push(v-T*I,_-S*I),c.push(v+T*M,_+S*M);for(var z=e.indices,W=0;W<p-2;++W)z.push(f,f+1,f+2),f++}(t,e)}var Pi={build:function build(t){t.points=t.shape.points.slice()},triangulate:function triangulate(t,e){var i=t.points,r=t.holes,n=e.points,o=e.indices;if(i.length>=6){for(var s=[],a=0;a<r.length;a++){var h=r[a];s.push(i.length/2),i=i.concat(h.points)}var u=c()(i,s,2);if(!u)return;for(var l=n.length/2,d=0;d<u.length;d+=3)o.push(u[d]+l),o.push(u[d+1]+l),o.push(u[d+2]+l);for(var p=0;p<i.length;p++)n.push(i[p])}}},Ii={build:function build(t){var e=t.shape,i=t.points,r=e.x,n=e.y,o=e.width,s=e.height,a=e.radius;i.length=0,quadraticBezierCurve(r,n+a,r,n,r+a,n,i),quadraticBezierCurve(r+o-a,n,r+o,n,r+o,n+a,i),quadraticBezierCurve(r+o,n+s-a,r+o,n+s,r+o-a,n+s,i),quadraticBezierCurve(r+a,n+s,r,n+s,r,n+s-a,i)},triangulate:function triangulate(t,e){for(var i=t.points,r=e.points,n=e.indices,o=r.length/2,s=c()(i,null,2),a=0,h=s.length;a<h;a+=3)n.push(s[a]+o),n.push(s[a+1]+o),n.push(s[a+2]+o);for(var u=0,l=i.length;u<l;u++)r.push(i[u],i[++u])}};function getPt(t,e,i){return t+(e-t)*i}function quadraticBezierCurve(t,e,i,r,n,o,s){void 0===s&&(s=[]);for(var a=s,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=getPt(t,i,m=f/20),u=getPt(e,r,m),l=getPt(i,n,m),c=getPt(r,o,m),d=getPt(h,l,m),p=getPt(u,c,m),a.push(d,p);return a}var Mi=[],Ri=[],Di={};Di[Y.POLY]=Pi,Di[Y.CIRC]=Oi,Di[Y.ELIP]=Oi,Di[Y.RECT]={build:function build(t){var e=t.shape,i=e.x,r=e.y,n=e.width,o=e.height,s=t.points;s.length=0,s.push(i,r,i+n,r,i+n,r+o,i,r+o)},triangulate:function triangulate(t,e){var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},Di[Y.RREC]=Ii;var Fi=function BatchPart(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},Bi=function(t){function GraphicsGeometry(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new lt,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null}t&&(GraphicsGeometry.__proto__=t),GraphicsGeometry.prototype=Object.create(t&&t.prototype),GraphicsGeometry.prototype.constructor=GraphicsGeometry;var e={bounds:{configurable:!0}};return e.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},GraphicsGeometry.prototype.clear=function clear(){if(this.graphicsData.length>0){this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.batchDirty++,this.graphicsData.length=0,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,Ri.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var i=this.batches[e];i.start=0,i.attribStart=0,i.style=null,Mi.push(i)}this.batches.length=0}return this},GraphicsGeometry.prototype.drawShape=function drawShape(t,e,i,r){var n=new Ci(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},GraphicsGeometry.prototype.drawHole=function drawHole(t,e){if(!this.graphicsData.length)return null;var i=new Ci(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,i},GraphicsGeometry.prototype.destroy=function destroy(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},GraphicsGeometry.prototype.containsPoint=function containsPoint(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&r.shape.contains(t.x,t.y))){if(r.holes)for(var n=0;n<r.holes.length;n++){if(r.holes[n].shape.contains(t.x,t.y))return!1}return!0}}return!1},GraphicsGeometry.prototype.updateBatches=function updateBatches(){if(this.dirty!==this.cacheDirty&&0!==this.graphicsData.length){if(this.dirty!==this.cacheDirty)for(var t=0;t<this.graphicsData.length;t++){var e=this.graphicsData[t];if(e.fillStyle&&!e.fillStyle.texture.baseTexture.valid)return;if(e.lineStyle&&!e.lineStyle.texture.baseTexture.valid)return}this.cacheDirty=this.dirty;var i=this.uvs,r=this.batches.pop()||Mi.pop()||new Fi;r.style=r.style||this.graphicsData[0].fillStyle||this.graphicsData[0].lineStyle;var n=r.style.texture.baseTexture,o=r.style.color+r.style.alpha;this.batches.push(r);for(var s=this.shapeIndex;s<this.graphicsData.length;s++){this.shapeIndex++;var a=this.graphicsData[s],h=Di[a.type],u=a.fillStyle,l=a.lineStyle;h.build(a),a.matrix&&this.transformPoints(a.points,a.matrix);for(var c=0;c<2;c++){var d=0===c?u:l;if(d.visible){var p=d.texture.baseTexture;if(n!==p||d.color+d.alpha!==o){p.wrapMode=10497,n=p,o=d.color+d.alpha;var f=this.indices.length,m=this.points.length/2;r.size=f-r.start,r.attribSize=m-r.attribStart,r.size>0&&(r=Mi.pop()||new Fi,this.batches.push(r)),r.style=d,r.start=f,r.attribStart=m}var g=this.points.length/2;if(0===c)a.holes.length?(this.processHoles(a.holes),Pi.triangulate(a,this)):h.triangulate(a,this);else{buildLine(a,this);for(var y=0;y<a.holes.length;y++)buildLine(a.holes[y],this)}var v=this.points.length/2-g;this.addUvs(this.points,i,d.texture,g,v,d.matrix)}}}var _=this.indices.length,x=this.points.length/2;if(r.size=_-r.start,r.attribSize=x-r.attribStart,this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var b=0;b<this.batches.length;b++)for(var T=this.batches[b],S=0;S<T.size;S++){var w=T.start+S;this.indicesUint16[w]=this.indicesUint16[w]-T.attribStart}}else this.buildDrawCalls()}},GraphicsGeometry.prototype.isBatchable=function isBatchable(){for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*GraphicsGeometry.BATCHABLE_SIZE},GraphicsGeometry.prototype.buildDrawCalls=function buildDrawCalls(){for(var t=++Rt._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,Ri.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.uvs,r=this.colors,n=this.textureIds,o=Ri.pop()||new ai;o.textureCount=0,o.start=0,o.size=0,o.type=y.TRIANGLES;var s=0,a=null,h=0,u=!1,l=y.TRIANGLES,c=0;this.drawCalls.push(o);for(var d=0;d<this.batches.length;d++){var p=this.batches[d],f=p.style,m=f.texture.baseTexture;u!==f.native&&(l=(u=f.native)?y.LINES:y.TRIANGLES,a=null,s=8,t++),a!==m&&(a=m,m._batchEnabled!==t&&(8===s&&(t++,s=0,o.size>0&&(o=Ri.pop()||new ai,this.drawCalls.push(o)),o.start=c,o.size=0,o.textureCount=0,o.type=l),m.touched=1,m._batchEnabled=t,m._id=s,m.wrapMode=10497,o.textures[o.textureCount++]=m,s++)),o.size+=p.size,c+=p.size,h=m._id,this.addColors(r,f.color,f.alpha,p.attribSize),this.addTextureIds(n,h,p.attribSize)}Rt._globalBatch=t;for(var g=this.points,v=new ArrayBuffer(3*g.length*4),_=new Float32Array(v),x=new Uint32Array(v),b=0,T=0;T<g.length/2;T++)_[b++]=g[2*T],_[b++]=g[2*T+1],_[b++]=i[2*T],_[b++]=i[2*T+1],x[b++]=r[T],_[b++]=n[T];this._buffer.update(v),this._indexBuffer.update(this.indicesUint16)},GraphicsGeometry.prototype.processHoles=function processHoles(t){for(var e=0;e<t.length;e++){var i=t[e];Di[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},GraphicsGeometry.prototype.calculateBounds=function calculateBounds(){var t=1/0,e=-1/0,i=1/0,r=-1/0;if(this.graphicsData.length)for(var n=null,o=0,s=0,a=0,h=0,u=0;u<this.graphicsData.length;u++){var l=this.graphicsData[u],c=l.type,d=l.lineStyle?l.lineStyle.width:0;if(n=l.shape,c===Y.RECT||c===Y.RREC)o=n.x-d/2,s=n.y-d/2,t=o<t?o:t,e=o+(a=n.width+d)>e?o+a:e,i=s<i?s:i,r=s+(h=n.height+d)>r?s+h:r;else if(c===Y.CIRC)o=n.x,s=n.y,t=o-(a=n.radius+d/2)<t?o-a:t,e=o+a>e?o+a:e,i=s-(h=n.radius+d/2)<i?s-h:i,r=s+h>r?s+h:r;else if(c===Y.ELIP)o=n.x,s=n.y,t=o-(a=n.width+d/2)<t?o-a:t,e=o+a>e?o+a:e,i=s-(h=n.height+d/2)<i?s-h:i,r=s+h>r?s+h:r;else for(var p=n.points,f=0,m=0,g=0,y=0,v=0,_=0,x=0,b=0,T=0;T+2<p.length;T+=2)o=p[T],s=p[T+1],f=p[T+2],m=p[T+3],g=Math.abs(f-o),y=Math.abs(m-s),h=d,(a=Math.sqrt(g*g+y*y))<1e-9||(t=(x=(f+o)/2)-(v=(h/a*y+g)/2)<t?x-v:t,e=x+v>e?x+v:e,i=(b=(m+s)/2)-(_=(h/a*g+y)/2)<i?b-_:i,r=b+_>r?b+_:r)}else t=0,e=0,i=0,r=0;var S=this.boundsPadding;this._bounds.minX=t-S,this._bounds.maxX=e+S,this._bounds.minY=i-S,this._bounds.maxY=r+S},GraphicsGeometry.prototype.transformPoints=function transformPoints(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},GraphicsGeometry.prototype.addColors=function addColors(t,e,i,r){for(var n=premultiplyTint((e>>16)+(65280&e)+((255&e)<<16),i);r-- >0;)t.push(n)},GraphicsGeometry.prototype.addTextureIds=function addTextureIds(t,e,i){for(;i-- >0;)t.push(e)},GraphicsGeometry.prototype.addUvs=function addUvs(t,e,i,r,n,o){for(var s=0,a=e.length,h=i.frame;s<n;){var u=t[2*(r+s)],l=t[2*(r+s)+1];if(o){var c=o.a*u+o.c*l+o.tx;l=o.b*u+o.d*l+o.ty,u=c}s++,e.push(u/h.width,l/h.height)}var d=i.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,i,a,n)},GraphicsGeometry.prototype.adjustUvs=function adjustUvs(t,e,i,r){for(var n=e.baseTexture,o=i+2*r,s=e.frame,a=s.width/n.width,h=s.height/n.height,u=s.x/s.width,l=s.y/s.height,c=Math.floor(t[i]+1e-6),d=Math.floor(t[i+1]+1e-6),p=i+2;p<o;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));u-=c,l-=d;for(var f=i;f<o;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+l)*h},Object.defineProperties(GraphicsGeometry.prototype,e),GraphicsGeometry}(si);Bi.BATCHABLE_SIZE=100;var Li=function(t){function LineStyle(){t.apply(this,arguments)}return t&&(LineStyle.__proto__=t),LineStyle.prototype=Object.create(t&&t.prototype),LineStyle.prototype.constructor=LineStyle,LineStyle.prototype.clone=function clone(){var t=new LineStyle;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},LineStyle.prototype.reset=function reset(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},LineStyle}(Ai),ki=function BezierUtils(){};ki.curveLength=function curveLength(t,e,i,r,n,o,s,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,_=t,x=e,b=1;b<=10;++b)y=_-(m=(f=(p=(d=1-(u=b/10))*d)*d)*t+3*p*u*i+3*d*(l=u*u)*n+(c=l*u)*s),v=x-(g=f*e+3*p*u*r+3*d*l*o+c*a),_=m,x=g,h+=Math.sqrt(y*y+v*v);return h},ki.curveTo=function curveTo(t,e,i,r,n,o,s){var a=s[s.length-2],h=s[s.length-1];s.length-=2;var u=Ei._segmentsCount(ki.curveLength(a,h,t,e,i,r,n,o)),l=0,c=0,d=0,p=0,f=0;s.push(a,h);for(var m=1,g=0;m<=u;++m)d=(c=(l=1-(g=m/u))*l)*l,f=(p=g*g)*g,s.push(d*a+3*c*g*t+3*l*p*i+f*n,d*h+3*c*g*e+3*l*p*r+f*o)};var Ui=function QuadraticUtils(){};Ui.curveLength=function curveLength(t,e,i,r,n,o){var s=t-2*i+n,a=e-2*r+o,h=2*i-2*t,u=2*r-2*e,l=4*(s*s+a*a),c=4*(s*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,g=2*Math.sqrt(d),y=c/f;return(m*p+f*c*(p-g)+(4*d*l-c*c)*Math.log((2*f+y+p)/(y+g)))/(4*m)},Ui.curveTo=function curveTo(t,e,i,r,n){for(var o=n[n.length-2],s=n[n.length-1],a=Ei._segmentsCount(Ui.curveLength(o,s,t,e,i,r)),h=0,u=0,l=1;l<=a;++l){var c=l/a;h=o+(t-o)*c,u=s+(e-s)*c,n.push(h+(t+(i-t)*c-h)*c,u+(e+(r-e)*c-u)*c)}};var Ni=function ArcUtils(){};Ni.curveTo=function curveTo(t,e,i,r,n,o){var s=o[o.length-2],a=o[o.length-1]-e,h=s-t,u=r-e,l=i-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(p)/c,y=m*f/d,v=g*f/p,_=m*l+g*h,x=m*u+g*a,b=h*(g+y),T=a*(g+y),S=l*(m+v),w=u*(m+v);return{cx:_+t,cy:x+e,radius:n,startAngle:Math.atan2(T-x,b-_),endAngle:Math.atan2(w-x,S-_),anticlockwise:h*u>l*a}},Ni.arc=function arc(t,e,i,r,n,o,s,a,h){for(var u=s-o,l=Ei._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/X)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,g=m%1/m,y=0;y<=m;++y){var v=c+o+d*(y+g*y),_=Math.cos(v),x=-Math.sin(v);h.push((p*_+f*x)*n+i,(p*-x+f*_)*n+r)}};var Gi=function(t){function Star(e,i,r,n,o,s){o=o||n/2;for(var a=-1*Math.PI/2+s,h=2*r,u=X/h,l=[],c=0;c<h;c++){var d=c%2?o:n,p=c*u+a;l.push(e+d*Math.cos(p),i+d*Math.sin(p))}t.call(this,l)}return t&&(Star.__proto__=t),Star.prototype=Object.create(t&&t.prototype),Star.prototype.constructor=Star,Star}(ht),ji=new Float32Array(3),Xi=null,Hi=function(t){function Graphics(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new Bi,this.geometry.refCount++,this.shader=null,this.state=Ie.for2d(),this._fillStyle=new Ai,this._lineStyle=new Li,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.tint=16777215,this.blendMode=g.NORMAL}t&&(Graphics.__proto__=t),Graphics.prototype=Object.create(t&&t.prototype),Graphics.prototype.constructor=Graphics;var e={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return Graphics.prototype.clone=function clone(){return this.finishPoly(),new Graphics(this.geometry)},e.blendMode.set=function(t){this.state.blendMode=t},e.blendMode.get=function(){return this.state.blendMode},e.tint.get=function(){return this._tint},e.tint.set=function(t){this._tint=t},e.fill.get=function(){return this._fillStyle},e.line.get=function(){return this._lineStyle},Graphics.prototype.lineStyle=function lineStyle(t,e,i,r,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=.5),void 0===n&&(n=!1),this.lineTextureStyle(t,Yt.WHITE,e,i,null,r,n),this},Graphics.prototype.lineTextureStyle=function lineTextureStyle(t,e,i,r,n,o,s){void 0===t&&(t=0),void 0===e&&(e=Yt.WHITE),void 0===i&&(i=16777215),void 0===r&&(r=1),void 0===n&&(n=null),void 0===o&&(o=.5),void 0===s&&(s=!1),this.currentPath&&this.startPoly();var a=t>0&&r>0;return a?(n&&(n=n.clone()).invert(),Object.assign(this._lineStyle,{color:i,width:t,alpha:r,matrix:n,texture:e,alignment:o,native:s,visible:a})):this._lineStyle.reset(),this},Graphics.prototype.startPoly=function startPoly(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new ht,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new ht,this.currentPath.closeStroke=!1},Graphics.prototype.finishPoly=function finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},Graphics.prototype.moveTo=function moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},Graphics.prototype.lineTo=function lineTo(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},Graphics.prototype._initCurve=function _initCurve(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},Graphics.prototype.quadraticCurveTo=function quadraticCurveTo(t,e,i,r){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),Ui.curveTo(t,e,i,r,n),this},Graphics.prototype.bezierCurveTo=function bezierCurveTo(t,e,i,r,n,o){return this._initCurve(),ki.curveTo(t,e,i,r,n,o,this.currentPath.points),this},Graphics.prototype.arcTo=function arcTo(t,e,i,r,n){this._initCurve(t,e);var o=this.currentPath.points,s=Ni.curveTo(t,e,i,r,n,o);if(s){var a=s.cx,h=s.cy,u=s.radius,l=s.startAngle,c=s.endAngle,d=s.anticlockwise;this.arc(a,h,u,l,c,d)}return this},Graphics.prototype.arc=function arc(t,e,i,r,n,o){if(void 0===o&&(o=!1),r===n)return this;if(!o&&n<=r?n+=X:o&&r<=n&&(r+=X),0===n-r)return this;var s=t+Math.cos(r)*i,a=e+Math.sin(r)*i,h=this.currentPath?this.currentPath.points:null;if(h){var u=Math.abs(h[h.length-2]-s),l=Math.abs(h[h.length-1]-a);u<.001&&l<.001||h.push(s,a)}else this.moveTo(s,a),h=this.currentPath.points;return Ni.arc(s,a,t,e,i,r,n,o,h),this},Graphics.prototype.beginFill=function beginFill(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill(Yt.WHITE,t,e)},Graphics.prototype.beginTextureFill=function beginTextureFill(t,e,i,r){void 0===t&&(t=Yt.WHITE),void 0===e&&(e=16777215),void 0===i&&(i=1),void 0===r&&(r=null),this.currentPath&&this.startPoly();var n=i>0;return n?(r&&(r=r.clone()).invert(),Object.assign(this._fillStyle,{color:e,alpha:i,texture:t,matrix:r,visible:n})):this._fillStyle.reset(),this},Graphics.prototype.endFill=function endFill(){return this.finishPoly(),this._fillStyle.reset(),this},Graphics.prototype.drawRect=function drawRect(t,e,i,r){return this.drawShape(new rt(t,e,i,r))},Graphics.prototype.drawRoundedRect=function drawRoundedRect(t,e,i,r,n){return this.drawShape(new ut(t,e,i,r,n))},Graphics.prototype.drawCircle=function drawCircle(t,e,i){return this.drawShape(new st(t,e,i))},Graphics.prototype.drawEllipse=function drawEllipse(t,e,i,r){return this.drawShape(new at(t,e,i,r))},Graphics.prototype.drawPolygon=function drawPolygon(t){var e=arguments,i=t,r=!0;if(i.points&&(r=i.closeStroke,i=i.points),!Array.isArray(i)){i=new Array(arguments.length);for(var n=0;n<i.length;++n)i[n]=e[n]}var o=new ht(i);return o.closeStroke=r,this.drawShape(o),this},Graphics.prototype.drawShape=function drawShape(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},Graphics.prototype.drawStar=function drawStar(t,e,i,r,n,o){return void 0===o&&(o=0),this.drawPolygon(new Gi(t,e,i,r,n,o))},Graphics.prototype.clear=function clear(){return this.geometry.clear(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this._spriteRect=null,this},Graphics.prototype.isFastRect=function isFastRect(){return!1},Graphics.prototype._render=function _render(t){this.finishPoly();var e=this.geometry;if(e.updateBatches(),e.batchable){if(this.batchDirty!==e.batchDirty){this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.vertexData=new Float32Array(e.points);for(var i=this.blendMode,r=0;r<e.batches.length;r++){var n=e.batches[r],o=n.style.color,s=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(e.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:s,blendMode:i,indices:new Uint16Array(e.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:hex2rgb(o),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}}if(t.batch.setObjectRenderer(t.plugins.batch),this.batches.length){this.calculateVertices(),this.calculateTints();for(var u=0;u<this.batches.length;u++){var l=this.batches[u];l.worldAlpha=this.worldAlpha*l.alpha,t.plugins.batch.render(l)}}}else{if(t.batch.flush(),!this.shader){if(!Xi){for(var c=new Int32Array(16),d=0;d<16;d++)c[d]=d;var p={tint:new Float32Array([1,1,1,1]),translationMatrix:new W,default:ne.from({uSamplers:c},!0)},f=t.plugins.batch.shader.program;Xi=new Oe(f,p)}this.shader=Xi}var m=this.shader.uniforms;m.translationMatrix=this.transform.worldTransform;var g=this.tint,y=this.worldAlpha;m.tint[0]=(g>>16&255)/255*y,m.tint[1]=(g>>8&255)/255*y,m.tint[2]=(255&g)/255*y,m.tint[3]=y,t.shader.bind(this.shader),t.geometry.bind(e,this.shader),t.state.setState(this.state);for(var v=0;v<e.drawCalls.length;v++){for(var _=e.drawCalls[v],x=_.textureCount,b=0;b<x;b++)t.texture.bind(_.textures[b],b);t.geometry.draw(_.type,_.size,_.start)}}},Graphics.prototype._calculateBounds=function _calculateBounds(){this.finishPoly();var t=this.geometry.bounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},Graphics.prototype.containsPoint=function containsPoint(t){return this.worldTransform.applyInverse(t,Graphics._TEMP_POINT),this.geometry.containsPoint(Graphics._TEMP_POINT)},Graphics.prototype.calculateTints=function calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=hex2rgb(this.tint,ji),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},Graphics.prototype.calculateVertices=function calculateVertices(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,s=t.ty,a=this.geometry.points,h=this.vertexData,u=0,l=0;l<a.length;l+=2){var c=a[l],d=a[l+1];h[u++]=e*c+r*d+o,h[u++]=n*d+i*c+s}}},Graphics.prototype.closePath=function closePath(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},Graphics.prototype.setMatrix=function setMatrix(t){return this._matrix=t,this},Graphics.prototype.beginHole=function beginHole(){return this.finishPoly(),this._holeMode=!0,this},Graphics.prototype.endHole=function endHole(){return this.finishPoly(),this._holeMode=!1,this},Graphics.prototype.destroy=function destroy(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(Graphics.prototype,e),Graphics}(dt);Hi._TEMP_POINT=new N;
/*!
 * @pixi/sprite - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var zi=new N,Yi=new Uint16Array([0,1,2,0,2,3]),Wi=function(t){function Sprite(e){t.call(this),this._anchor=new G(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=g.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||Yt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Yi,this.size=4,this.start=0,this.pluginName="batch",this.isSprite=!0,this._roundPixels=a.ROUND_PIXELS}t&&(Sprite.__proto__=t),Sprite.prototype=Object.create(t&&t.prototype),Sprite.prototype.constructor=Sprite;var e={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return Sprite.prototype._onTextureUpdate=function _onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)},Sprite.prototype._onAnchorUpdate=function _onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1},Sprite.prototype.calculateVertices=function calculateVertices(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,o=e.d,s=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=i*p+n*m+s,h[1]=o*m+r*p+a,h[2]=i*d+n*m+s,h[3]=o*m+r*d+a,h[4]=i*d+n*f+s,h[5]=o*f+r*d+a,h[6]=i*p+n*f+s,h[7]=o*f+r*p+a,this._roundPixels)for(var g=0;g<8;g++)h[g]=Math.round(h[g])}},Sprite.prototype.calculateTrimmedVertices=function calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,s=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-r._x*i.width,d=c+i.width,p=-r._y*i.height,f=p+i.height;e[0]=o*c+a*p+u,e[1]=h*p+s*c+l,e[2]=o*d+a*p+u,e[3]=h*p+s*d+l,e[4]=o*d+a*f+u,e[5]=h*f+s*d+l,e[6]=o*c+a*f+u,e[7]=h*f+s*c+l},Sprite.prototype._render=function _render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},Sprite.prototype._calculateBounds=function _calculateBounds(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},Sprite.prototype.getLocalBounds=function getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new rt),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},Sprite.prototype.containsPoint=function containsPoint(t){this.worldTransform.applyInverse(t,zi);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return zi.x>=r&&zi.x<r+e&&(n=-i*this.anchor.y,zi.y>=n&&zi.y<n+i)},Sprite.prototype.destroy=function destroy(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null,this.shader=null},Sprite.from=function from(t,e){return new Sprite(t instanceof Yt?t:Yt.from(t,e))},e.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},e.roundPixels.get=function(){return this._roundPixels},e.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},e.width.set=function(t){var e=sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},e.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},e.height.set=function(t){var e=sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},e.anchor.get=function(){return this._anchor},e.anchor.set=function(t){this._anchor.copyFrom(t)},e.tint.get=function(){return this._tint},e.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},e.texture.get=function(){return this._texture},e.texture.set=function(t){this._texture!==t&&(this._texture=t||Yt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(Sprite.prototype,e),Sprite}(dt),Vi=0,qi={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Vi,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Ki=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Zi=function TextStyle(t){this.styleID=0,this.reset(),deepCopyProperties(this,t,t)},Ji={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function getSingleColor(t){return"number"==typeof t?hex2string(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function getColor(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=getSingleColor(t[e]);return t}return getSingleColor(t)}function deepCopyProperties(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}Zi.prototype.clone=function clone(){var t={};return deepCopyProperties(t,this,qi),new Zi(t)},Zi.prototype.reset=function reset(){deepCopyProperties(this,qi,qi)},Ji.align.get=function(){return this._align},Ji.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},Ji.breakWords.get=function(){return this._breakWords},Ji.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},Ji.dropShadow.get=function(){return this._dropShadow},Ji.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},Ji.dropShadowAlpha.get=function(){return this._dropShadowAlpha},Ji.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},Ji.dropShadowAngle.get=function(){return this._dropShadowAngle},Ji.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},Ji.dropShadowBlur.get=function(){return this._dropShadowBlur},Ji.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},Ji.dropShadowColor.get=function(){return this._dropShadowColor},Ji.dropShadowColor.set=function(t){var e=getColor(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},Ji.dropShadowDistance.get=function(){return this._dropShadowDistance},Ji.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},Ji.fill.get=function(){return this._fill},Ji.fill.set=function(t){var e=getColor(t);this._fill!==e&&(this._fill=e,this.styleID++)},Ji.fillGradientType.get=function(){return this._fillGradientType},Ji.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},Ji.fillGradientStops.get=function(){return this._fillGradientStops},Ji.fillGradientStops.set=function(t){(function areArraysEqual(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},Ji.fontFamily.get=function(){return this._fontFamily},Ji.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},Ji.fontSize.get=function(){return this._fontSize},Ji.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},Ji.fontStyle.get=function(){return this._fontStyle},Ji.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},Ji.fontVariant.get=function(){return this._fontVariant},Ji.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},Ji.fontWeight.get=function(){return this._fontWeight},Ji.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},Ji.letterSpacing.get=function(){return this._letterSpacing},Ji.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},Ji.lineHeight.get=function(){return this._lineHeight},Ji.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},Ji.leading.get=function(){return this._leading},Ji.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},Ji.lineJoin.get=function(){return this._lineJoin},Ji.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},Ji.miterLimit.get=function(){return this._miterLimit},Ji.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},Ji.padding.get=function(){return this._padding},Ji.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},Ji.stroke.get=function(){return this._stroke},Ji.stroke.set=function(t){var e=getColor(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},Ji.strokeThickness.get=function(){return this._strokeThickness},Ji.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},Ji.textBaseline.get=function(){return this._textBaseline},Ji.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},Ji.trim.get=function(){return this._trim},Ji.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},Ji.whiteSpace.get=function(){return this._whiteSpace},Ji.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},Ji.wordWrap.get=function(){return this._wordWrap},Ji.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},Ji.wordWrapWidth.get=function(){return this._wordWrapWidth},Ji.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},Zi.prototype.toFontString=function toFontString(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Ki.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(Zi.prototype,Ji);var Qi=function TextMetrics(t,e,i,r,n,o,s,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=h};Qi.measureText=function measureText(t,e,i,r){void 0===r&&(r=Qi._canvas),i=null==i?e.wordWrap:i;var n=e.toFontString(),o=Qi.measureFont(n);0===o.fontSize&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);var s=r.getContext("2d");s.font=n;for(var a=(i?Qi.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),u=0,l=0;l<a.length;l++){var c=s.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;h[l]=c,u=Math.max(u,c)}var d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||o.fontSize+e.strokeThickness,f=Math.max(p,o.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new Qi(t,e,d,f,a,h,p+e.leading,u,o)},Qi.wordWrap=function wordWrap(t,e,i){void 0===i&&(i=Qi._canvas);for(var r=i.getContext("2d"),n=0,o="",s="",a={},h=e.letterSpacing,u=e.whiteSpace,l=Qi.collapseSpaces(u),c=Qi.collapseNewlines(u),d=!l,p=e.wordWrapWidth+h,f=Qi.tokenize(t),m=0;m<f.length;m++){var g=f[m];if(Qi.isNewline(g)){if(!c){s+=Qi.addLine(o),d=!l,o="",n=0;continue}g=" "}if(l){var y=Qi.isBreakingSpace(g),v=Qi.isBreakingSpace(o[o.length-1]);if(y&&v)continue}var _=Qi.getFromCache(g,h,a,r);if(_>p)if(""!==o&&(s+=Qi.addLine(o),o="",n=0),Qi.canBreakWords(g,e.breakWords))for(var x=g.split(""),b=0;b<x.length;b++){for(var T=x[b],S=1;x[b+S];){var w=x[b+S],E=T[T.length-1];if(Qi.canBreakChars(E,w,g,b,e.breakWords))break;T+=w,S++}b+=T.length-1;var A=Qi.getFromCache(T,h,a,r);A+n>p&&(s+=Qi.addLine(o),d=!1,o="",n=0),o+=T,n+=A}else{o.length>0&&(s+=Qi.addLine(o),o="",n=0);var C=m===f.length-1;s+=Qi.addLine(g,!C),d=!1,o="",n=0}else _+n>p&&(d=!1,s+=Qi.addLine(o),o="",n=0),(o.length>0||!Qi.isBreakingSpace(g)||d)&&(o+=g,n+=_)}return s+=Qi.addLine(o,!1)},Qi.addLine=function addLine(t,e){return void 0===e&&(e=!0),t=Qi.trimRight(t),t=e?t+"\n":t},Qi.getFromCache=function getFromCache(t,e,i,r){var n=i[t];if(void 0===n){var o=t.length*e;n=r.measureText(t).width+o,i[t]=n}return n},Qi.collapseSpaces=function collapseSpaces(t){return"normal"===t||"pre-line"===t},Qi.collapseNewlines=function collapseNewlines(t){return"normal"===t},Qi.trimRight=function trimRight(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var i=t[e];if(!Qi.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},Qi.isNewline=function isNewline(t){return"string"==typeof t&&Qi._newlines.indexOf(t.charCodeAt(0))>=0},Qi.isBreakingSpace=function isBreakingSpace(t){return"string"==typeof t&&Qi._breakingSpaces.indexOf(t.charCodeAt(0))>=0},Qi.tokenize=function tokenize(t){var e=[],i="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var n=t[r];Qi.isBreakingSpace(n)||Qi.isNewline(n)?(""!==i&&(e.push(i),i=""),e.push(n)):i+=n}return""!==i&&e.push(i),e},Qi.canBreakWords=function canBreakWords(t,e){return e},Qi.canBreakChars=function canBreakChars(t,e,i,r,n){return!0},Qi.measureFont=function measureFont(t){if(Qi._fonts[t])return Qi._fonts[t];var e={},i=Qi._canvas,r=Qi._context;r.font=t;var n=Qi.METRICS_STRING+Qi.BASELINE_SYMBOL,o=Math.ceil(r.measureText(n).width),s=Math.ceil(r.measureText(Qi.BASELINE_SYMBOL).width),a=2*s;s=s*Qi.BASELINE_MULTIPLIER|0,i.width=o,i.height=a,r.fillStyle="#f00",r.fillRect(0,0,o,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,s);var h=r.getImageData(0,0,o,a).data,u=h.length,l=4*o,c=0,d=0,p=!1;for(c=0;c<s;++c){for(var f=0;f<l;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=l}for(e.ascent=s-c,d=u-l,p=!1,c=a;c>s;--c){for(var m=0;m<l;m+=4)if(255!==h[d+m]){p=!0;break}if(p)break;d-=l}return e.descent=c-s,e.fontSize=e.ascent+e.descent,Qi._fonts[t]=e,e},Qi.clearMetrics=function clearMetrics(t){void 0===t&&(t=""),t?delete Qi._fonts[t]:Qi._fonts={}};var $i=document.createElement("canvas");$i.width=$i.height=10,Qi._canvas=$i,Qi._context=$i.getContext("2d"),Qi._fonts={},Qi.METRICS_STRING="|ÉqÅ",Qi.BASELINE_SYMBOL="M",Qi.BASELINE_MULTIPLIER=1.4,Qi._newlines=[10,13],Qi._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var tr={texture:!0,children:!1,baseTexture:!0},er=function(t){function Text(e,i,r){(r=r||document.createElement("canvas")).width=3,r.height=3;var n=Yt.from(r);n.orig=new rt,n.trim=new rt,t.call(this,n),this.canvas=r,this.context=this.canvas.getContext("2d"),this._resolution=a.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=i,this.localStyleID=-1}t&&(Text.__proto__=t),Text.prototype=Object.create(t&&t.prototype),Text.prototype.constructor=Text;var e={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return Text.prototype.updateText=function updateText(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,n=this.context,o=Qi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,a=o.height,h=o.lines,u=o.lineHeight,l=o.lineWidths,c=o.maxLineWidth,d=o.fontProperties;if(this.canvas.width=Math.ceil((Math.max(1,s)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.strokeStyle=e.stroke,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,e.dropShadow){var p=e.dropShadowColor,f=hex2rgb("number"==typeof p?p:string2hex(p));n.shadowColor="rgba("+255*f[0]+","+255*f[1]+","+255*f[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance}else n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;n.fillStyle=this._generateFillStyle(e,h);for(var m=0;m<h.length;m++)i=e.strokeThickness/2,r=e.strokeThickness/2+m*u+d.ascent,"right"===e.align?i+=c-l[m]:"center"===e.align&&(i+=(c-l[m])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[m],i+e.padding,r+e.padding,!0),e.fill&&this.drawLetterSpacing(h[m],i+e.padding,r+e.padding);this.updateTexture()}},Text.prototype.drawLetterSpacing=function drawLetterSpacing(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=0;a<s.length;++a){var h=s[a];r?this.context.strokeText(h,o,i):this.context.fillText(h,o,i),o+=this.context.measureText(h).width+n}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},Text.prototype.updateTexture=function updateTexture(){var t=this.canvas;if(this._style.trim){var e=trimCanvas(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,o=i.baseTexture;i.trim.width=i._frame.width=t.width/this._resolution,i.trim.height=i._frame.height=t.height/this._resolution,i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},Text.prototype.render=function render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.render.call(this,e)},Text.prototype._renderCanvas=function _renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},Text.prototype.getLocalBounds=function getLocalBounds(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},Text.prototype._calculateBounds=function _calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},Text.prototype._onStyleChange=function _onStyleChange(){this.dirty=!0},Text.prototype._generateFillStyle=function _generateFillStyle(t,e){if(!Array.isArray(t.fill))return t.fill;var i,r,n,o,s=this.canvas.width/this._resolution,a=this.canvas.height/this._resolution,h=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var l=h.length+1,c=1;c<l;++c)u.push(c/l);if(h.unshift(t.fill[0]),u.unshift(0),h.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===Vi){i=this.context.createLinearGradient(s/2,0,s/2,a),r=(h.length+1)*e.length,n=0;for(var d=0;d<e.length;d++){n+=1;for(var p=0;p<h.length;p++)o="number"==typeof u[p]?u[p]/e.length+d/e.length:n/r,i.addColorStop(o,h[p]),n++}}else{i=this.context.createLinearGradient(0,a/2,s,a/2),r=h.length+1,n=1;for(var f=0;f<h.length;f++)o="number"==typeof u[f]?u[f]:n/r,i.addColorStop(o,h[f]),n++}return i},Text.prototype.destroy=function destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},tr,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},e.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},e.width.set=function(t){this.updateText(!0);var e=sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},e.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},e.height.set=function(t){this.updateText(!0);var e=sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},e.style.get=function(){return this._style},e.style.set=function(t){t=t||{},this._style=t instanceof Zi?t:new Zi(t),this.localStyleID=-1,this.dirty=!0},e.text.get=function(){return this._text},e.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},e.resolution.get=function(){return this._resolution},e.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(Text.prototype,e),Text}(Wi);
/*!
 * @pixi/prepare - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
a.UPLOADS_PER_FRAME=4;var ir=function CountLimiter(t){this.maxItemsPerFrame=t,this.itemsLeft=0};ir.prototype.beginFrame=function beginFrame(){this.itemsLeft=this.maxItemsPerFrame},ir.prototype.allowedToUpload=function allowedToUpload(){return this.itemsLeft-- >0};var rr=function BasePrepare(t){var e=this;this.limiter=new ir(a.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)};function findMultipleBaseTextures(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof Yt){var n=t._textures[r].baseTexture;-1===e.indexOf(n)&&(e.push(n),i=!0)}return i}function findBaseTexture(t,e){return t instanceof Rt&&(-1===e.indexOf(t)&&e.push(t),!0)}function findTexture(t,e){if(t._texture&&t._texture instanceof Yt){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function drawText(t,e){return e instanceof er&&(e.updateText(!0),!0)}function calculateTextStyle(t,e){if(e instanceof Zi){var i=e.toFontString();return Qi.measureFont(i),!0}return!1}function findText(t,e){if(t instanceof er){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function findTextStyle(t,e){return t instanceof Zi&&(-1===e.indexOf(t)&&e.push(t),!0)}rr.prototype.upload=function upload(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,bt.system.addOnce(this.tick,this,_t))):e&&e()},rr.prototype.tick=function tick(){setTimeout(this.delayedTick,0)},rr.prototype.prepareItems=function prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)bt.system.addOnce(this.tick,this,_t);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var o=0,s=n.length;o<s;o++)n[o]()}},rr.prototype.registerFindHook=function registerFindHook(t){return t&&this.addHooks.push(t),this},rr.prototype.registerUploadHook=function registerUploadHook(t){return t&&this.uploadHooks.push(t),this},rr.prototype.add=function add(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof dt)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this},rr.prototype.destroy=function destroy(){this.ticking&&bt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var nr=function(t){function Prepare(e){t.call(this,e),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}return t&&(Prepare.__proto__=t),Prepare.prototype=Object.create(t&&t.prototype),Prepare.prototype.constructor=Prepare,Prepare}(rr);function uploadBaseTextures(t,e){return e instanceof Rt&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function uploadGraphics(t,e){return e instanceof Hi&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function findGraphics(t,e){return t instanceof Hi&&(e.push(t),!0)}var or=function TimeLimiter(t){this.maxMilliseconds=t,this.frameStart=0};or.prototype.beginFrame=function beginFrame(){this.frameStart=Date.now()},or.prototype.allowedToUpload=function allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds};
/*!
 * @pixi/app - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var sr=function Application(t){var e=this;t=Object.assign({forceCanvas:!1},t),this.renderer=function autoDetectRenderer(t){return ri.create(t)}(t),this.stage=new dt,Application._plugins.forEach(function(i){i.init.call(e,t)})},ar={view:{configurable:!0},screen:{configurable:!0}};sr.registerPlugin=function registerPlugin(t){sr._plugins.push(t)},sr.prototype.render=function render(){this.renderer.render(this.stage)},ar.view.get=function(){return this.renderer.view},ar.screen.get=function(){return this.renderer.screen},sr.prototype.destroy=function destroy(t){var e=this,i=sr._plugins.slice(0);i.reverse(),i.forEach(function(t){t.destroy.call(e)}),this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},Object.defineProperties(sr.prototype,ar),sr._plugins=[];var hr=function ResizePlugin(){};hr.init=function init(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function set(t){window.removeEventListener("resize",this.resize),this._resizeTo=t,t&&(window.addEventListener("resize",this.resize),this.resize())},get:function get(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},hr.destroy=function destroy(){this.resizeTo=null,this.resize=null},sr.registerPlugin(hr);var ur=i(4),lr=i.n(ur);
/*!
 * @pixi/loaders - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var cr=function parseURI(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},o=14;o--;)n[i.key[o]]=r[o]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n},dr=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function MiniSignalBinding(t,e,i){void 0===e&&(e=!1),_classCallCheck(this,MiniSignalBinding),this._fn=t,this._once=e,this._thisArg=i,this._next=this._prev=this._owner=null}return i(MiniSignalBinding,[{key:"detach",value:function detach(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),MiniSignalBinding}();function _addMiniSignalBinding(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var n=function(){function MiniSignal(){_classCallCheck(this,MiniSignal),this._head=this._tail=void 0}return i(MiniSignal,[{key:"handlers",value:function handlers(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function has(t){if(!(t instanceof r))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function dispatch(){var t=arguments,e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,t),e=e._next;return!0}},{key:"add",value:function add(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return _addMiniSignalBinding(this,new r(t,!1,e))}},{key:"once",value:function once(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return _addMiniSignalBinding(this,new r(t,!0,e))}},{key:"detach",value:function detach(t){if(!(t instanceof r))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function detachAll(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),MiniSignal}();n.MiniSignalBinding=r,e.default=n,t.exports=e.default});unwrapExports(dr);var pr=createCommonjsModule(function(t,e){e.__esModule=!0,e.Resource=void 0;var i=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}(),r=_interopRequireDefault(cr),n=_interopRequireDefault(dr);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var o=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),s=null;function _noop(){}var a=e.Resource=function(){function Resource(t,e,i){if(function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Resource),"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(Resource.STATUS_FLAGS.DATA_URL,0===e.indexOf("data:")),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=Resource.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=_noop,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new n.default,this.onProgress=new n.default,this.onComplete=new n.default,this.onAfterMiddleware=new n.default}return Resource.setExtensionLoadType=function setExtensionLoadType(t,e){setExtMap(Resource._loadTypeMap,t,e)},Resource.setExtensionXhrType=function setExtensionXhrType(t,e){setExtMap(Resource._xhrTypeMap,t,e)},Resource.prototype.complete=function complete(){this._clearEvents(),this._finish()},Resource.prototype.abort=function abort(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=Resource.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},Resource.prototype.load=function load(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(Resource.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE,this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO,this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO,this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:o&&this.crossOrigin?this._loadXdr():this._loadXhr()}},Resource.prototype._hasFlag=function _hasFlag(t){return 0!=(this._flags&t)},Resource.prototype._setFlag=function _setFlag(t,e){this._flags=e?this._flags|t:this._flags&~t},Resource.prototype._clearEvents=function _clearEvents(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},Resource.prototype._finish=function _finish(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(Resource.STATUS_FLAGS.COMPLETE,!0),this._setFlag(Resource.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},Resource.prototype._loadElement=function _loadElement(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},Resource.prototype._loadSourceElement=function _loadSourceElement(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},Resource.prototype._loadXhr=function _loadXhr(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=Resource.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},Resource.prototype._loadXdr=function _loadXdr(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},Resource.prototype._createSource=function _createSource(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},Resource.prototype._onError=function _onError(t){this.abort("Failed to load element using: "+t.target.nodeName)},Resource.prototype._onProgress=function _onProgress(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},Resource.prototype._onTimeout=function _onTimeout(){this.abort("Load timed out.")},Resource.prototype._xhrOnError=function _xhrOnError(){var t=this.xhr;this.abort(reqType(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},Resource.prototype._xhrOnTimeout=function _xhrOnTimeout(){var t=this.xhr;this.abort(reqType(t)+" Request timed out.")},Resource.prototype._xhrOnAbort=function _xhrOnAbort(){var t=this.xhr;this.abort(reqType(t)+" Request was aborted by the user.")},Resource.prototype._xhrOnLoad=function _xhrOnLoad(){var t=this.xhr,e="",i=void 0===t.status?200:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(e=t.responseText),0===i&&(e.length>0||t.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=Resource.TYPE.TEXT;else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=Resource.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{var n=document.createElement("div");n.innerHTML=e,this.data=n}this.type=Resource.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},Resource.prototype._determineCrossOrigin=function _determineCrossOrigin(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,s||(s=document.createElement("a")),s.href=t;var i=!(t=(0,r.default)(s.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},Resource.prototype._determineXhrType=function _determineXhrType(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT},Resource.prototype._determineLoadType=function _determineLoadType(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR},Resource.prototype._getExtension=function _getExtension(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),o=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},Resource.prototype._getMimeFromXhrType=function _getMimeFromXhrType(t){switch(t){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i(Resource,[{key:"isDataUrl",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]),Resource}();function setExtMap(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function reqType(t){return t.toString().replace("object ","")}a.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},a.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},a.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},a.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},a._loadTypeMap={gif:a.LOAD_TYPE.IMAGE,png:a.LOAD_TYPE.IMAGE,bmp:a.LOAD_TYPE.IMAGE,jpg:a.LOAD_TYPE.IMAGE,jpeg:a.LOAD_TYPE.IMAGE,tif:a.LOAD_TYPE.IMAGE,tiff:a.LOAD_TYPE.IMAGE,webp:a.LOAD_TYPE.IMAGE,tga:a.LOAD_TYPE.IMAGE,svg:a.LOAD_TYPE.IMAGE,"svg+xml":a.LOAD_TYPE.IMAGE,mp3:a.LOAD_TYPE.AUDIO,ogg:a.LOAD_TYPE.AUDIO,wav:a.LOAD_TYPE.AUDIO,mp4:a.LOAD_TYPE.VIDEO,webm:a.LOAD_TYPE.VIDEO},a._xhrTypeMap={xhtml:a.XHR_RESPONSE_TYPE.DOCUMENT,html:a.XHR_RESPONSE_TYPE.DOCUMENT,htm:a.XHR_RESPONSE_TYPE.DOCUMENT,xml:a.XHR_RESPONSE_TYPE.DOCUMENT,tmx:a.XHR_RESPONSE_TYPE.DOCUMENT,svg:a.XHR_RESPONSE_TYPE.DOCUMENT,tsx:a.XHR_RESPONSE_TYPE.DOCUMENT,gif:a.XHR_RESPONSE_TYPE.BLOB,png:a.XHR_RESPONSE_TYPE.BLOB,bmp:a.XHR_RESPONSE_TYPE.BLOB,jpg:a.XHR_RESPONSE_TYPE.BLOB,jpeg:a.XHR_RESPONSE_TYPE.BLOB,tif:a.XHR_RESPONSE_TYPE.BLOB,tiff:a.XHR_RESPONSE_TYPE.BLOB,webp:a.XHR_RESPONSE_TYPE.BLOB,tga:a.XHR_RESPONSE_TYPE.BLOB,json:a.XHR_RESPONSE_TYPE.JSON,text:a.XHR_RESPONSE_TYPE.TEXT,txt:a.XHR_RESPONSE_TYPE.TEXT,ttf:a.XHR_RESPONSE_TYPE.BUFFER,otf:a.XHR_RESPONSE_TYPE.BUFFER},a.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",t.exports.default=a});unwrapExports(pr);pr.Resource;var fr=createCommonjsModule(function(t,e){e.__esModule=!0,e.encodeBinary=encodeBinary;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(t){for(var e="",r=0;r<t.length;){for(var n=[0,0,0],o=[0,0,0,0],s=0;s<n.length;++s)r<t.length?n[s]=255&t.charCodeAt(r++):n[s]=0;switch(o[0]=n[0]>>2,o[1]=(3&n[0])<<4|n[1]>>4,o[2]=(15&n[1])<<2|n[2]>>6,o[3]=63&n[2],r-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var a=0;a<o.length;++a)e+=i.charAt(o[a])}return e}t.exports.default=encodeBinary});unwrapExports(fr);fr.encodeBinary;var mr=createCommonjsModule(function(t,e){e.__esModule=!0,e.blobMiddlewareFactory=function blobMiddlewareFactory(){return function blobMiddleware(t,e){if(t.data){if(t.xhr&&t.xhrType===pr.Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=i.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=pr.Resource.TYPE.IMAGE,void(t.data.onload=function(){i.revokeObjectURL(r),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+(0,fr.encodeBinary)(t.xhr.responseText),t.type=pr.Resource.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}};var i=window.URL||window.webkitURL});unwrapExports(mr);var gr=mr.blobMiddlewareFactory,yr=function TextureLoader(){};yr.use=function use(t,e){t.data&&t.type===ur.Resource.TYPE.IMAGE&&(t.texture=Yt.fromLoader(t.data,t.url,t.name)),e()};var vr=function(t){function Loader(e,i){var r=this;t.call(this,e,i),u.a.call(this);for(var n=0;n<Loader._plugins.length;++n){var o=Loader._plugins[n],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this.onStart.add(function(t){return r.emit("start",t)}),this.onProgress.add(function(t,e){return r.emit("progress",t,e)}),this.onError.add(function(t,e,i){return r.emit("error",t,e,i)}),this.onLoad.add(function(t,e){return r.emit("load",t,e)}),this.onComplete.add(function(t,e){return r.emit("complete",t,e)}),this._protected=!1}t&&(Loader.__proto__=t),Loader.prototype=Object.create(t&&t.prototype),Loader.prototype.constructor=Loader;var e={shared:{configurable:!0}};return Loader.prototype.destroy=function destroy(){this._protected||(this.removeAllListeners(),this.reset())},e.shared.get=function(){var t=Loader._shared;return t||((t=new Loader)._protected=!0,Loader._shared=t),t},Object.defineProperties(Loader,e),Loader}(lr.a);Object.assign(vr.prototype,u.a.prototype),vr._plugins=[],vr.registerPlugin=function registerPlugin(t){return vr._plugins.push(t),t.add&&t.add(),vr},vr.registerPlugin({use:gr()}),vr.registerPlugin(yr);var _r=function AppLoaderPlugin(){};_r.init=function init(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?vr.shared:new vr},_r.destroy=function destroy(){this.loader&&(this.loader.destroy(),this.loader=null)};var xr=ur.Resource,br=function ParticleBuffer(t,e,i){this.geometry=new te,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||x.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};
/*!
 * @pixi/particles - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */br.prototype.initBuffers=function initBuffers(){var t=this.geometry,e=0;this.indexBuffer=new Kt(createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];r.offset=e,e+=r.size,this.dynamicStride+=r.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Kt(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(var s=0;s<this.staticProperties.length;++s){var a=this.staticProperties[s];a.offset=o,o+=a.size,this.staticStride+=a.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new Kt(this.staticData,!0,!1);for(var u=0;u<this.dynamicProperties.length;++u){var l=this.dynamicProperties[u];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===x.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(var c=0;c<this.staticProperties.length;++c){var d=this.staticProperties[c];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===x.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},br.prototype.uploadDynamic=function uploadDynamic(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,n.type===x.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},br.prototype.uploadStatic=function uploadStatic(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r];n.uploadFunction(t,e,i,n.type===x.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},br.prototype.destroy=function destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var Tr="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",Sr="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",wr=function(t){function ParticleRenderer(e){t.call(this,e),this.shader=null,this.properties=null,this.tempMatrix=new W,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:x.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Oe.from(Tr,Sr,{})}return t&&(ParticleRenderer.__proto__=t),ParticleRenderer.prototype=Object.create(t&&t.prototype),ParticleRenderer.prototype.constructor=ParticleRenderer,ParticleRenderer.prototype.render=function render(t){var e=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer,o=e.length;if(0!==o){o>i&&!t.autoResize&&(o=i);var s=t._buffers;s||(s=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.renderer.state.setBlendMode(correctBlendMode(t.blendMode,a.premultiplyAlpha));var h=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.premultiplyAlpha),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var l=!1,c=0,d=0;c<o;c+=r,d+=1){var p=o-c;p>r&&(p=r),d>=s.length&&s.push(this._generateOneMoreBuffer(t));var f=s[d];f.uploadDynamic(e,c,p);var m=t._bufferUpdateIDs[d]||0;(l=l||f._updateID<m)&&(f._updateID=t._updateID,f.uploadStatic(e,c,p)),n.geometry.bind(f.geometry),h.drawElements(h.TRIANGLES,6*p,h.UNSIGNED_SHORT,0)}}},ParticleRenderer.prototype.generateBuffers=function generateBuffers(t){for(var e=[],i=t._maxSize,r=t._batchSize,n=t._properties,o=0;o<i;o+=r)e.push(new br(this.properties,n,r));return e},ParticleRenderer.prototype._generateOneMoreBuffer=function _generateOneMoreBuffer(t){var e=t._batchSize,i=t._properties;return new br(this.properties,i,e)},ParticleRenderer.prototype.uploadVertices=function uploadVertices(t,e,i,r,n,o){for(var s=0,a=0,h=0,u=0,l=0;l<i;++l){var c=t[e+l],d=c._texture,p=c.scale.x,f=c.scale.y,m=d.trim,g=d.orig;m?(s=(a=m.x-c.anchor.x*g.width)+m.width,h=(u=m.y-c.anchor.y*g.height)+m.height):(s=g.width*(1-c.anchor.x),a=g.width*-c.anchor.x,h=g.height*(1-c.anchor.y),u=g.height*-c.anchor.y),r[o]=a*p,r[o+1]=u*f,r[o+n]=s*p,r[o+n+1]=u*f,r[o+2*n]=s*p,r[o+2*n+1]=h*f,r[o+3*n]=a*p,r[o+3*n+1]=h*f,o+=4*n}},ParticleRenderer.prototype.uploadPosition=function uploadPosition(t,e,i,r,n,o){for(var s=0;s<i;s++){var a=t[e+s].position;r[o]=a.x,r[o+1]=a.y,r[o+n]=a.x,r[o+n+1]=a.y,r[o+2*n]=a.x,r[o+2*n+1]=a.y,r[o+3*n]=a.x,r[o+3*n+1]=a.y,o+=4*n}},ParticleRenderer.prototype.uploadRotation=function uploadRotation(t,e,i,r,n,o){for(var s=0;s<i;s++){var a=t[e+s].rotation;r[o]=a,r[o+n]=a,r[o+2*n]=a,r[o+3*n]=a,o+=4*n}},ParticleRenderer.prototype.uploadUvs=function uploadUvs(t,e,i,r,n,o){for(var s=0;s<i;++s){var a=t[e+s]._texture._uvs;a?(r[o]=a.x0,r[o+1]=a.y0,r[o+n]=a.x1,r[o+n+1]=a.y1,r[o+2*n]=a.x2,r[o+2*n+1]=a.y2,r[o+3*n]=a.x3,r[o+3*n+1]=a.y3,o+=4*n):(r[o]=0,r[o+1]=0,r[o+n]=0,r[o+n+1]=0,r[o+2*n]=0,r[o+2*n+1]=0,r[o+3*n]=0,r[o+3*n+1]=0,o+=4*n)}},ParticleRenderer.prototype.uploadTint=function uploadTint(t,e,i,r,n,o){for(var s=0;s<i;++s){var a=t[e+s],h=a._texture.baseTexture.premultiplyAlpha,u=a.alpha,l=u<1&&h?premultiplyTint(a._tintRGB,u):a._tintRGB+(255*u<<24);r[o]=l,r[o+n]=l,r[o+2*n]=l,r[o+3*n]=l,o+=4*n}},ParticleRenderer.prototype.destroy=function destroy(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},ParticleRenderer}(ae),Er=function Spritesheet(t,e,i){void 0===i&&(i=null),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(i||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},Ar={BATCH_SIZE:{configurable:!0}};Ar.BATCH_SIZE.get=function(){return 1e3},Er.prototype._updateResolution=function _updateResolution(t){var e=this.data.meta.scale,i=getResolutionOfUrl(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&this.baseTexture.setResolution(i),i},Er.prototype.parse=function parse(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=Er.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},Er.prototype._processFrames=function _processFrames(t){for(var e=t,i=Er.BATCH_SIZE;e-t<i&&e<this._frameKeys.length;){var r=this._frameKeys[e],n=this._frames[r],o=n.frame;if(o){var s=null,a=null,h=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,u=new rt(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);s=n.rotated?new rt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new rt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(a=new rt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Yt(this.baseTexture,s,u,a,n.rotated?2:0,n.anchor),Yt.addToCache(this.textures[r],r)}e++}},Er.prototype._processAnimations=function _processAnimations(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var i=0;i<t[e].length;i++){var r=t[e][i];this.animations[e].push(this.textures[r])}}},Er.prototype._parseComplete=function _parseComplete(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},Er.prototype._nextBatch=function _nextBatch(){var t=this;this._processFrames(this._batchIndex*Er.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*Er.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},Er.prototype.destroy=function destroy(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(Er,Ar);var Cr=function SpritesheetLoader(){};Cr.use=function use(t,e){var i=t.name+"_image";if(t.data&&t.type===xr.TYPE.JSON&&t.data.frames&&!this.resources[i]){var r={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},n=Cr.getResourcePath(t,this.baseUrl);this.add(i,n,r,function onImageLoad(i){if(i.error)e(i.error);else{var r=new Er(i.texture.baseTexture,t.data,t.url);r.parse(function(){t.spritesheet=r,t.textures=r.textures,e()})}})}else e()},Cr.getResourcePath=function getResourcePath(t,e){return t.isDataUrl?t.data.meta.image:p.a.resolve(t.url.replace(e,""),t.data.meta.image)};
/*!
 * @pixi/sprite-tiling - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
new N;var Or="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",Pr="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n",Ir="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",Mr=new W,Rr=function(t){function TilingSpriteRenderer(e){t.call(this,e);var i={globals:this.renderer.globalUniforms};this.shader=Oe.from(Or,Pr,i),this.simpleShader=Oe.from(Or,Ir,i),this.quad=new ie}return t&&(TilingSpriteRenderer.__proto__=t),TilingSpriteRenderer.prototype=Object.create(t&&t.prototype),TilingSpriteRenderer.prototype.constructor=TilingSpriteRenderer,TilingSpriteRenderer.prototype.render=function render(t){var e=this.renderer,i=this.quad,r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=i.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),i.invalidate();var n=t._texture,o=n.baseTexture,s=t.tileTransform.localTransform,a=t.uvMatrix,h=o.isPowerOfTwo&&n.frame.width===o.width&&n.frame.height===o.height;h&&(o._glTextures[e.CONTEXT_UID]?h=o.wrapMode!==b:o.wrapMode===b&&(o.wrapMode=T));var u=h?this.simpleShader:this.shader,l=n.width,c=n.height,d=t._width,p=t._height;Mr.set(s.a*l/d,s.b*l/p,s.c*c/d,s.d*c/p,s.tx/d,s.ty/p),Mr.invert(),h?Mr.prepend(a.mapCoord):(u.uniforms.uMapCoord=a.mapCoord.toArray(!0),u.uniforms.uClampFrame=a.uClampFrame,u.uniforms.uClampOffset=a.uClampOffset),u.uniforms.uTransform=Mr.toArray(!0),u.uniforms.uColor=premultiplyTintToRgba(t.tint,t.worldAlpha,u.uniforms.uColor,o.premultiplyAlpha),u.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),u.uniforms.uSampler=n,e.shader.bind(u),e.geometry.bind(i),e.state.setBlendMode(correctBlendMode(t.blendMode,o.premultiplyAlpha)),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},TilingSpriteRenderer}(ae),Dr=function(t){function BitmapText(e,i){var r=this;void 0===i&&(i={}),t.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==i.tint?i.tint:16777215,align:i.align||"left",name:null,size:0},this.font=i.font,this._text=e,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new G(function(){r.dirty=!0},this,0,0),this.dirty=!1,this.roundPixels=a.ROUND_PIXELS,this.updateText()}t&&(BitmapText.__proto__=t),BitmapText.prototype=Object.create(t&&t.prototype),BitmapText.prototype.constructor=BitmapText;var e={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return BitmapText.prototype.updateText=function updateText(){for(var t=BitmapText.fonts[this._font.name],e=this._font.size/t.size,i=new N,r=[],n=[],o=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",s=o.length,a=this._maxWidth*t.size/this._font.size,h=null,u=0,l=0,c=0,d=-1,p=0,f=0,m=0,g=0;g<s;g++){var y=o.charCodeAt(g),v=o.charAt(g);if(/(?:\s)/.test(v)&&(d=g,p=u),"\r"!==v&&"\n"!==v){var _=t.chars[y];_&&(h&&_.kerning[h]&&(i.x+=_.kerning[h]),r.push({texture:_.texture,line:c,charCode:y,position:new N(i.x+_.xOffset+this._letterSpacing/2,i.y+_.yOffset)}),i.x+=_.xAdvance+this._letterSpacing,u=i.x,m=Math.max(m,_.yOffset+_.texture.height),h=y,-1!==d&&a>0&&i.x>a&&(removeItems(r,1+d-++f,1+g-d),g=d,d=-1,n.push(p),l=Math.max(l,p),c++,i.x=0,i.y+=t.lineHeight,h=null))}else n.push(u),l=Math.max(l,u),++c,++f,i.x=0,i.y+=t.lineHeight,h=null}var x=o.charAt(o.length-1);"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(u=p),n.push(u),l=Math.max(l,u));for(var b=[],T=0;T<=c;T++){var S=0;"right"===this._font.align?S=l-n[T]:"center"===this._font.align&&(S=(l-n[T])/2),b.push(S)}for(var w=r.length,E=this.tint,A=0;A<w;A++){var C=this._glyphs[A];C?C.texture=r[A].texture:((C=new Wi(r[A].texture)).roundPixels=this.roundPixels,this._glyphs.push(C)),C.position.x=(r[A].position.x+b[r[A].line])*e,C.position.y=r[A].position.y*e,C.scale.x=C.scale.y=e,C.tint=E,C.parent||this.addChild(C)}for(var O=w;O<this._glyphs.length;++O)this.removeChild(this._glyphs[O]);if(this._textWidth=l*e,this._textHeight=(i.y+t.lineHeight)*e,0!==this.anchor.x||0!==this.anchor.y)for(var P=0;P<w;P++)this._glyphs[P].x-=this._textWidth*this.anchor.x,this._glyphs[P].y-=this._textHeight*this.anchor.y;this._maxLineHeight=m*e},BitmapText.prototype.updateTransform=function updateTransform(){this.validate(),this.containerUpdateTransform()},BitmapText.prototype.getLocalBounds=function getLocalBounds(){return this.validate(),t.prototype.getLocalBounds.call(this)},BitmapText.prototype.validate=function validate(){this.dirty&&(this.updateText(),this.dirty=!1)},e.tint.get=function(){return this._font.tint},e.tint.set=function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0},e.align.get=function(){return this._font.align},e.align.set=function(t){this._font.align=t||"left",this.dirty=!0},e.anchor.get=function(){return this._anchor},e.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},e.font.get=function(){return this._font},e.font.set=function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):BitmapText.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)},e.text.get=function(){return this._text},e.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},e.maxWidth.get=function(){return this._maxWidth},e.maxWidth.set=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},e.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},e.textWidth.get=function(){return this.validate(),this._textWidth},e.letterSpacing.get=function(){return this._letterSpacing},e.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},e.textHeight.get=function(){return this.validate(),this._textHeight},BitmapText.registerFont=function registerFont(t,e){var i={},r=t.getElementsByTagName("info")[0],n=t.getElementsByTagName("common")[0],o=t.getElementsByTagName("page"),s=getResolutionOfUrl(o[0].getAttribute("file"),a.RESOLUTION),h={};i.font=r.getAttribute("face"),i.size=parseInt(r.getAttribute("size"),10),i.lineHeight=parseInt(n.getAttribute("lineHeight"),10)/s,i.chars={},e instanceof Yt&&(e=[e]);for(var u=0;u<o.length;u++){var l=o[u].getAttribute("id"),c=o[u].getAttribute("file");h[l]=e instanceof Array?e[u]:e[c]}for(var d=t.getElementsByTagName("char"),p=0;p<d.length;p++){var f=d[p],m=parseInt(f.getAttribute("id"),10),g=f.getAttribute("page")||0,y=new rt(parseInt(f.getAttribute("x"),10)/s+h[g].frame.x/s,parseInt(f.getAttribute("y"),10)/s+h[g].frame.y/s,parseInt(f.getAttribute("width"),10)/s,parseInt(f.getAttribute("height"),10)/s);i.chars[m]={xOffset:parseInt(f.getAttribute("xoffset"),10)/s,yOffset:parseInt(f.getAttribute("yoffset"),10)/s,xAdvance:parseInt(f.getAttribute("xadvance"),10)/s,kerning:{},texture:new Yt(h[g].baseTexture,y),page:g}}for(var v=t.getElementsByTagName("kerning"),_=0;_<v.length;_++){var x=v[_],b=parseInt(x.getAttribute("first"),10)/s,T=parseInt(x.getAttribute("second"),10)/s,S=parseInt(x.getAttribute("amount"),10)/s;i.chars[T]&&(i.chars[T].kerning[b]=S)}return BitmapText.fonts[i.font]=i,i},Object.defineProperties(BitmapText.prototype,e),BitmapText}(dt);Dr.fonts={};var Fr=function BitmapFontLoader(){};Fr.parse=function parse(t,e){t.bitmapFont=Dr.registerFont(t.data,e)},Fr.add=function add(){xr.setExtensionXhrType("fnt",xr.XHR_RESPONSE_TYPE.DOCUMENT)},Fr.dirname=function dirname(t){var e=t.replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},Fr.use=function use(t,e){if(t.data&&t.type===xr.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var i=t.isDataUrl?"":Fr.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/")),(i=i.replace(this.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/");for(var r=t.data.getElementsByTagName("page"),n={},o=function(i){n[i.metadata.pageFile]=i.texture,Object.keys(n).length===r.length&&(Fr.parse(t,n),e())},s=0;s<r.length;++s){var a=r[s].getAttribute("file"),h=i+a,u=!1;for(var l in this.resources){var c=this.resources[l];if(c.url===h){c.metadata.pageFile=a,c.texture?o(c):c.onAfterMiddleware.add(o),u=!0;break}}if(!u){var d={crossOrigin:t.crossOrigin,loadType:xr.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},t.metadata.imageMetadata),parentResource:t};this.add(h,d,o)}}}else e();else e()};
/*!
 * @pixi/filter-alpha - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Br="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",Lr=function(t){function AlphaFilter(e){void 0===e&&(e=1),t.call(this,ni,Br,{uAlpha:1}),this.alpha=e}t&&(AlphaFilter.__proto__=t),AlphaFilter.prototype=Object.create(t&&t.prototype),AlphaFilter.prototype.constructor=AlphaFilter;var e={alpha:{configurable:!0}};return e.alpha.get=function(){return this.uniforms.uAlpha},e.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(AlphaFilter.prototype,e),AlphaFilter}(Re),kr="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n    \n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n    \n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n    \n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";var Ur={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Nr=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var Gr=function(t){function BlurFilterPass(e,i,r,n,o){var s=function generateBlurVertSource(t,e){var i,r=Math.ceil(t/2),n=kr,o="";i=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=i.replace("%index%",s);o+=a=a.replace("%sampleIndex%",s-(r-1)+".0"),o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t)}(o=o||5,e),h=function generateBlurFragSource(t){for(var e,i=Ur[t],r=i.length,n=Nr,o="",s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s);e=s,s>=r&&(e=t-s-1),o+=a=a.replace("%value%",i[e]),o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t)}(o);t.call(this,s,h),this.horizontal=e,this.resolution=n||a.RESOLUTION,this._quality=0,this.quality=r||4,this.blur=i||8}t&&(BlurFilterPass.__proto__=t),BlurFilterPass.prototype=Object.create(t&&t.prototype),BlurFilterPass.prototype.constructor=BlurFilterPass;var e={blur:{configurable:!0},quality:{configurable:!0}};return BlurFilterPass.prototype.apply=function apply(t,e,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{var n=t.getFilterTexture(),o=t.renderer,s=e,a=n;this.state.blend=!1,t.applyFilter(this,s,a,!1);for(var h=1;h<this.passes-1;h++){o.renderTexture.bind(s,s.filterFrame),this.uniforms.uSampler=a;var u=a;a=s,s=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,i,r),t.returnFilterTexture(n)}},e.blur.get=function(){return this.strength},e.blur.set=function(t){this.padding=1+2*Math.abs(t),this.strength=t},e.quality.get=function(){return this._quality},e.quality.set=function(t){this._quality=t,this.passes=t},Object.defineProperties(BlurFilterPass.prototype,e),BlurFilterPass}(Re),jr=function(t){function BlurFilter(e,i,r,n){t.call(this),this.blurXFilter=new Gr(!0,e,i,r,n),this.blurYFilter=new Gr(!1,e,i,r,n),this.resolution=r||a.RESOLUTION,this.quality=i||4,this.blur=e||8,this.repeatEdgePixels=!1}t&&(BlurFilter.__proto__=t),BlurFilter.prototype=Object.create(t&&t.prototype),BlurFilter.prototype.constructor=BlurFilter;var e={blur:{configurable:!0},quality:{configurable:!0},blurX:{configurable:!0},blurY:{configurable:!0},blendMode:{configurable:!0},repeatEdgePixels:{configurable:!0}};return BlurFilter.prototype.apply=function apply(t,e,i,r){var n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){var s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,!0),this.blurYFilter.apply(t,s,i,r),t.returnFilterTexture(s)}else o?this.blurYFilter.apply(t,e,i,r):this.blurXFilter.apply(t,e,i,r)},BlurFilter.prototype.updatePadding=function updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},e.blur.get=function(){return this.blurXFilter.blur},e.blur.set=function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},e.quality.get=function(){return this.blurXFilter.quality},e.quality.set=function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},e.blurX.get=function(){return this.blurXFilter.blur},e.blurX.set=function(t){this.blurXFilter.blur=t,this.updatePadding()},e.blurY.get=function(){return this.blurYFilter.blur},e.blurY.set=function(t){this.blurYFilter.blur=t,this.updatePadding()},e.blendMode.get=function(){return this.blurYFilter.blendMode},e.blendMode.set=function(t){this.blurYFilter.blendMode=t},e.repeatEdgePixels.get=function(){return this._repeatEdgePixels},e.repeatEdgePixels.set=function(t){this._repeatEdgePixels=t,this.updatePadding()},Object.defineProperties(BlurFilter.prototype,e),BlurFilter}(Re),Xr="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",Hr=function(t){function ColorMatrixFilter(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};t.call(this,oi,Xr,e),this.alpha=1}t&&(ColorMatrixFilter.__proto__=t),ColorMatrixFilter.prototype=Object.create(t&&t.prototype),ColorMatrixFilter.prototype.constructor=ColorMatrixFilter;var e={matrix:{configurable:!0},alpha:{configurable:!0}};return ColorMatrixFilter.prototype._loadMatrix=function _loadMatrix(t,e){void 0===e&&(e=!1);var i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},ColorMatrixFilter.prototype._multiply=function _multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},ColorMatrixFilter.prototype._colorMatrix=function _colorMatrix(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},ColorMatrixFilter.prototype.brightness=function brightness(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},ColorMatrixFilter.prototype.greyscale=function greyscale(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},ColorMatrixFilter.prototype.blackAndWhite=function blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.hue=function hue(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=1/3,o=(0,Math.sqrt)(n),s=[i+(1-i)*n,n*(1-i)-o*r,n*(1-i)+o*r,0,0,n*(1-i)+o*r,i+n*(1-i),n*(1-i)-o*r,0,0,n*(1-i)-o*r,n*(1-i)+o*r,i+n*(1-i),0,0,0,0,0,1,0];this._loadMatrix(s,e)},ColorMatrixFilter.prototype.contrast=function contrast(t,e){var i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)},ColorMatrixFilter.prototype.saturate=function saturate(t,e){void 0===t&&(t=0);var i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},ColorMatrixFilter.prototype.desaturate=function desaturate(){this.saturate(-1)},ColorMatrixFilter.prototype.negative=function negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.sepia=function sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.technicolor=function technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},ColorMatrixFilter.prototype.polaroid=function polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.toBGR=function toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.kodachrome=function kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},ColorMatrixFilter.prototype.browni=function browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},ColorMatrixFilter.prototype.vintage=function vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},ColorMatrixFilter.prototype.colorTone=function colorTone(t,e,i,r,n){var o=((i=i||16770432)>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,h=((r=r||3375104)>>16&255)/255,u=(r>>8&255)/255,l=(255&r)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,h,u,l,e=e||.15,0,o-h,s-u,a-l,0,0];this._loadMatrix(c,n)},ColorMatrixFilter.prototype.night=function night(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},ColorMatrixFilter.prototype.predator=function predator(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},ColorMatrixFilter.prototype.lsd=function lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},ColorMatrixFilter.prototype.reset=function reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},e.matrix.get=function(){return this.uniforms.m},e.matrix.set=function(t){this.uniforms.m=t},e.alpha.get=function(){return this.uniforms.uAlpha},e.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(ColorMatrixFilter.prototype,e),ColorMatrixFilter}(Re);Hr.prototype.grayscale=Hr.prototype.greyscale;
/*!
 * @pixi/filter-displacement - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var zr="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n",Yr="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",Wr=function(t){function DisplacementFilter(e,i){var r=new W;e.renderable=!1,t.call(this,zr,Yr,{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==i&&(i=20),this.scale=new N(i,i)}t&&(DisplacementFilter.__proto__=t),DisplacementFilter.prototype=Object.create(t&&t.prototype),DisplacementFilter.prototype.constructor=DisplacementFilter;var e={map:{configurable:!0}};return DisplacementFilter.prototype.apply=function apply(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.transform.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),s=Math.sqrt(n.c*n.c+n.d*n.d);0!==o&&0!==s&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/s,this.uniforms.rotation[3]=n.d/s),t.applyFilter(this,e,i,r)},e.map.get=function(){return this.uniforms.mapSampler},e.map.set=function(t){this.uniforms.mapSampler=t},Object.defineProperties(DisplacementFilter.prototype,e),DisplacementFilter}(Re),Vr="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",qr='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n',Kr=function(t){function FXAAFilter(){t.call(this,Vr,qr)}return t&&(FXAAFilter.__proto__=t),FXAAFilter.prototype=Object.create(t&&t.prototype),FXAAFilter.prototype.constructor=FXAAFilter,FXAAFilter}(Re),Zr="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",Jr=function(t){function NoiseFilter(e,i){void 0===e&&(e=.5),void 0===i&&(i=Math.random()),t.call(this,oi,Zr,{uNoise:0,uSeed:0}),this.noise=e,this.seed=i}t&&(NoiseFilter.__proto__=t),NoiseFilter.prototype=Object.create(t&&t.prototype),NoiseFilter.prototype.constructor=NoiseFilter;var e={noise:{configurable:!0},seed:{configurable:!0}};return e.noise.get=function(){return this.uniforms.uNoise},e.noise.set=function(t){this.uniforms.uNoise=t},e.seed.get=function(){return this.uniforms.uSeed},e.seed.set=function(t){this.uniforms.uSeed=t},Object.defineProperties(NoiseFilter.prototype,e),NoiseFilter}(Re),Qr=new W;ct.prototype._cacheAsBitmap=!1,ct.prototype._cacheData=!1;var $r=function CacheData(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(ct.prototype,{cacheAsBitmap:{get:function get(){return this._cacheAsBitmap},set:function set(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new $r),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),ct.prototype._renderCached=function _renderCached(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},ct.prototype._initCachedDisplayObject=function _initCachedDisplayObject(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds().clone();if(this.filters){var r=this.filters[0].padding;i.pad(r)}i.ceil(a.RESOLUTION);var n=t._activeRenderTarget,o=Wt.create(i.width,i.height),s="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=s,Rt.addToCache(o.baseTexture,s),Yt.addToCache(o,s);var h=Qr;h.tx=-i.x,h.ty=-i.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,t.render(this,o,!0,h,!0),t.renderTexture.bind(n),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new Wi(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-i.x/i.width,u.anchor.y=-i.y/i.height,u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}},ct.prototype._renderCachedCanvas=function _renderCachedCanvas(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},ct.prototype._initCachedDisplayObjectCanvas=function _initCachedDisplayObjectCanvas(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var r=t.context;e.ceil(a.RESOLUTION);var n=Wt.create(e.width,e.height),o="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=o,Rt.addToCache(n.baseTexture,o),Yt.addToCache(n,o);var s=Qr;this.transform.localTransform.copyTo(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,n,!0,s,!1),t.context=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new Wi(n);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=i,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},ct.prototype._calculateCachedBounds=function _calculateCachedBounds(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},ct.prototype._getCachedLocalBounds=function _getCachedLocalBounds(){return this._cacheData.sprite.getLocalBounds()},ct.prototype._destroyCachedDisplayObject=function _destroyCachedDisplayObject(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Rt.removeFromCache(this._cacheData.textureCacheId),Yt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ct.prototype._cacheAsBitmapDestroy=function _cacheAsBitmapDestroy(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
 * @pixi/mixin-get-child-by-name - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
ct.prototype.name=null,dt.prototype.getChildByName=function getChildByName(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},
/*!
 * @pixi/mixin-get-global-position - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
ct.prototype.getGlobalPosition=function getGlobalPosition(t,e){return void 0===t&&(t=new N),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
 * @pixi/mesh - v5.0.4
 * Compiled Fri, 07 Jun 2019 17:17:49 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var tn=function MeshBatchUvs(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};tn.prototype.update=function update(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var en=new N,rn=new ht,nn=function(t){function Mesh(e,i,r,n){void 0===n&&(n=y.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=i,this.state=r||Ie.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=g.NORMAL,this._roundPixels=a.ROUND_PIXELS,this.batchUvs=null}t&&(Mesh.__proto__=t),Mesh.prototype=Object.create(t&&t.prototype),Mesh.prototype.constructor=Mesh;var e={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.uvBuffer.get=function(){return this.geometry.buffers[1]},e.verticesBuffer.get=function(){return this.geometry.buffers[0]},e.material.set=function(t){this.shader=t},e.material.get=function(){return this.shader},e.blendMode.set=function(t){this.state.blendMode=t},e.blendMode.get=function(){return this.state.blendMode},e.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},e.roundPixels.get=function(){return this._roundPixels},e.tint.get=function(){return this.shader.tint},e.tint.set=function(t){this.shader.tint=t},e.texture.get=function(){return this.shader.texture},e.texture.set=function(t){this.shader.texture=t},Mesh.prototype._render=function _render(t){var e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===y.TRIANGLES&&e.length<2*Mesh.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},Mesh.prototype._renderDefault=function _renderDefault(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.setState(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},Mesh.prototype._renderToBatch=function _renderToBatch(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},Mesh.prototype.calculateVertices=function calculateVertices(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,n=i.b,o=i.c,s=i.d,a=i.tx,h=i.ty,u=this.vertexData,l=0;l<u.length/2;l++){var c=e[2*l],d=e[2*l+1];u[2*l]=r*c+o*d+a,u[2*l+1]=n*c+s*d+h}if(this._roundPixels)for(var p=0;p<u.length;p++)u[p]=Math.round(u[p]);this.vertexDirty=t.vertexDirtyId}},Mesh.prototype.calculateUvs=function calculateUvs(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new tn(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},Mesh.prototype._calculateBounds=function _calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},Mesh.prototype.containsPoint=function containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,en);for(var e=this.geometry.getBuffer("aVertexPosition").data,i=rn.points,r=this.geometry.getIndex().data,n=r.length,o=4===this.drawMode?3:1,s=0;s+2<n;s+=o){var a=2*r[s],h=2*r[s+1],u=2*r[s+2];if(i[0]=e[a],i[1]=e[a+1],i[2]=e[h],i[3]=e[h+1],i[4]=e[u],i[5]=e[u+1],rn.contains(en.x,en.y))return!0}return!1},Mesh.prototype.destroy=function destroy(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(Mesh.prototype,e),Mesh}(dt);nn.BATCHABLE_SIZE=100;ri.registerPlugin("accessibility",pt),ri.registerPlugin("extract",mi),ri.registerPlugin("interaction",wi),ri.registerPlugin("particle",wr),ri.registerPlugin("prepare",nr),ri.registerPlugin("batch",pi),ri.registerPlugin("tilingSprite",Rr),vr.registerPlugin(Fr),vr.registerPlugin(Cr),sr.registerPlugin(wt),sr.registerPlugin(_r);var on={AlphaFilter:Lr,BlurFilter:jr,BlurFilterPass:Gr,ColorMatrixFilter:Hr,DisplacementFilter:Wr,FXAAFilter:Kr,NoiseFilter:Jr},sn=Object.freeze({ResourceBaseUrl:"assets/",MaxUnitSlotCount:5});(void 0).baseUrl=sn.ResourceBaseUrl;var an,hn=sn,un=Object.freeze({Api:{UserBattle:function(t){return"api_mock/user_battle.json"+("?userId="+t)},SceneUiGraph:function(t){return"ui_graph/"+t.constructor.name.replace(/([A-Z])/g,function(t){return"_"+t.charAt(0).toLowerCase()}).replace(/^_/,"")+".json"},Stage:function(t){return"master/stage_master_"+t+".json"},Unit:function(t){return"master/unit_master.json?unitId[]="+t.join("&unitId[]=")},AllUnit:function(){return"master/unit_master.json"},UnitAnimation:function(t){return"master/unit_animation_master.json?unitId[]="+t.join("&unitId[]=")},Castle:function(t){return"master/castle_master.json?castleId[]="+t.join("&castleId[]=")}},Dynamic:{Unit:function(t){return"units/"+t+".json"},UnitPanel:function(t){return"ui/units_panel/button/unit_"+(t>0?t:"empty")+".png"},Castle:function(t){return"battle/castle/"+t+".json"}},Static:{BattleBgFores:["battle/bg_1_1.png","battle/bg_1_2.png","battle/bg_1_3.png","battle/bg_1_4.png","battle/bg_1_5.png","battle/bg_1_6.png","battle/bg_1_7.png","battle/bg_1_8.png","battle/bg_1_9.png","battle/bg_1_10.png"],BattleBgMiddles:["battle/bg_2_1.png","battle/bg_2_2.png","battle/bg_2_3.png","battle/bg_2_4.png","battle/bg_2_5.png","battle/bg_2_6.png"],BattleBgBacks:["battle/bg_3_1.png","battle/bg_3_2.png","battle/bg_3_3.png"],AttackSmoke:"battle/effects/attack_smoke/attack_smoke.json",DeadBucket:"battle/effects/dead/dead_bucket.png",DeadSpirit:"battle/effects/dead/dead_spirit.png",CollapseExplode:"battle/effects/collapse_explode/collapse_explode.json",BattleResultWin:"ui/battle_win.png",BattleResultLose:"ui/battle_lose.png"},Audio:{Bgm:{Title:"audio/bgm_title.mp3",Battle:"audio/bgm_battle.mp3"},Se:{Attack1:"audio/se_attack_1.mp3",Attack2:"audio/se_attack_2.mp3",Bomb:"audio/se_bomb.mp3",UnitSpawn:"audio/se_unit_spawn.mp3",Win:"audio/se_win.mp3",Lose:"audio/se_lose.mp3"}},TextureFrame:{Unit:function(t,e,i){var n="unit_"+e+"_"+t+"_"+i+".png";return r.TextureCache[n]},Castle:function(t,e){return void 0===e&&(e=1),r.TextureCache["base_"+t+"_"+e+".png"]},CollapseExplode:function(t){return void 0===t&&(t=1),r.TextureCache["effect_1_"+t+".png"]},AttackSmoke:function(t){return void 0===t&&(t=1),r.TextureCache["effect_2_"+t+".png"]}},AnimationTypes:{Unit:Object.freeze({WAIT:"wait",WALK:"walk",ATTACK:"attack",DAMAGE:"damage"}),Castle:Object.freeze({IDLE:"idle",SPAWN:"spawn",COLLAPSE:"collapse"})},FontFamily:{Css:"base.css",Default:"MisakiGothic"},MaxFrameIndex:function(t){var e=(void 0).resources[t];return e&&e.data&&e.data.frames?Object.keys(e.data.frames).length:-1}}),ln=i(3),cn=window.indexedDB||window.webkitIndexedDB,dn=function(){function IndexedDBManager(){}return IndexedDBManager.init=function(t){cn||console.log("indexed db is not supported");var e=cn.open(IndexedDBManager.dbName,IndexedDBManager.dbVersion);e.onupgradeneeded=function(t){IndexedDBManager.upgradeDB(t)},e.onsuccess=function(t){var e=t.target.result;IndexedDBManager.db=e},e.onerror=function(e){return t(e)}},IndexedDBManager.put=function(t,e,i,r){var n=IndexedDBManager.getStoreObject();if(n){var o=IndexedDBManager.createRecordObject(t,e),s=n.put(o);i&&(s.onsuccess=function(t){i(t)}),r&&(s.onerror=function(t){r(t)})}else r&&r()},IndexedDBManager.get=function(t,e,i){var r=IndexedDBManager.getStoreObject();if(r){var n=r.get(t);n.onsuccess=function(t){var i=t.target.result;i?e(i.value,i.key):e(void 0,void 0)},i&&(n.onerror=function(t){i(t)})}else i&&i()},IndexedDBManager.delete=function(t,e,i){var r=IndexedDBManager.getStoreObject();if(r){var n=r.delete(t);e&&(n.onsuccess=function(t){e(t)}),i&&(n.onerror=function(t){i(t)})}else i&&i()},IndexedDBManager.clear=function(t,e){var i=IndexedDBManager.getStoreObject();if(i){var r=i.clear();t&&(r.onsuccess=function(e){t(e)}),e&&(r.onerror=function(t){e(t)})}else e&&e()},IndexedDBManager.upgradeDB=function(t){var e=t.target.result,i=IndexedDBManager.storeIndex,r=IndexedDBManager.storeName;e.createObjectStore(r,{keyPath:i}).createIndex(i,i,{unique:!0})},IndexedDBManager.getStoreObject=function(){if(!IndexedDBManager.db)return null;var t=IndexedDBManager.storeName;return IndexedDBManager.db.transaction(t,"readwrite").objectStore(t)},IndexedDBManager.createRecordObject=function(t,e){return{key:t,value:e}},IndexedDBManager.dbName="sample-game-db",IndexedDBManager.dbVersion=1,IndexedDBManager.storeName="sample-game-store",IndexedDBManager.storeIndex="key",IndexedDBManager.db=null,IndexedDBManager}(),pn=function(){function Sound(t){this.loop=!1,this.source=null,this.played=!1,this.paused=!1,this.offset=0,this.playedAt=0,fn.sharedContext&&(this.buffer=t,this.gainNode=fn.sharedContext.createGain())}return Object.defineProperty(Sound.prototype,"volume",{get:function(){return this.gainNode?this.gainNode.gain.value:-1},set:function(t){this.gainNode&&(this.gainNode.gain.value=t)},enumerable:!0,configurable:!0}),Object.defineProperty(Sound.prototype,"elapsedTime",{get:function(){if(this.paused)return this.offset;var t=fn.sharedContext;if(!this.source||!t)return 0;var e=t.currentTime-this.playedAt;if(this.loop){var i=this.source.loopEnd-this.source.loopStart;if(e>i)return this.source.loopStart+e%i}return e},enumerable:!0,configurable:!0}),Sound.prototype.isPaused=function(){return this.paused},Sound.prototype.play=function(t,e){var i=this;void 0===t&&(t=!1),void 0===e&&(e=0);var r=fn.sharedContext;r&&(this.loop=t,this.source=r.createBufferSource(),this.source.loop=this.loop,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration,this.source.buffer=this.buffer,this.source.onended=function(){return i.stop()},this.gainNode.connect(r.destination),this.source.connect(this.gainNode),this.source.start(0,e),this.playedAt=r.currentTime-e,this.paused=!1,this.played=!0)},Sound.prototype.stop=function(){if(this.source&&this.played){this.source.disconnect();try{this.source.buffer=null}catch(t){}this.source.onended=null,this.source=null,this.paused=!1}},Sound.prototype.pause=function(){!this.paused&&this.played&&this.source&&(this.offset=this.elapsedTime,this.stop(),this.paused=!0)},Sound.prototype.resume=function(){this.paused&&this.played&&(this.play(this.loop,this.offset),this.paused=!1)},Sound}(),fn=function(){function SoundManager(){if(this.paused=!1,this.killingSounds=[],this.managedSounds=new Map,SoundManager.instance)throw new Error("SoundManager can not be initialized twice")}return Object.defineProperty(SoundManager,"sharedContext",{get:function(){return SoundManager.context},enumerable:!0,configurable:!0}),SoundManager.init=function(t){if(!SoundManager.instance){if(SoundManager.instance=new SoundManager,t)SoundManager.context=t;else{var e=window.AudioContext||window.webkitAudioContext;SoundManager.context=new e}var i=Object(ln.detect)();i&&(SoundManager.useWebAudio(i),SoundManager.setSoundInitializeEvent(i),SoundManager.setWindowLifeCycleEvent(i))}},SoundManager.update=function(t){if(SoundManager.sharedContext){var e=SoundManager.instance.killingSounds;if(e.length>0){for(var i=[],r=0;r<e.length;r++){var n=e[r];SoundManager.sharedContext.currentTime>=n.endAt?n.sound.stop():i.push(n)}SoundManager.instance.killingSounds=i}}},SoundManager.useWebAudio=function(t){if(!SoundManager.webAudioInitialized){for(var e=SoundManager.supportedExtensions,i=0;i<e.length;i++){var r=e[i],n=xr;n.setExtensionXhrType(r,n.XHR_RESPONSE_TYPE.BUFFER),n.setExtensionLoadType(r,n.LOAD_TYPE.XHR)}var o=t.version?t.version.split(".")[0]:"0",s="decodeAudio";"chrome"===t.name&&64===Number.parseInt(o,10)&&(s="decodeAudioWithPromise"),(void 0).use(function(t,i){var r=t.url.split("?")[0].split(".")[1];r&&-1!==e.indexOf(r)?SoundManager[s](t.data,function(e){t.buffer=e,i()}):i()}),SoundManager.webAudioInitialized=!0}},SoundManager.decodeAudio=function(t,e){SoundManager.sharedContext&&SoundManager.sharedContext.decodeAudioData(t,e)},SoundManager.decodeAudioWithPromise=function(t,e){SoundManager.sharedContext&&SoundManager.sharedContext.decodeAudioData(t).then(e)},SoundManager.setSoundInitializeEvent=function(t){var e,i="undefined"===typeof document.ontouchend?"mousedown":"touchend",r=t.version?t.version.split(".")[0]:"0";if("chrome"===t.name&&Number.parseInt(r,10)>=66)e=function(){SoundManager.sharedContext&&SoundManager.sharedContext.resume(),document.body.removeEventListener(i,e)};else{if("safari"!==t.name)return;e=function(){var t=SoundManager.sharedContext;if(t){var r=t.createBufferSource();r.buffer=t.createBuffer(1,1,44100),r.connect(t.destination),r.start(0),r.disconnect()}document.body.removeEventListener(i,e)}}document.body.addEventListener(i,e)},SoundManager.setWindowLifeCycleEvent=function(t){"safari"===t.name?document.addEventListener("webkitvisibilitychange",function(){document.webkitHidden?SoundManager.pause():SoundManager.resume()}):document.addEventListener("visibilitychange",function(){document.hidden?SoundManager.pause():SoundManager.resume()})},SoundManager.registerSound=function(t,e){SoundManager.instance.managedSounds.set(t,e)},SoundManager.unregisterSound=function(t){SoundManager.instance.managedSounds.delete(t)},SoundManager.createSound=function(t,e){var i=new pn(e);return SoundManager.registerSound(t,i),i},SoundManager.getSound=function(t){return SoundManager.instance.managedSounds.get(t)},SoundManager.hasSound=function(t){return SoundManager.instance.managedSounds.has(t)},SoundManager.destroySound=function(t){var e=this.getSound(t);SoundManager.unregisterSound(t),e&&e.stop()},SoundManager.pause=function(){var t=SoundManager.instance;t.paused||(t.paused=!0,t.managedSounds.forEach(function(t){t.pause()}))},SoundManager.resume=function(){var t=SoundManager.instance;t.paused&&(t.paused=!1,t.managedSounds.forEach(function(t){t.resume()}))},SoundManager.fade=function(t,e,i,r){if(void 0===r&&(r=!1),SoundManager.sharedContext){var n=SoundManager.sharedContext.currentTime+i;t.gainNode.gain.exponentialRampToValueAtTime(e,n),r&&SoundManager.instance.killingSounds.push({sound:t,endAt:n})}},SoundManager.context=null,SoundManager.webAudioInitialized=!1,SoundManager.supportedExtensions=["mp3"],SoundManager}(),mn=function(){function GameManager(t){if(this.sceneResourceLoaded=!0,this.sceneTransitionOutFinished=!0,GameManager.instance)throw new Error("GameManager can be instantiate only once");this.game=t}return GameManager.start=function(t){var e=new sr(Object.assign({width:t.glWidth,height:t.glHeight},t.option)),i=new GameManager(e);GameManager.instance=i,dn.init(function(t){console.debug("indexed db could not be initialized")}),fn.init(),document.body.appendChild(e.view),window.addEventListener("resize",GameManager.resizeCanvas),GameManager.resizeCanvas(),GameManager.enableFullScreenIfNeeded(),e.ticker.add(function(t){i.currentScene&&i.currentScene.update(t),fn.update(t)})},GameManager.requestFullScreen=function(){var t=window.document.body;(t.requestFullScreen||t.webkitRequestFullScreen).call(t)},GameManager.transitionInIfPossible=function(t){var e=GameManager.instance;return!(!e.sceneResourceLoaded||!e.sceneTransitionOutFinished)&&(e.currentScene&&e.currentScene.destroy({children:!0}),e.currentScene=t,e.game&&e.game.stage.addChild(t),t.beginTransitionIn(function(t){}),!0)},GameManager.loadScene=function(t){var e=GameManager.instance;e.currentScene?(e.sceneResourceLoaded=!1,e.sceneTransitionOutFinished=!1,t.beginLoadResource(function(){e.sceneResourceLoaded=!0,GameManager.transitionInIfPossible(t)}),e.currentScene.beginTransitionOut(function(i){e.sceneTransitionOutFinished=!0,GameManager.transitionInIfPossible(t)})):(e.sceneTransitionOutFinished=!0,t.beginLoadResource(function(){e.sceneResourceLoaded=!0,GameManager.transitionInIfPossible(t)}))},GameManager.resizeCanvas=function(){var t,e,i=GameManager.instance.game,r=i.renderer,n=r.height/r.width;window.innerHeight/window.innerWidth>n?(t=window.innerWidth,e=window.innerWidth*(r.height/r.width)):(t=window.innerHeight*(r.width/r.height),e=window.innerHeight),i.view.style.width=t+"px",i.view.style.height=e+"px"},GameManager.enableFullScreenIfNeeded=function(){var t=Object(ln.detect)();if(t&&("iOS"===t.os||"Android OS"===t.os)){var e="undefined"===typeof document.ontouchend?"mousedown":"touchend";document.body.addEventListener(e,GameManager.requestFullScreen)}},GameManager}(),gn=function(){function UiNodeFactory(){}return UiNodeFactory.prototype.createUiNode=function(t){return new dt},UiNodeFactory.prototype.createUiNodeByGraphElement=function(t){var e=this.createUiNode(t.params);return e&&(e.name=t.id,e.position.set(t.position[0],t.position[1])),e},UiNodeFactory.prototype.attachUiEventByGraphElement=function(t,e,i){e.interactive=!0;for(var r=function(r){var n=t[r],o=i[n.callback];if(!o)return"continue";e.on(n.type,function(){return o.call.apply(o,[i].concat(n.arguments))})},n=0;n<t.length;n++)r(n)},UiNodeFactory}(),yn=(an=function(t,e){return(an=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}an(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),vn=function(t){function TextFactory(){return null!==t&&t.apply(this,arguments)||this}return yn(TextFactory,t),TextFactory.prototype.createUiNode=function(t){var e,i={};t&&(void 0!==t.family&&(i.fontFamily=t.family),void 0!==t.size&&(i.fontSize=t.size),void 0!==t.color&&(i.fill=t.color),void 0!==t.padding&&(i.padding=t.padding));var r=new Zi(i),n=new er(t&&t.text?t.text:"",r);return t&&void 0!==t.anchor&&(e=n.anchor).set.apply(e,t.anchor),n},TextFactory}(gn),_n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),xn=function(t){function SpriteFactory(){return null!==t&&t.apply(this,arguments)||this}return _n(SpriteFactory,t),SpriteFactory.prototype.createUiNode=function(t){var e=new Wi;if(t){var i=t.textureName;i&&r.TextureCache[i]&&(e.texture=r.TextureCache[i]),t.anchor&&(e.anchor.x=t.anchor[0],e.anchor.y=t.anchor[1])}return e},SpriteFactory}(gn),bn=function(){function UiGraph(){}return UiGraph.getFactory=function(t){if(!UiGraph.cachedFactory[t]){var e=void 0;switch(t){case"text":e=vn;break;case"sprite":e=xn}if(!e)return null;UiGraph.cachedFactory[t]=new e}return UiGraph.cachedFactory[t]},UiGraph.cachedFactory={},UiGraph}(),Tn=function(){function Immediate(){this.onTransitionFinished=function(){},this.finished=!1}return Immediate.prototype.getContainer=function(){return null},Immediate.prototype.begin=function(){this.finished=!0,this.onTransitionFinished()},Immediate.prototype.isBegan=function(){return!1},Immediate.prototype.isFinished=function(){return this.finished},Immediate.prototype.isActive=function(){return!1},Immediate.prototype.update=function(t){},Immediate.prototype.setCallback=function(t){this.onTransitionFinished=t},Immediate}(),Sn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),wn=function(t){function Scene(){var e=null!==t&&t.apply(this,arguments)||this;return e.elapsedFrameCount=0,e.hasSceneUiGraph=!0,e.uiGraph={},e.uiGraphContainer=new dt,e.objectsToUpdate=[],e.transitionIn=new Tn,e.transitionOut=new Tn,e}return Sn(Scene,t),Scene.prototype.update=function(t){this.elapsedFrameCount++,this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},Scene.prototype.registerUpdatingObject=function(t){this.objectsToUpdate.push(t)},Scene.prototype.updateRegisteredObjects=function(t){for(var e=[],i=0;i<this.objectsToUpdate.length;i++){var r=this.objectsToUpdate[i];r&&!r.isDestroyed()&&(r.update(t),e.push(r))}this.objectsToUpdate=e},Scene.prototype.beginTransitionIn=function(t){var e=this;this.transitionIn.setCallback(function(){return t(e)});var i=this.transitionIn.getContainer();i&&this.addChild(i),this.transitionIn.begin()},Scene.prototype.beginTransitionOut=function(t){var e=this;this.transitionOut.setCallback(function(){return t(e)});var i=this.transitionOut.getContainer();i&&this.addChild(i),this.transitionOut.begin()},Scene.prototype.createInitialResourceList=function(){return[]},Scene.prototype.beginLoadResource=function(t){var e=this;return new Promise(function(t){e.loadInitialResource(function(){return t()})}).then(function(){return new Promise(function(t){var i=e.onInitialResourceLoaded();e.loadAdditionalResource(i,function(){return t()})})}).then(function(){t()}).then(function(){e.onResourceLoaded()})},Scene.prototype.loadInitialResource=function(t){var e=this.createInitialResourceList(),i=un.Api.SceneUiGraph(this);this.hasSceneUiGraph&&!(void 0).resources[i]&&e.push({name:i,url:i});var r=this.filterLoadedAssets(e);r.length>0?(void 0).add(r).load(function(){return t()}):t()},Scene.prototype.onInitialResourceLoaded=function(){var t=[],e=un.Api.SceneUiGraph(this),i=(void 0).resources[e];if(i)for(var r=0;r<i.data.nodes.length;r++){var n=i.data.nodes[r];"sprite"===n.type&&t.push({name:n.params.textureName,url:n.params.url})}return t},Scene.prototype.loadAdditionalResource=function(t,e){var i=this;if(t.length<=0)this.onAdditionalResourceLoaded(e);else{var r=this.filterLoadedAssets(t);r.length>0?(void 0).add(r).load(function(){i.onAdditionalResourceLoaded(e)}):this.onAdditionalResourceLoaded(e)}},Scene.prototype.onAdditionalResourceLoaded=function(t){t()},Scene.prototype.onResourceLoaded=function(){if(this.hasSceneUiGraph){var t=un.Api.SceneUiGraph(this),e=(void 0).resources;this.prepareUiGraphContainer(e[t].data),this.addChild(this.uiGraphContainer)}},Scene.prototype.prepareUiGraphContainer=function(t){for(var e=0;e<t.nodes.length;e++){var i=t.nodes[e],r=bn.getFactory(i.type);if(r||(r=this.getCustomUiGraphFactory(i.type))){var n=r.createUiNodeByGraphElement(i);n&&(i.events&&r.attachUiEventByGraphElement(i.events,n,this),this.uiGraph[i.id]=n,this.uiGraphContainer.addChild(n))}}},Scene.prototype.getCustomUiGraphFactory=function(t){return null},Scene.prototype.filterLoadedAssets=function(t){for(var e=new Map,i=0;i<t.length;i++){var r=t[i];"string"==typeof r?(void 0).resources[r]||e.has(r)||e.set(r,{name:r,url:r}):(void 0).resources[r.name]||e.has(r.name)||e.set(r.name,r)}var n=[];return e.forEach(function(t){return n.push(t)}),n},Scene.prototype.playBgm=function(t){var e=fn.getSound(t);e&&e.play(!0)},Scene.prototype.stopBgm=function(t){var e=fn.getSound(t);e&&e.stop()},Scene.prototype.playSe=function(t){var e=fn.getSound(t);e&&e.play()},Scene}(dt),En=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),An=function(t){function UnitButton(e){var i=t.call(this)||this;return i.slotIndex=-1,i.unitId=-1,i.button=new Wi,i.text=new er("",{fontFamily:un.FontFamily.Default,fontSize:24,fill:16777215,padding:4}),i.filter=new on.ColorMatrixFilter,i.text.position.set(46,88),i.filter.desaturate(),i.toggleFilter(!1),i.button.filters=[i.filter],e&&(i.button.texture=e),i.addChild(i.button),i.addChild(i.text),i}return En(UnitButton,t),UnitButton.prototype.init=function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=-1),this.slotIndex=t,this.changeUnit(e,i)},UnitButton.prototype.toggleFilter=function(t){this.filter.enabled=t},UnitButton.prototype.changeUnit=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1);var i=this.getTexture(t);i&&(this.unitId=t,this.button.texture=i,this.text.text=e>=0?""+e:"")},UnitButton.prototype.getTexture=function(t){void 0===t&&(t=-1);var e=un.Dynamic.UnitPanel(t),i=(void 0).resources[e];return i&&i.texture?i.texture:null},UnitButton}(dt),Cn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),On=function(t){function UnitButtonFactory(){return null!==t&&t.apply(this,arguments)||this}return Cn(UnitButtonFactory,t),UnitButtonFactory.prototype.createUiNode=function(t){var e=void 0;if(t){var i=t.textureName;i&&r.TextureCache[i]&&(e=r.TextureCache[i])}return new An(e)},UnitButtonFactory}(gn),Pn=Object.freeze({IDLE:1,ENGAGED:2,KNOCK_BACK:3,DEAD:4,WAIT:5}),In=Object.freeze({LOADING_RESOURCES:1,RESOURCE_LOADED:2,READY:3,INGAME:4,FINISHED:5}),Mn=function(){function Fade(t,e,i){this.container=new dt,this.overlay=new Hi,this.transitionBegan=!1,this.transitionFinished=!1,this.onTransitionFinished=function(){},this.alphaFrom=t,this.alphaTo=e,this.alphaProgress=i;var r=mn.instance.game.view.width,n=mn.instance.game.view.height;this.overlay.beginFill(0),this.overlay.moveTo(0,0),this.overlay.lineTo(r,0),this.overlay.lineTo(r,n),this.overlay.lineTo(0,n),this.overlay.endFill(),this.overlay.alpha=this.alphaFrom,this.container.addChild(this.overlay)}return Fade.prototype.getContainer=function(){return this.container},Fade.prototype.begin=function(){this.transitionBegan=!0},Fade.prototype.isBegan=function(){return this.transitionBegan},Fade.prototype.isFinished=function(){return this.transitionFinished},Fade.prototype.isActive=function(){return this.isBegan()&&!this.isFinished()},Fade.prototype.update=function(t){this.isBegan()&&(this.isFinished()||(this.alphaTo<=this.alphaFrom&&this.overlay.alpha<=this.alphaTo||this.alphaTo>=this.alphaFrom&&this.overlay.alpha>=this.alphaTo?(this.onTransitionFinished(),this.transitionFinished=!0):this.overlay.alpha+=this.alphaProgress))},Fade.prototype.setCallback=function(t){this.onTransitionFinished=t},Fade}(),Rn=function(){return function BattleLogicConfig(t){this.costRecoveryPerFrame=0,this.maxAvailableCost=100,this.chivalrousEngage=!0,this.knockBackHealthThreasholds=[.25,.5,.75],t&&(t.costRecoveryPerFrame&&(this.costRecoveryPerFrame=t.costRecoveryPerFrame),t.maxAvailableCost&&(this.maxAvailableCost=t.maxAvailableCost),t.chivalrousEngage&&(this.chivalrousEngage=t.chivalrousEngage),t.knockBackHealthThreasholds&&(this.knockBackHealthThreasholds=t.knockBackHealthThreasholds.sort().reverse()))}}(),Dn=function(){return function AttackableEntity(t){this.id=0,this.isPlayer=!0,this.state=0,this.maxHealth=0,this.currentHealth=0,this.currentFrameDamage=0,this.currentKnockBackFrameCount=0,this.distance=0,this.engagedEntity=null,this.isPlayer=t}}(),Fn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Bn=function(t){function UnitEntity(e,i){var r=t.call(this,i)||this;return r.unitId=0,r.unitId=e,r}return Fn(UnitEntity,t),UnitEntity}(Dn),Ln=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),kn=function(t){function CastleEntity(e,i){var r=t.call(this,i)||this;return r.castleId=0,r.castleId=e.castleId,r.maxHealth=e.maxHealth,r.currentHealth=r.maxHealth,r}return Ln(CastleEntity,t),CastleEntity}(Dn),Un=function(){function BattleLogic(){this.config=Object.freeze(new Rn),this.availableCost=0,this.nextEntityId=0,this.attackableEntities=[],this.stageMasterCache=null,this.unitMasterCache=new Map,this.castleMasterCache=new Map,this.aiWaveCache=new Map,this.spawnRequestedUnitUnitIds=[],this.passedFrameCount=0,this.isGameOver=!1}return BattleLogic.prototype.init=function(t){t.config&&(this.config=Object.freeze(t.config)),this.delegator=t.delegator,this.player=t.player,this.aiWaveCache.clear(),this.unitMasterCache.clear(),this.stageMasterCache=t.stageMaster,this.castleMasterCache.set(this.player.castle.castleId,this.player.castle),this.castleMasterCache.set(t.ai.castle.castleId,t.ai.castle);for(var e=this.stageMasterCache.waves,i=Object.keys(e),r=0;r<i.length;r++){var n=i[r];this.aiWaveCache.set(Number.parseInt(n,10),e[n])}for(r=0;r<t.unitMasters.length;r++){var o=t.unitMasters[r];this.unitMasterCache.set(o.unitId,o)}this.castleEntities={player:this.spawnCastle(this.player.castle,!0),ai:this.spawnCastle(t.ai.castle,!1)}},BattleLogic.prototype.requestSpawn=function(t,e){this.spawnRequestedUnitUnitIds.push({unitId:t,isPlayer:e})},BattleLogic.prototype.requestSpawnPlayer=function(t){this.requestSpawn(t,!0)},BattleLogic.prototype.requestSpawnAI=function(t){this.requestSpawn(t,!1)},BattleLogic.prototype.update=function(){this.isGameOver||(this.updateGameOver(),this.updateAvailableCost(this.availableCost+this.config.costRecoveryPerFrame),this.updateAISpawn(),this.updateSpawnRequest(),this.updateEntityParameter(),this.updateEntityState()),this.updatePostProcess(),this.passedFrameCount++},BattleLogic.prototype.updatePostProcess=function(){for(var t=[],e=0;e<this.attackableEntities.length;e++){var i=this.attackableEntities[e];i.state!==Pn.DEAD&&t.push(i)}this.attackableEntities=t;for(e=0;e<this.attackableEntities.length;e++)this.attackableEntities[e].currentFrameDamage=0},BattleLogic.prototype.updateEntityParameter=function(){for(var t=0;t<this.attackableEntities.length;t++){var e=this.attackableEntities[t],i=e.unitId?this.unitMasterCache.get(e.unitId):this.castleMasterCache.get(e.castleId);i&&(this.updateDamage(e,i),this.updateDistance(e,i))}},BattleLogic.prototype.updateEntityState=function(){for(var t=[],e=0;e<this.attackableEntities.length;e++)t.push(this.attackableEntities[e].state);for(e=0;e<this.attackableEntities.length;e++){(i=this.attackableEntities[e]).state===Pn.KNOCK_BACK&&this.updateAttackableKnockBackState(i)}for(e=0;e<this.attackableEntities.length;e++){(i=this.attackableEntities[e]).state===Pn.ENGAGED&&this.updateAttackableEngagedState(i)}for(e=0;e<this.attackableEntities.length;e++){(i=this.attackableEntities[e]).state===Pn.IDLE&&this.updateAttackableIdleState(i)}if(this.delegator)for(e=0;e<this.attackableEntities.length;e++){var i=this.attackableEntities[e],r=t[e];r!==i.state&&this.delegator.onAttackableEntityStateChanged(i,r)}},BattleLogic.prototype.updateDamage=function(t,e){if(t.engagedEntity&&(!this.delegator||this.delegator.shouldDamage(t,t.engagedEntity))){var i=t.engagedEntity.currentHealth-e.power;t.engagedEntity.currentFrameDamage+=e.power,t.engagedEntity.currentHealth=i,this.delegator&&this.delegator.onAttackableEntityHealthUpdated(t,t.engagedEntity,t.engagedEntity.currentHealth+e.power,t.engagedEntity.currentHealth,t.engagedEntity.maxHealth)}},BattleLogic.prototype.updateDistance=function(t,e){if(t.state===Pn.KNOCK_BACK){if(t.distance-=e.knockBackSpeed,t.currentKnockBackFrameCount++,this.delegator){var i=t.currentKnockBackFrameCount/e.knockBackFrames;this.delegator.onAttackableEntityKnockingBack(t,i)}}else t.currentKnockBackFrameCount=0,t.state===Pn.IDLE&&(t.currentKnockBackFrameCount=0,(!this.delegator||this.delegator.shouldAttackableWalk(t))&&(t.distance+=e.speed,this.delegator&&this.delegator.onAttackableEntityWalked(t)))},BattleLogic.prototype.updateAttackableKnockBackState=function(t){t.engagedEntity=null;var e=t.unitId?this.unitMasterCache.get(t.unitId):this.castleMasterCache.get(t.castleId);e&&(0!==e.knockBackFrames&&t.currentKnockBackFrameCount<e.knockBackFrames||(t.state=t.currentHealth<1?Pn.DEAD:Pn.IDLE))},BattleLogic.prototype.updateAttackableEngagedState=function(t){if(t.currentHealth<1)return t.engagedEntity=null,void(t.state=Pn.KNOCK_BACK);if(t.engagedEntity){var e=t.engagedEntity,i=e.currentHealth<1,r=e.state===Pn.KNOCK_BACK;(i||r||!this.chivalrousFilter(t,t.engagedEntity))&&(t.engagedEntity=null,t.state=Pn.IDLE)}for(var n=t.currentHealth+t.currentFrameDamage,o=0;o<this.config.knockBackHealthThreasholds.length;o++){var s=this.config.knockBackHealthThreasholds[o],a=t.maxHealth*s;if(!(t.currentHealth>=a)&&n>=a){t.engagedEntity=null,t.state=Pn.KNOCK_BACK;break}}},BattleLogic.prototype.updateAttackableIdleState=function(t){for(var e=0;e<this.attackableEntities.length;e++){var i=this.attackableEntities[e],r=void 0!==i.castleId;if(!(t.isPlayer&&i.isPlayer||!t.isPlayer&&!i.isPlayer))if(r||i.state===Pn.IDLE||i.state===Pn.ENGAGED)if(!this.delegator||this.delegator.shouldEngageAttackableEntity(t,i)){this.chivalrousFilter(t,i)&&(t.engagedEntity=i,t.state=Pn.ENGAGED);break}}},BattleLogic.prototype.updateGameOver=function(){var t=this.isPlayerWon();if(this.isGameOver=t||this.isAiWon(),this.isGameOver){for(var e=0;e<this.attackableEntities.length;e++){var i=this.attackableEntities[e];i.castleId||(i.state=Pn.IDLE)}this.delegator&&this.delegator.onGameOver(t)}},BattleLogic.prototype.isPlayerWon=function(){if(!this.castleEntities)throw new Error("castle entities are missing");return this.castleEntities.ai.currentHealth<1},BattleLogic.prototype.isAiWon=function(){if(!this.castleEntities)throw new Error("castle entities are missing");return this.castleEntities.player.currentHealth<1},BattleLogic.prototype.updateAISpawn=function(){var t=this.aiWaveCache.get(this.passedFrameCount);if(t)for(var e=0;e<t.length;e++){var i=t[e].unitId;this.requestSpawnAI(i)}},BattleLogic.prototype.updateSpawnRequest=function(){if(0!==this.spawnRequestedUnitUnitIds.length&&this.stageMasterCache){for(var t=this.availableCost,e=0;e<this.spawnRequestedUnitUnitIds.length;e++){var i=this.spawnRequestedUnitUnitIds[e],r=this.unitMasterCache.get(i.unitId);if(r){if(i.isPlayer){if(t-r.cost<0)continue;t-=r.cost}var n=new Bn(i.unitId,i.isPlayer);n.id=this.nextEntityId++,n.maxHealth=r.maxHealth,n.currentHealth=r.maxHealth,n.state=Pn.IDLE,this.attackableEntities.push(n),this.delegator&&this.delegator.onUnitEntitySpawned(n)}}this.updateAvailableCost(t),this.spawnRequestedUnitUnitIds=[]}},BattleLogic.prototype.updateAvailableCost=function(t){var e=t;e>this.config.maxAvailableCost&&(e=this.config.maxAvailableCost),this.availableCost=e;for(var i=[],r=0;r<this.player.unitIds.length;r++){var n=this.player.unitIds[r],o=this.unitMasterCache.get(n);o&&(this.availableCost>=o.cost&&i.push(n))}return this.delegator&&this.delegator.onAvailableCostUpdated(this.availableCost,this.config.maxAvailableCost,i),this.availableCost},BattleLogic.prototype.chivalrousFilter=function(t,e){return!this.config.chivalrousEngage||(!e.engagedEntity||(void 0!==e.castleId||(void 0!==e.engagedEntity.castleId||e.engagedEntity.id===t.id)))},BattleLogic.prototype.spawnCastle=function(t,e){var i=new kn(t,e);return i.id=this.nextEntityId++,i.state=Pn.IDLE,this.attackableEntities.push(i),this.delegator&&this.delegator.onCastleEntitySpawned(i,e),i},BattleLogic}(),Nn=function(){function Attackable(t){this.elapsedFrameCount=0,this.destroyed=!1,this.animationType="",this.sprite=new Wi,this.sprite.anchor.x=.5,this.sprite.anchor.y=1,this.sprite.position.set(t.x,t.y),this.spawnedPosition=new N(this.sprite.position.x,this.sprite.position.y),Object.freeze(this.spawnedPosition)}return Object.defineProperty(Attackable.prototype,"distanceBasePosition",{get:function(){return this.spawnedPosition},enumerable:!0,configurable:!0}),Attackable.prototype.isDestroyed=function(){return this.destroyed},Attackable.prototype.update=function(t){},Attackable.prototype.isFoeContact=function(t){var e=this.sprite.position.x,i=this.sprite.position.x+this.sprite.width,r=t.position.x;return e<t.position.x+t.width&&i>r},Attackable.prototype.resetAnimation=function(){},Attackable.prototype.updateAnimation=function(){},Attackable.prototype.destroy=function(){this.sprite.destroy(),this.destroyed=!0},Attackable}(),Gn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),jn=function(t){function HealthGaugeEffect(e,i){var r=t.call(this)||this;return r.gaugeWidth=60,r.gaugeHeight=8,r.maxColor=16729156,r.currentColor=16777028,r.lineColor=2236962,r.elapsedFrameCount=0,r.reducingFrameCount=4,r.activeFrameCount=24,r.fromPercent=e,r.toPercent=i,r.maxGraphic=new Hi,r.maxGraphic.lineStyle(2,r.lineColor,1),r.maxGraphic.beginFill(r.maxColor,1),r.maxGraphic.drawRect(0,0,r.gaugeWidth,r.gaugeHeight),r.currentGraphic=new Hi,r.currentGraphic.beginFill(r.currentColor,1),r.currentGraphic.drawRect(0,0,0,22),r.addChild(r.maxGraphic),r.addChild(r.currentGraphic),r}return Gn(HealthGaugeEffect,t),Object.defineProperty(HealthGaugeEffect,"resourceList",{get:function(){return[]},enumerable:!0,configurable:!0}),HealthGaugeEffect.prototype.isDestroyed=function(){return this._destroyed},HealthGaugeEffect.prototype.update=function(t){if(!this.isDestroyed())if(this.elapsedFrameCount++,this.elapsedFrameCount<=this.reducingFrameCount){var e=this.fromPercent-this.toPercent,i=this.elapsedFrameCount/this.reducingFrameCount,r=this.fromPercent-e*i,n=this.gaugeWidth*r;this.currentGraphic.clear(),this.currentGraphic.beginFill(this.currentColor,1),this.currentGraphic.drawRect(0,0,n,this.gaugeHeight)}else this.elapsedFrameCount>this.activeFrameCount&&(this.maxGraphic.destroy(),this.currentGraphic.destroy(),this.destroy())},HealthGaugeEffect}(dt),Xn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Hn=function(t){function Unit(e,i){var r=t.call(this,i)||this;return r.animationFrameId=1,r.requestedAnimation=null,r.healthGauge=null,r.animationType=un.AnimationTypes.Unit.WAIT,r.animationMaster=e,r}return Xn(Unit,t),Unit.prototype.resetAnimation=function(){this.requestedAnimation=null,this.elapsedFrameCount=0,this.animationFrameId=1},Unit.prototype.update=function(t){this.requestedAnimation&&this.transformAnimationIfPossible()&&(this.requestedAnimation=null),this.updateAnimation()},Unit.prototype.requestAnimation=function(t){this.requestedAnimation=t},Unit.prototype.isHitFrame=function(){if(this.animationFrameId!==this.animationMaster.hitFrame)return!1;var t=un.AnimationTypes.Unit.ATTACK,e=this.animationMaster.types[t];return!!e&&this.elapsedFrameCount%e.updateDuration==0},Unit.prototype.isAnimationLastFrameTime=function(){var t=this.animationType,e=this.animationMaster.types[t];if(!e)return!1;var i=e.updateDuration*e.frames.length;return this.elapsedFrameCount===i},Unit.prototype.spawnHealthGauge=function(t,e){this.healthGauge&&this.healthGauge.destroy();var i=this.sprite.anchor;return this.healthGauge=new jn(t,e),this.healthGauge.position.set(this.sprite.position.x-this.healthGauge.gaugeWidth*i.x,this.sprite.position.y-this.healthGauge.gaugeHeight*i.y),this.healthGauge},Unit.prototype.updateAnimation=function(){var t=this.animationType,e=this.animationMaster.types[t];if(e){if(this.elapsedFrameCount%e.updateDuration==0){this.isAnimationLastFrameTime()&&this.resetAnimation();var i=e.frames[this.animationFrameId-1];this.sprite.texture=r.TextureCache[i],this.animationFrameId++}this.elapsedFrameCount++}},Unit.prototype.transformAnimationIfPossible=function(){var t=un.AnimationTypes.Unit;switch(this.requestedAnimation){case t.WAIT:case t.WALK:if(this.animationType!==t.WALK&&this.isAnimationLastFrameTime())return this.animationType=this.requestedAnimation,this.resetAnimation(),!0;break;case t.DAMAGE:case t.ATTACK:return this.animationType=this.requestedAnimation,this.resetAnimation(),!0}return!1},Unit}(Nn),zn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Yn=function(t){function CollapseExplodeEffect(){var e=t.call(this)||this;return e.elapsedFrameCount=0,e.sprite=new Wi(un.TextureFrame.CollapseExplode(1)),e.sprite.anchor.set(.5,.5),e.addChild(e.sprite),e}return zn(CollapseExplodeEffect,t),Object.defineProperty(CollapseExplodeEffect,"resourceList",{get:function(){return[un.Static.CollapseExplode,un.Audio.Se.Bomb]},enumerable:!0,configurable:!0}),CollapseExplodeEffect.prototype.isDestroyed=function(){return this._destroyed},CollapseExplodeEffect.prototype.update=function(t){if(!this.isDestroyed()){this.elapsedFrameCount++,this.sprite.visible=this.elapsedFrameCount%2==0,1===this.elapsedFrameCount&&this.playSe();var e=CollapseExplodeEffect.TextureFrameUpdateFrequency;if(this.elapsedFrameCount%e==0){var i=this.elapsedFrameCount/e,r=Math.floor(i)+1;if(r>un.MaxFrameIndex(un.Static.CollapseExplode))return this.sprite.destroy(),void this.destroy();this.sprite.texture=un.TextureFrame.CollapseExplode(r)}}},CollapseExplodeEffect.prototype.playSe=function(){var t=fn.getSound(un.Audio.Se.Bomb);t&&t.play()},CollapseExplodeEffect.TextureFrameUpdateFrequency=4,CollapseExplodeEffect}(dt),Wn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Vn=function(t){function Castle(e,i){var r=t.call(this,i)||this;return r.explodeContainer=new dt,r.castleId=e,r.animationType=un.AnimationTypes.Castle.IDLE,r.sprite.texture=un.TextureFrame.Castle(e),r}return Wn(Castle,t),Object.defineProperty(Castle,"resourceList",{get:function(){return[un.Audio.Se.UnitSpawn]},enumerable:!0,configurable:!0}),Castle.prototype.update=function(t){this.updateAnimation()},Castle.prototype.resetAnimation=function(){this.animationType=un.AnimationTypes.Castle.IDLE,this.elapsedFrameCount=0},Castle.prototype.collapse=function(){this.animationType=un.AnimationTypes.Castle.COLLAPSE,this.elapsedFrameCount=0},Castle.prototype.spawn=function(t){t&&this.playSpawnSe(),this.animationType=un.AnimationTypes.Castle.SPAWN,this.elapsedFrameCount=0},Castle.prototype.updateAnimation=function(){switch(this.animationType){case un.AnimationTypes.Castle.COLLAPSE:this.explodeContainer.position.set(this.sprite.position.x-this.sprite.width*this.sprite.anchor.x,this.sprite.position.y-this.sprite.height*this.sprite.anchor.y),this.elapsedFrameCount%10==0&&this.spawnCollapseExplode();var t=this.elapsedFrameCount%2==0?1:-1;this.sprite.position.x=this.sprite.position.x+4*t;break;case un.AnimationTypes.Castle.SPAWN:1===this.castleId?(this.sprite.texture=un.TextureFrame.Castle(this.castleId,2),this.elapsedFrameCount>=16&&this.resetAnimation()):this.animationType=un.AnimationTypes.Castle.IDLE;break;case un.AnimationTypes.Castle.IDLE:default:if(1===this.castleId)this.sprite.texture=un.TextureFrame.Castle(this.castleId,1);else{var e=Math.sin(2*Math.PI/400*this.elapsedFrameCount);this.sprite.position.y=this.spawnedPosition.y+-20*e}}for(var i=0;i<this.explodeContainer.children.length;i++){this.explodeContainer.children[i].update(1)}this.elapsedFrameCount++},Castle.prototype.spawnCollapseExplode=function(){var t=1+Math.random()%.8-.4,e=new Yn;e.position.x=Math.random()*this.sprite.width,e.position.y=Math.random()*this.sprite.height,e.scale.set(t),this.explodeContainer.addChild(e)},Castle.prototype.playSpawnSe=function(){var t=fn.getSound(un.Audio.Se.UnitSpawn);t&&t.play()},Castle}(Nn),qn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Kn=function(t){function Field(){var e=t.call(this)||this;return e.lastZlineIndex=-1,e.pointerDownCount=0,e.lastPointerPositionX=0,e.foregroundScrollLimit=-1,e.containers={fore:new dt,foreBackgroundEffect:new dt,middle:new dt,back:new dt},e.foreZLines=[],e.interactive=!0,e.on("pointerdown",function(t){return e.onPointerDown(t)}),e.on("pointermove",function(t){return e.onPointerMove(t)}),e.on("pointercancel",function(t){return e.onPointerUp(t)}),e.on("pointerup",function(t){return e.onPointerUp(t)}),e.on("pointerout",function(t){return e.onPointerUp(t)}),e}return qn(Field,t),Object.defineProperty(Field,"resourceList",{get:function(){return[].concat(un.Static.BattleBgFores,un.Static.BattleBgMiddles,un.Static.BattleBgBacks)},enumerable:!0,configurable:!0}),Object.defineProperty(Field.prototype,"zLineCount",{get:function(){return this.foreZLines.length},enumerable:!0,configurable:!0}),Field.prototype.init=function(t){void 0===t&&(t={fieldLength:3e3,zLines:8});for(var e={fore:un.Static.BattleBgFores,middle:un.Static.BattleBgMiddles,back:un.Static.BattleBgBacks},i=Object.keys(e),r=0;r<i.length;r++)for(var n=i[r],o=e[n],s=0,a=0;a<o.length;a++){var h=(void 0).resources[o[a]].texture,u=new Wi(h);u.position.x=s,s+=u.width,this.containers[n].addChild(u)}this.addChild(this.containers.back),this.addChild(this.containers.middle),this.addChild(this.containers.fore),this.containers.fore.addChild(this.containers.foreBackgroundEffect);for(r=0;r<t.zLines;r++){var l=new dt;this.foreZLines.push(l),this.containers.fore.addChild(l)}var c=.75*mn.instance.game.view.width;this.foregroundScrollLimit=-(t.fieldLength-c)},Field.prototype.addChildAsForeBackgroundEffect=function(t){this.containers.foreBackgroundEffect.addChild(t)},Field.prototype.addChildToZLine=function(t,e){this.foreZLines[e].addChild(t),this.lastZlineIndex=e},Field.prototype.getDifferentZlineIndex=function(){var t=this.zLineCount,e=Math.floor(Math.random()*this.zLineCount);return e===this.lastZlineIndex&&++e>t-1&&(e=0),e},Field.prototype.getZlineBaseY=function(t){return.5*this.containers.fore.height+16*t},Field.prototype.onPointerDown=function(t){this.pointerDownCount++,1===this.pointerDownCount&&(this.lastPointerPositionX=t.data.global.x)},Field.prototype.onPointerMove=function(t){if(!(this.pointerDownCount<=0)){var e=t.data.global.x,i=e-this.lastPointerPositionX,r=this.containers.fore.position.x+i;r>0?r=0:r<this.foregroundScrollLimit&&(r=this.foregroundScrollLimit),this.containers.fore.position.x=r,this.containers.middle.position.x=.5*r,this.containers.back.position.x=.2*r,this.lastPointerPositionX=e}},Field.prototype.onPointerUp=function(t){this.pointerDownCount--,this.pointerDownCount<0&&(this.pointerDownCount=0)},Field}(dt),Zn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Jn=function(t){function BattleResult(e){var i=t.call(this)||this;i.animationEnded=!1,i.onAnimationEnded=function(){};var n=e?un.Static.BattleResultWin:un.Static.BattleResultLose,o=r.TextureCache[n];return i.sprite=new Wi(o),i.sprite.anchor.set(.5),i.sprite.position.x=.5*mn.instance.game.view.width,i.sprite.position.y=-.5*i.sprite.height,i.addChild(i.sprite),i}return Zn(BattleResult,t),Object.defineProperty(BattleResult,"resourceList",{get:function(){return[un.Static.BattleResultWin,un.Static.BattleResultLose]},enumerable:!0,configurable:!0}),BattleResult.prototype.isDestroyed=function(){return this._destroyed},BattleResult.prototype.update=function(t){this.animationEnded||(this.sprite.position.y+=4,this.sprite.position.y>=.5*mn.instance.game.view.height&&(this.animationEnded=!0,this.onAnimationEnded()))},BattleResult}(dt),Qn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),$n=function(t){function AttackSmokeEffect(){var e=t.call(this)||this;return e.elapsedFrameCount=0,e.sprite=new Wi(un.TextureFrame.AttackSmoke(1)),e.addChild(e.sprite),e}return Qn(AttackSmokeEffect,t),Object.defineProperty(AttackSmokeEffect,"resourceList",{get:function(){return[un.Static.AttackSmoke]},enumerable:!0,configurable:!0}),AttackSmokeEffect.prototype.isDestroyed=function(){return this._destroyed},AttackSmokeEffect.prototype.update=function(t){if(!this.isDestroyed()){this.elapsedFrameCount++,this.sprite.visible=this.elapsedFrameCount%2==0;var e=AttackSmokeEffect.TextureFrameUpdateFrequency;if(this.elapsedFrameCount%e==0){var i=this.elapsedFrameCount/e,r=Math.floor(i)+1;if(r>un.MaxFrameIndex(un.Static.AttackSmoke))return this.sprite.destroy(),void this.destroy();this.sprite.texture=un.TextureFrame.AttackSmoke(r)}}},AttackSmokeEffect.TextureFrameUpdateFrequency=4,AttackSmokeEffect}(dt),to=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),eo=Math.PI/180,io=function(t){function Dead(e){var i=t.call(this)||this;i.elapsedFrameCount=0;var n=r.TextureCache,o=n[un.Static.DeadBucket],s=n[un.Static.DeadSpirit];return i.bucket=new Wi(o),i.spirit=new Wi(s),i.bucket.anchor.y=0,i.spirit.position.y=-i.bucket.height,e?(i.bucket.scale.x=-1,i.spirit.scale.x=-1,i.spirit.position.x=-.5*(i.bucket.width-i.spirit.width)):i.spirit.position.x=.5*(i.bucket.width-i.spirit.width),i.addChild(i.bucket),i.addChild(i.spirit),i.spirit.visible=!1,i}return to(Dead,t),Object.defineProperty(Dead,"resourceList",{get:function(){return[un.Static.DeadBucket,un.Static.DeadSpirit]},enumerable:!0,configurable:!0}),Dead.prototype.isDestroyed=function(){return this._destroyed},Dead.prototype.update=function(t){if(!this.isDestroyed())switch(this.elapsedFrameCount++,this.elapsedFrameCount){case 4:this.bucket.rotation=25*eo;break;case 8:this.bucket.rotation=-25*eo;break;case 12:this.bucket.rotation=15*eo;break;case 16:this.bucket.rotation=-15*eo;break;case 20:this.bucket.rotation=5*eo;break;case 24:this.bucket.rotation=-5*eo;break;case 26:this.bucket.rotation=0,this.spirit.visible=!0;break;case 80:this.bucket.destroy(),this.spirit.destroy(),this.destroy();break;default:this.elapsedFrameCount>26&&(this.spirit.visible=this.elapsedFrameCount%2==0,this.spirit.y=this.spirit.y-3)}},Dead}(dt),ro=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),no=function(t){function BattleScene(e){var i=t.call(this)||this;return i.attackables=new Map,i.castles={player:null,ai:null},i.unitAnimationMasterCache=new Map,i.transitionIn=new Mn(1,0,-.02),i.transitionOut=new Mn(0,1,.02),i.state=In.LOADING_RESOURCES,i.battleLogic=new Un,i.field=new Kn,i.unitSlotCount=e.unitSlotCount,i.stageId=e.stageId,i.unitIds=e.unitIds,i.playerCastle=e.playerCastle,i.battleLogicConfig=new Rn({costRecoveryPerFrame:e.cost.recoveryPerFrame,maxAvailableCost:e.cost.max}),i}return ro(BattleScene,t),BattleScene.prototype.beginTransitionIn=function(e){var i=this;t.prototype.beginTransitionIn.call(this,function(){i.state===In.RESOURCE_LOADED&&(i.state=In.READY,e(i))})},BattleScene.prototype.update=function(t){switch(this.state){case In.LOADING_RESOURCES:break;case In.READY:this.state=In.INGAME;break;case In.INGAME:case In.FINISHED:this.battleLogic.update()}this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},BattleScene.prototype.createInitialResourceList=function(){var e=t.prototype.createInitialResourceList.call(this);return e=e.concat(Kn.resourceList,Vn.resourceList,$n.resourceList,io.resourceList,Yn.resourceList,Jn.resourceList,[un.Api.Stage(this.stageId),un.Dynamic.Castle(this.playerCastle.castleId),un.Audio.Bgm.Battle,un.Audio.Se.Attack1,un.Audio.Se.Attack2,un.Audio.Se.Bomb,un.Audio.Se.UnitSpawn,un.Audio.Se.Win,un.Audio.Se.Lose])},BattleScene.prototype.onInitialResourceLoaded=function(){var e=t.prototype.onInitialResourceLoaded.call(this),i=(void 0).resources[un.Api.Stage(this.stageId)].data;e.push(un.Dynamic.Castle(i.aiCastleId));for(var r=Object.keys(i.waves),n=0;n<r.length;n++)for(var o=r[n],s=i.waves[o],a=0;a<s.length;a++){var h=s[a].unitId;-1===this.unitIds.indexOf(h)&&this.unitIds.push(h)}e.push(un.Api.Unit(this.unitIds)),e.push(un.Api.Castle([i.aiCastleId])),e.push(un.Api.UnitAnimation(this.unitIds));for(n=0;n<this.unitIds.length;n++){h=this.unitIds[n];e.push(un.Dynamic.UnitPanel(h)),h>0&&e.push(un.Dynamic.Unit(h))}return e},BattleScene.prototype.onResourceLoaded=function(){t.prototype.onResourceLoaded.call(this);var e=(void 0).resources,i=e[un.Api.Stage(this.stageId)].data,r=e[un.Api.Castle([i.aiCastleId])].data,n=e[un.Api.Unit(this.unitIds)].data,o=r.filter(function(t){return t.castleId===i.aiCastleId});if(0===o.length)throw new Error("could not retrieve ai castle master data");for(var s=e[un.Api.UnitAnimation(this.unitIds)].data,a=0;a<s.length;a++){var h=s[a];this.unitAnimationMasterCache.set(h.unitId,h)}this.field.init({fieldLength:i.length,zLines:i.zLines}),this.initSound(),this.initUnitButtons(),this.addChild(this.field),this.addChild(this.uiGraphContainer),this.battleLogic.init({stageMaster:i,unitMasters:n,delegator:this,player:{unitIds:this.unitIds,castle:this.playerCastle},ai:{castle:o[0]},config:this.battleLogicConfig}),this.transitionIn.isFinished()?this.state=In.READY:this.state=In.RESOURCE_LOADED},BattleScene.prototype.getCustomUiGraphFactory=function(t){return"unit_button"===t?new On:null},BattleScene.prototype.onCastleEntitySpawned=function(t,e){var i=(void 0).resources[un.Api.Stage(this.stageId)].data,r=200;switch(t.castleId){case 1:r=300;break;default:r=200}var n=new Vn(t.castleId,{x:e?BattleScene.castleXOffset:i.length-BattleScene.castleXOffset,y:r});t.isPlayer||(n.sprite.scale.x=-1),t.isPlayer?this.castles.player=n:this.castles.ai=n,this.attackables.set(t.id,n),this.field.addChildToZLine(n.sprite,0),this.registerUpdatingObject(n)},BattleScene.prototype.onUnitEntitySpawned=function(t){var e=this.unitAnimationMasterCache.get(t.unitId);if(e){var i=t.isPlayer?this.castles.player:this.castles.ai;if(i){i.spawn(t.isPlayer);var r=(void 0).resources[un.Api.Stage(this.stageId)].data,n=this.field.getDifferentZlineIndex(),o=new Hn(e,{x:t.isPlayer?BattleScene.castleXOffset:r.length-BattleScene.castleXOffset,y:this.field.getZlineBaseY(n)});o.sprite.name="unit "+t.id,o.sprite.scale.x=t.isPlayer?1:-1,o.requestAnimation(un.AnimationTypes.Unit.WALK),this.attackables.set(t.id,o),this.field.addChildToZLine(o.sprite,n),this.registerUpdatingObject(o)}}},BattleScene.prototype.onAttackableEntityStateChanged=function(t,e){var i=this.attackables.get(t.id);if(i)if(t.unitId){var r=i,n=un.AnimationTypes.Unit;switch(t.state){case Pn.IDLE:r.requestAnimation(n.WALK);break;case Pn.ENGAGED:r.requestAnimation(n.ATTACK);break;case Pn.KNOCK_BACK:r.requestAnimation(n.DAMAGE);break;case Pn.DEAD:var o=new io(!t.isPlayer),s=i.sprite,a=s.position,h=s.height*(1-s.anchor.y)-o.height;o.position.set(a.x,a.y+h),s.parent.addChild(o),this.registerUpdatingObject(o),i.destroy()}}else if(t.state===Pn.DEAD){var u=i;u.collapse(),this.field.addChildAsForeBackgroundEffect(u.explodeContainer)}},BattleScene.prototype.onAvailableCostUpdated=function(t,e,i){var r=Math.floor(t)+"/"+e;this.uiGraph.cost_text.text=r;for(var n=0;n<this.unitSlotCount;n++){var o=this.getUiGraphUnitButton(n);if(o){var s=-1===i.indexOf(o.unitId);o.toggleFilter(s)}}},BattleScene.prototype.onGameOver=function(t){this.state=In.FINISHED,this.attackables.forEach(function(t){var e=t;e.requestAnimation&&e.requestAnimation(un.AnimationTypes.Unit.WAIT)});var e=new Jn(t);e.onAnimationEnded=this.enableBackToOrderScene.bind(this),this.uiGraphContainer.addChild(e),this.registerUpdatingObject(e),this.stopBgm(un.Audio.Bgm.Battle),this.playSe(t?un.Audio.Se.Win:un.Audio.Se.Lose)},BattleScene.prototype.shouldEngageAttackableEntity=function(t,e){var i=this.attackables.get(t.id);if(!i)return!1;var r=this.attackables.get(e.id);return!!r&&i.isFoeContact(r.sprite)},BattleScene.prototype.shouldDamage=function(t,e){var i=this.attackables.get(t.id);if(!i)return!1;var r=this.attackables.get(e.id);if(!r)return!1;if(!t.unitId)return!1;var n=i;return!!n.isHitFrame()&&n.isFoeContact(r.sprite)},BattleScene.prototype.onAttackableEntityWalked=function(t){var e=this.attackables.get(t.id);if(e){var i=t.isPlayer?1:-1,r=t.distance*i;e.sprite.position.x=e.distanceBasePosition.x+r}},BattleScene.prototype.onAttackableEntityKnockingBack=function(t,e){var i=this.attackables.get(t.id);if(i){var r=t.isPlayer?1:-1,n=t.distance*r,o=i.distanceBasePosition,s=e>=1?0:-Math.sin(e*Math.PI);i.sprite.position.x=o.x+n,i.sprite.position.y=o.y+s*BattleScene.unitLeapHeight}},BattleScene.prototype.onAttackableEntityHealthUpdated=function(t,e,i,r,n){var o=this.attackables.get(e.id);if(o){var s=o.sprite,a=new $n,h=Math.random()*s.width,u=Math.random()*s.height,l=s.width*(.5+s.anchor.x),c=s.height*(.5+s.anchor.y),d=s.position.x+h-l,p=s.position.y+u-c,f=.5+.5*Math.random();if(a.position.set(d,p),a.scale.set(f,f),s.parent.addChild(a),this.registerUpdatingObject(a),e.unitId){var m=this.attackables.get(e.id);if(!m)return;var g=i/n,y=r/n,v=m.spawnHealthGauge(g,y);s.parent.addChild(v),this.registerUpdatingObject(v)}this.playSe(Math.random()>=.5?un.Audio.Se.Attack1:un.Audio.Se.Attack2)}},BattleScene.prototype.shouldAttackableWalk=function(t){var e=this.attackables.get(t.id);return!!e&&(!!t.unitId&&(e.animationType===un.AnimationTypes.Unit.WALK||e.isAnimationLastFrameTime()))},BattleScene.prototype.onUnitButtonTapped=function(t){if(this.state===In.INGAME){var e=this.getUiGraphUnitButton(t);e&&this.battleLogic.requestSpawnPlayer(e.unitId)}},BattleScene.prototype.initSound=function(){for(var t=(void 0).resources,e=un.Audio,i=[e.Bgm.Battle,e.Se.Attack1,e.Se.Attack2,e.Se.Bomb,e.Se.UnitSpawn,e.Se.Win,e.Se.Lose],r=0;r<i.length;r++){var n=i[r];fn.createSound(n,t[n].buffer)}this.playBgm(e.Bgm.Battle)},BattleScene.prototype.initUnitButtons=function(){for(var t=un.Api.Unit(this.unitIds),e=(void 0).resources[t].data,i=0;i<this.unitSlotCount;i++){var r=this.getUiGraphUnitButton(i);if(r){var n=-1,o=this.unitIds[i];if(o>0)for(var s=0;s<e.length;s++){var a=e[s];if(a.unitId===o){n=a.cost;break}}r.init(i,o,n),r.toggleFilter(!0)}}},BattleScene.prototype.getUiGraphUnitButton=function(t){var e=""+BattleScene.unitButtonPrefix+(t+1);return this.uiGraph[e]},BattleScene.prototype.enableBackToOrderScene=function(){var t=this;this.interactive=!0,this.on("pointerdown",function(e){return t.backToOrderScene()})},BattleScene.prototype.backToOrderScene=function(){for(var t=(void 0).resources,e=Object.keys(t),i=0;i<e.length;i++){var r=e[i];t[r].buffer&&fn.destroySound(r)}mn.loadScene(new so)},BattleScene.castleXOffset=200,BattleScene.unitLeapHeight=30,BattleScene.unitButtonPrefix="unit_button_",BattleScene}(wn),oo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),so=function(t){function OrderScene(){var e=t.call(this)||this;return e.userBattle=null,e.unitMasterCache=new Map,e.unitButtonTexturesCache=new Map,e.unitButtons=new Map,e.currentStageId=1,e.lastUnitIds=[],e.transitionIn=new Mn(1,0,-.02),e.transitionOut=new Mn(0,1,.02),e}return oo(OrderScene,t),OrderScene.prototype.createInitialResourceList=function(){var e=t.prototype.createInitialResourceList.call(this);return e.push(un.Api.UserBattle(1)),e.push(un.Api.AllUnit()),e.push(un.Audio.Bgm.Title),e.push(un.Audio.Se.UnitSpawn),e},OrderScene.prototype.beginLoadResource=function(e){var i=this;return Promise.all([new Promise(function(t){i.loadStageIdFromDB(function(e){i.currentStageId=e||1,t()})}),new Promise(function(t){i.loadUnitIdsFromDB(function(e){i.lastUnitIds=e||[],t()})})]).then(function(){return t.prototype.beginLoadResource.call(i,e)})},OrderScene.prototype.onInitialResourceLoaded=function(){var e=t.prototype.onInitialResourceLoaded.call(this),i=(void 0).resources;this.unitButtonTexturesCache.clear(),this.unitMasterCache.clear();var r=un.Api.UserBattle(1);if(this.userBattle=i[r].data,!this.userBattle)throw new Error("user_battle record could not be retrieved");for(var n=i[un.Api.AllUnit()].data,o=0;o<n.length;o++){var s=n[o];this.unitMasterCache.set(s.unitId,s)}var a=un.Audio.Se.UnitSpawn;fn.createSound(a,i[a].buffer);for(o=0;o<this.userBattle.unlockedUnitIds.length;o++){var h=this.userBattle.unlockedUnitIds[o];e.push(un.Dynamic.UnitPanel(h))}return e},OrderScene.prototype.onResourceLoaded=function(){if(t.prototype.onResourceLoaded.call(this),!this.userBattle)throw new Error("user_battle record missing");for(var e=0;e<this.userBattle.unlockedUnitIds.length;e++){var i=this.userBattle.unlockedUnitIds[e],r=un.Dynamic.UnitPanel(i),n=(void 0).resources;this.unitButtonTexturesCache.set(i,n[r].texture)}this.initUnitButtons(),this.updateCurrentStageId(this.currentStageId),this.playBgmIfNeeded()},OrderScene.prototype.onUnitArrowTapped=function(t,e){if(this.userBattle&&0!==e){var i=this.unitButtons.get(t);if(i){var r=this.userBattle.unlockedUnitIds,n=r.length,o=r.indexOf(i.unitId)+e;o>=n?o%=n:o<0&&(o=n+o%n);var s=-1,a=r[o];if(a>0){var h=this.unitMasterCache.get(a);h&&(s=h.cost)}i.changeUnit(a,s),this.playSe(un.Audio.Se.UnitSpawn)}}},OrderScene.prototype.onStageArrowTapped=function(t){if(this.userBattle){var e,i=this.userBattle.unlockedStageId;1===i?e=1:(e=this.currentStageId+t)>i?e%=i:e<=0&&(e=i+e%i),this.updateCurrentStageId(e),this.playSe(un.Audio.Se.UnitSpawn)}},OrderScene.prototype.onOkButtonDown=function(){this.uiGraph.ok_button_off.visible=!1,this.playSe(un.Audio.Se.UnitSpawn)},OrderScene.prototype.onOkButtonUp=function(){this.uiGraph.ok_button_off.visible=!0,this.startBattleIfPossible()},OrderScene.prototype.getCustomUiGraphFactory=function(t){return"unit_button"===t?new On:null},OrderScene.prototype.startBattleIfPossible=function(){if(this.transitionIn.isActive()||this.transitionOut.isActive())return!1;var t=this.createBattleParameter();return!!t&&(this.fadeOutBgm(),fn.unregisterSound(un.Audio.Bgm.Title),this.saveStageIdToDB(t.stageId),this.saveUnitIdsToDB(t.unitIds),mn.loadScene(new no(t)),!0)},OrderScene.prototype.initUnitButtons=function(){this.unitButtons.clear();for(var t=0,e=Object.keys(this.uiGraph),i=0;i<e.length;i++){var r=e[i],n=this.uiGraph[r];if("UnitButton"===n.constructor.name){var o=n;if(this.lastUnitIds.length>=t+1){var s=this.lastUnitIds[t],a=this.unitMasterCache.get(s);a?o.init(t,s,a.cost):o.init(t,s)}else o.init(t);if(this.unitButtons.set(t,o),++t>=hn.MaxUnitSlotCount)break}}},OrderScene.prototype.updateCurrentStageId=function(t){this.currentStageId=t,this.uiGraph.stage_number.text=""+t},OrderScene.prototype.createBattleParameter=function(){if(!this.userBattle)return null;var t=[];return this.unitButtons.forEach(function(e){t.push(e.unitId)}),{unitIds:t,unitSlotCount:hn.MaxUnitSlotCount,stageId:this.currentStageId,playerCastle:this.userBattle.castle,cost:this.userBattle.cost}},OrderScene.prototype.playBgmIfNeeded=function(){var t=un.Audio.Bgm.Title;if(!fn.hasSound(t)){var e=(void 0).resources[t];fn.createSound(t,e.buffer).play(!0)}},OrderScene.prototype.saveUnitIdsToDB=function(t){dn.put("lastUnitOrder",t)},OrderScene.prototype.loadUnitIdsFromDB=function(t){dn.get("lastUnitOrder",function(e){t(e)})},OrderScene.prototype.saveStageIdToDB=function(t){dn.put("lastStageId",t)},OrderScene.prototype.loadStageIdFromDB=function(t){dn.get("lastStageId",function(e){t(e)})},OrderScene.prototype.fadeOutBgm=function(){var t=fn.getSound(un.Audio.Bgm.Title);t&&fn.fade(t,.01,.5,!0)},OrderScene}(wn),ao=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),ho=function(t){function TitleScene(){var e=t.call(this)||this;return e.textAppealDuration=20,e.transitionIn=new Mn(1,0,-.02),e.transitionOut=new Mn(0,1,.02),e.interactive=!0,e.on("pointerup",function(){return e.startOrder()}),e}return ao(TitleScene,t),TitleScene.prototype.createInitialResourceList=function(){var e=t.prototype.createInitialResourceList.call(this);return e.push(un.Audio.Bgm.Title),e},TitleScene.prototype.onResourceLoaded=function(){t.prototype.onResourceLoaded.call(this);var e=un.Audio.Bgm.Title,i=(void 0).resources[e];fn.createSound(e,i.buffer),this.playBgm(un.Audio.Bgm.Title)},TitleScene.prototype.update=function(e){if(t.prototype.update.call(this,e),this.elapsedFrameCount%this.textAppealDuration==0){var i=this.uiGraph.touch_to_start.visible;this.uiGraph.touch_to_start.visible=!i}},TitleScene.prototype.startOrder=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||mn.loadScene(new so)},TitleScene}(wn);function initGame(){var t={backgroundColor:2236962};window.GameManager=mn,t.preserveDrawingBuffer=!0,document.body.addEventListener("keydown",function(t){if(!0===t.ctrlKey&&"c"===t.key){var e=document.createElement("a");e.setAttribute("href",mn.instance.game.view.toDataURL()),e.setAttribute("download","figure_"+(new Date).getTime()),e.click()}}),mn.start({glWidth:1136,glHeight:640,option:t}),mn.loadScene(new ho)}var uo=!1,lo=!1;n.load({custom:{families:[un.FontFamily.Default],urls:["base.css"]},active:function(){uo=!0,lo&&initGame()}}),window.onload=function(){lo=!0,uo&&initGame()}}])});